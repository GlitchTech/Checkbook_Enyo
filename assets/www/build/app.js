// minifier: path aliases
enyo.path.addPaths({"g11n": "/home/ryltar/git/gutoc/enyo/../lib/g11n/", "layout": "/home/ryltar/git/gutoc/enyo/../lib/layout/", "onyx": "/home/ryltar/git/gutoc/enyo/../lib/onyx/", "onyx": "/home/ryltar/git/gutoc/enyo/../lib/onyx/source/", "private": "/home/ryltar/git/gutoc/enyo/../lib/private/", "misc": "source/misc/", "accounts": "source/accounts/", "transactions": "source/transactions/", "search": "source/search/", "budget": "source/budget/", "reports": "source/reports/", "sync": "source/sync/"});

// javascript/g11n.js
if(!this.enyo){this.enyo={};var empty={};enyo.mixin=function(n,o){if(n=n||{},o){var e,a;for(e in o)a=o[e],empty[e]!==a&&(n[e]=a)}return n}}"trim"in String.prototype||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),enyo.g11n=function(){},enyo.g11n._init=function(){if(!enyo.g11n._initialized){if("undefined"!=typeof window?(enyo.g11n._platform="browser",enyo.g11n._enyoAvailable=!0):(enyo.g11n._platform="node",enyo.g11n._enyoAvailable=!1),navigator){var n=(navigator.language||navigator.userLanguage).replace(/-/g,"_").toLowerCase();enyo.g11n._locale=new enyo.g11n.Locale(n),enyo.g11n._formatLocale=enyo.g11n._locale,enyo.g11n._phoneLocale=enyo.g11n._locale}void 0===enyo.g11n._locale&&(enyo.warn("enyo.g11n._init: could not find current locale, so using default of en_us."),enyo.g11n._locale=new enyo.g11n.Locale("en_us")),void 0===enyo.g11n._formatLocale&&(enyo.warn("enyo.g11n._init: could not find current formats locale, so using default of us."),enyo.g11n._formatLocale=new enyo.g11n.Locale("en_us")),void 0===enyo.g11n._phoneLocale&&(enyo.warn("enyo.g11n._init: could not find current phone locale, so defaulting to the same thing as the formats locale."),enyo.g11n._phoneLocale=enyo.g11n._formatLocale),void 0===enyo.g11n._sourceLocale&&(enyo.g11n._sourceLocale=new enyo.g11n.Locale("en_us")),enyo.g11n._initialized=!0}},enyo.g11n.getPlatform=function(){return enyo.g11n._platform||enyo.g11n._init(),enyo.g11n._platform},enyo.g11n.isEnyoAvailable=function(){return enyo.g11n._enyoAvailable||enyo.g11n._init(),enyo.g11n._enyoAvailable},enyo.g11n.currentLocale=function(){return enyo.g11n._locale||enyo.g11n._init(),enyo.g11n._locale},enyo.g11n.formatLocale=function(){return enyo.g11n._formatLocale||enyo.g11n._init(),enyo.g11n._formatLocale},enyo.g11n.phoneLocale=function(){return enyo.g11n._phoneLocale||enyo.g11n._init(),enyo.g11n._phoneLocale},enyo.g11n.sourceLocale=function(){return enyo.g11n._sourceLocale||enyo.g11n._init(),enyo.g11n._sourceLocale},enyo.g11n.setLocale=function(n){n&&(enyo.g11n._init(),n.uiLocale&&(enyo.g11n._locale=new enyo.g11n.Locale(n.uiLocale)),n.formatLocale&&(enyo.g11n._formatLocale=new enyo.g11n.Locale(n.formatLocale)),n.phoneLocale&&(enyo.g11n._phoneLocale=new enyo.g11n.Locale(n.phoneLocale)),n.sourceLocale&&(enyo.g11n._sourceLocale=new enyo.g11n.Locale(n.sourceLocale)))};

// javascript/fmts.js
enyo.g11n.Fmts=function(e){this.locale=void 0!==e&&e.locale?"string"==typeof e.locale?new enyo.g11n.Locale(e.locale):e.locale:enyo.g11n.formatLocale(),this.dateTimeFormatHash=enyo.g11n.Utils.getJsonFile({root:enyo.g11n.Utils._getEnyoRoot(),path:"base/formats",locale:this.locale,type:"region"}),this.dateTimeHash=enyo.g11n.Utils.getJsonFile({root:enyo.g11n.Utils._getEnyoRoot(),path:"base/datetime_data",locale:this.locale}),this.dateTimeHash||(this.dateTimeHash=enyo.g11n.Utils.getJsonFile({root:enyo.g11n.Utils._getEnyoRoot(),path:"base/datetime_data",locale:enyo.g11n.currentLocale()})),this.dateTimeHash||(this.dateTimeHash=enyo.g11n.Utils.getJsonFile({root:enyo.g11n.Utils._getEnyoRoot(),path:"base/datetime_data",locale:new enyo.g11n.Locale("en_us")}))},enyo.g11n.Fmts.prototype.isAmPm=function(){return this.twelveHourFormat===void 0&&(this.twelveHourFormat=this.dateTimeFormatHash.is12HourDefault),this.twelveHourFormat},enyo.g11n.Fmts.prototype.isAmPmDefault=function(){return this.dateTimeFormatHash.is12HourDefault},enyo.g11n.Fmts.prototype.getFirstDayOfWeek=function(){return this.dateTimeFormatHash.firstDayOfWeek},enyo.g11n.Fmts.prototype.getDateFieldOrder=function(){return this.dateTimeFormatHash?this.dateTimeFormatHash.dateFieldOrder:(enyo.warn("Failed to load date time format hash"),"mdy")},enyo.g11n.Fmts.prototype.getTimeFieldOrder=function(){return this.dateTimeFormatHash?this.dateTimeFormatHash.timeFieldOrder:(enyo.warn("Failed to load date time format hash"),"hma")},enyo.g11n.Fmts.prototype.getMonthFields=function(){return this.dateTimeHash?this.dateTimeHash.medium.month:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},enyo.g11n.Fmts.prototype.getAmCaption=function(){return this.dateTimeHash?this.dateTimeHash.am:(enyo.error("Failed to load dateTimeHash."),"AM")},enyo.g11n.Fmts.prototype.getPmCaption=function(){return this.dateTimeHash?this.dateTimeHash.pm:(enyo.error("Failed to load dateTimeHash."),"PM")},enyo.g11n.Fmts.prototype.getMeasurementSystem=function(){return this.dateTimeFormatHash&&this.dateTimeFormatHash.measurementSystem||"metric"},enyo.g11n.Fmts.prototype.getDefaultPaperSize=function(){return this.dateTimeFormatHash&&this.dateTimeFormatHash.defaultPaperSize||"A4"},enyo.g11n.Fmts.prototype.getDefaultPhotoSize=function(){return this.dateTimeFormatHash&&this.dateTimeFormatHash.defaultPhotoSize||"10X15CM"},enyo.g11n.Fmts.prototype.getDefaultTimeZone=function(){return this.dateTimeFormatHash&&this.dateTimeFormatHash.defaultTimeZone||"Europe/London"},enyo.g11n.Fmts.prototype.isAsianScript=function(){return this.dateTimeFormatHash&&this.dateTimeFormatHash.asianScript!==void 0?this.dateTimeFormatHash.asianScript:!1},enyo.g11n.Fmts.prototype.isHanTraditional=function(){return this.dateTimeFormatHash&&this.dateTimeFormatHash.scriptStyle!==void 0?"traditional"===this.dateTimeFormatHash.scriptStyle:!1},enyo.g11n.Fmts.prototype.textDirection=function(){return this.dateTimeFormatHash&&this.dateTimeFormatHash.scriptDirection||"ltr"};

// javascript/locale.js
enyo.g11n.Locale=function(e){var o=e?e.split(/_/):[];return this.locale=e,this.language=o[0]||void 0,this.region=o[1]?o[1].toLowerCase():void 0,this.variant=o[2]?o[2].toLowerCase():void 0,this},enyo.g11n.Locale.prototype.getLocale=function(){return this.locale},enyo.g11n.Locale.prototype.getLanguage=function(){return this.language},enyo.g11n.Locale.prototype.getRegion=function(){return this.region},enyo.g11n.Locale.prototype.getVariant=function(){return this.variant},enyo.g11n.Locale.prototype.toString=function(){return this.locale||(this.locale=this.language+"_"+this.region,this.variant&&(this.locale=this.locale+"_"+this.variant)),this.locale},enyo.g11n.Locale.prototype.toISOString=function(){var e=this.language||"";return this.region&&(e+="_"+this.region.toUpperCase()),this.variant&&(e+="_"+this.variant.toUpperCase()),e},enyo.g11n.Locale.prototype.isMatch=function(e){return e.language&&e.region?!(this.language&&this.language!==e.language||this.region&&this.region!==e.region):e.language?!this.language||this.language===e.language:!this.region||this.region===e.region},enyo.g11n.Locale.prototype.equals=function(e){return this.language===e.language&&this.region===e.region&&this.variant===e.variant},enyo.g11n.Locale.prototype.useDefaultLang=function(){var e,o,n;this.language||(e=enyo.g11n.Utils.getNonLocaleFile({root:enyo.g11n.Utils._getEnyoRoot(),path:"base/formats/defLangs.json"}),o=e&&e[this.region],o||(n=enyo.g11n.currentLocale(),o=n.language),this.language=o||"en",this.locale=this.language+"_"+this.region)};

// javascript/loadfile.js
enyo.g11n.Utils=enyo.g11n.Utils||function(){},enyo.g11n.Utils._fileCache={},enyo.g11n.Utils._getBaseURL=function(e){if("baseURI"in e)return e.baseURI;var t=e.getElementsByTagName("base");return t.length>0?t[0].href:window.location.href},enyo.g11n.Utils._fetchAppRootPath=function(){var e=window.document,t=enyo.g11n.Utils._getBaseURL(e).match(RegExp(".*://[^#]*/"));return t?t[0]:void 0},enyo.g11n.Utils._setRoot=function(e){var t=e;return t=!e&&enyo.g11n.isEnyoAvailable()?enyo.g11n.Utils._fetchAppRootPath()+"assets":".",enyo.g11n.root=t},enyo.g11n.Utils._getRoot=function(){return enyo.g11n.root||enyo.g11n.Utils._setRoot()},enyo.g11n.Utils._getEnyoRoot=function(e){var t="";return!enyo.g11n.isEnyoAvailable()&&e&&(t=e),t+enyo.path.paths.enyo+"/../lib/g11n/source"},enyo.g11n.Utils._loadFile=function(e){var t,o,n=enyo.g11n.getPlatform();if("node"===n)try{this.fs||(this.fs=IMPORTS.require("fs")),o=this.fs.readFileSync(e,"utf8"),o&&(t=JSON.parse(o))}catch(a){t=void 0}else try{t=JSON.parse(enyo.xhr.request({url:e,sync:!0}).responseText)}catch(i){}return t},enyo.g11n.Utils.getNonLocaleFile=function(e){var t,o,n;return e&&e.path?("/"!==e.path.charAt(0)?(o=e.root||this._getRoot(),n=o+"/"+e.path):n=e.path,void 0!==enyo.g11n.Utils._fileCache[n]?t=enyo.g11n.Utils._fileCache[n].json:(t=enyo.g11n.Utils._loadFile(n),(void 0===e.cache||e.cache!==!1)&&(enyo.g11n.Utils._fileCache[n]={path:n,json:t,locale:void 0,timestamp:new Date},void 0===this.oldestStamp&&(this.oldestStamp=enyo.g11n.Utils._fileCache[n].timestamp))),t):void 0},enyo.g11n.Utils.getJsonFile=function(e){var t,o,n,a,i,l,r,s,g;return e&&e.path&&e.locale?(n="/"!==e.path.charAt(0)?e.root||this._getRoot():"","/"!==n.slice(-1)&&(n+="/"),e.path?(a=e.path,"/"!==a.slice(-1)&&(a+="/")):a="",a+=e.prefix||"",n+=a,g=n+(""+e.locale)+".json",void 0!==enyo.g11n.Utils._fileCache[g]?t=enyo.g11n.Utils._fileCache[g].json:(e.merge?(e.locale.language&&(o=n+e.locale.language+".json",i=this._loadFile(o)),e.locale.region&&(o=n+e.locale.language+"_"+e.locale.region+".json",l=this._loadFile(o),e.locale.language!==e.locale.region&&(o=n+e.locale.region+".json",r=this._loadFile(o))),e.locale.variant&&(o=n+e.locale.language+"_"+e.locale.region+"_"+e.locale.variant+".json",s=this._loadFile(o)),t=this._merge([i,r,l,s])):(o=n+(""+e.locale)+".json",t=this._loadFile(o),!t&&"region"!==e.type&&e.locale.language&&(o=n+e.locale.language+".json",t=this._loadFile(o)),!t&&"language"!==e.type&&e.locale.region&&(o=n+e.locale.region+".json",t=this._loadFile(o)),!t&&"language"!==e.type&&e.locale.region&&(o=n+"_"+e.locale.region+".json",t=this._loadFile(o))),(void 0===e.cache||e.cache!==!1)&&(enyo.g11n.Utils._fileCache[g]={path:g,json:t,locale:e.locale,timestamp:new Date},void 0===this.oldestStamp&&(this.oldestStamp=enyo.g11n.Utils._fileCache[g].timestamp))),t):void 0},enyo.g11n.Utils._merge=function(e){var t,o,n={};for(t=0,o=e.length;o>t;t++)n=enyo.mixin(n,e[t]);return n},enyo.g11n.Utils.releaseAllJsonFiles=function(e,t){var o,n,a,i,l=new Date,r=[];if(e=e||6e4,void 0!==this.oldestStamp&&this.oldestStamp.getTime()+e<l.getTime()){o=l;for(n in enyo.g11n.Utils._fileCache)n&&enyo.g11n.Utils._fileCache[n]&&(i=enyo.g11n.Utils._fileCache[n],i.locale&&!t&&(enyo.g11n.currentLocale().isMatch(i.locale)||enyo.g11n.formatLocale().isMatch(i.locale)||enyo.g11n.phoneLocale().isMatch(i.locale))?i.timestamp.getTime()<o.getTime()&&(o=i.timestamp):i.timestamp.getTime()+e<l.getTime()?r.push(i.path):i.timestamp.getTime()<o.getTime()&&(o=i.timestamp));for(this.oldestStamp=o.getTime()<l.getTime()?o:void 0,a=0;r.length>a;a++)enyo.g11n.Utils._fileCache[r[a]]=void 0}return r.length},enyo.g11n.Utils._cacheSize=function(){var e,t=0;for(e in enyo.g11n.Utils._fileCache)enyo.g11n.Utils._fileCache[e]&&t++;return t};

// javascript/template.js
enyo.g11n.Template=function(e,t){this.template=e,this.pattern=t||/(.?)(#\{(.*?)\})/},enyo.g11n.Template.prototype._evalHelper=function(e,t){function n(e){return void 0===e||null===e?"":e}function o(e,o,a){var i,l,r=t;if(e=n(e),"\\"===e)return o;for(i=a.split("."),l=i.shift();r&&l;)if(r=r[l],l=i.shift(),!l)return e+n(r)||e||"";return e||""}var a,i=[],l=this.pattern;if(!t||!e)return"";for(;e.length;)a=e.match(l),a?(i.push(e.slice(0,a.index)),i.push(o(a[1],a[2],a[3])),e=e.slice(a.index+a[0].length)):(i.push(e),e="");return i.join("")},enyo.g11n.Template.prototype.evaluate=function(e){return this._evalHelper(this.template,e)},enyo.g11n.Template.prototype.formatChoice=function(e,t){try{var n,o=this.template?this.template.split("|"):[],a=[],i=[],l="";for(t=t||{},n=0;o.length>n;n++){var r=enyo.indexOf("#",o[n]);if(-1!==r){if(a[n]=o[n].substring(0,r),i[n]=o[n].substring(r+1),e==a[n])return this._evalHelper(i[n],t);""===a[n]&&(l=i[n])}}for(n=0;a.length>n;n++){var s=a[n];if(s){var g=s.charAt(s.length-1),c=parseFloat(s);if("<"===g&&c>e||">"===g&&e>c)return this._evalHelper(i[n],t)}}return this._evalHelper(l,t)}catch(h){return enyo.error("formatChoice error : ",h),""}};

// javascript/resources.js
$L=function(e){return $L._resources||($L._resources=new enyo.g11n.Resources),$L._resources.$L(e)},$L._resources=null,enyo.g11n.Resources=function(e){e&&e.root&&(this.root="undefined"!=typeof window?enyo.path.rewrite(e.root):e.root),this.root=this.root||enyo.g11n.Utils._getRoot(),this.resourcePath=this.root+"/resources/",this.locale=e&&e.locale?"string"==typeof e.locale?new enyo.g11n.Locale(e.locale):e.locale:enyo.g11n.currentLocale(),this.$L="en_pl"==""+this.locale?this._pseudo:this._$L,this.localizedResourcePath=this.resourcePath+this.locale.locale+"/",this.languageResourcePath=this.resourcePath+(this.locale.language?this.locale.language+"/":""),this.regionResourcePath=this.languageResourcePath+(this.locale.region?this.locale.region+"/":""),this.carrierResourcePath=this.regionResourcePath+(this.locale.variant?this.locale.variant+"/":"")},enyo.g11n.Resources.prototype.getResource=function(e){var t;if(this.carrierResourcePath)try{t=enyo.g11n.Utils.getNonLocaleFile({path:this.carrierResourcePath+e})}catch(o){t=void 0}if(!t)try{t=enyo.g11n.Utils.getNonLocaleFile({path:this.regionResourcePath+e})}catch(n){t=void 0}if(!t)try{t=enyo.g11n.Utils.getNonLocaleFile({path:this.languageResourcePath+e})}catch(a){t=void 0}if(!t)try{t=enyo.g11n.Utils.getNonLocaleFile({path:this.resourcePath+"en/"+e})}catch(i){t=void 0}if(!t)try{t=enyo.g11n.Utils.getNonLocaleFile({path:this.root+"/"+e})}catch(r){t=void 0}return t},enyo.g11n.Resources.prototype.$L=function(){},enyo.g11n.Resources.prototype._$L=function(e){var t,o;return e?this.locale.equals(enyo.g11n.sourceLocale())?"string"==typeof e?e:e.value:(this.strings||this._loadStrings(),"string"==typeof e?(t=e,o=e):(t=e.key,o=e.value),this.strings&&this.strings[t]!==void 0?this.strings[t]:o):""},enyo.g11n.Resources.prototype._pseudo=function(e){var t,o;if(!e)return"";for(o="",t=0;e.length>t;t++)if("#"===e.charAt(t)&&e.length>t+1&&"{"===e.charAt(t+1)){for(;"}"!==e.charAt(t)&&e.length>t;)o+=e.charAt(t++);e.length>t&&(o+=e.charAt(t))}else if("<"===e.charAt(t)){for(;">"!==e.charAt(t)&&e.length>t;)o+=e.charAt(t++);e.length>t&&(o+=e.charAt(t))}else if("&"===e.charAt(t)&&e.length>t+1&&!enyo.g11n.Char.isSpace(e.charAt(t+1))){for(;";"!==e.charAt(t)&&!enyo.g11n.Char.isSpace(e.charAt(t))&&e.length>t;)o+=e.charAt(t++);e.length>t&&(o+=e.charAt(t))}else o+=enyo.g11n.Resources._pseudoMap[e.charAt(t)]||e.charAt(t);return o},enyo.g11n.Resources.prototype._loadStrings=function(){this.strings=enyo.g11n.Utils.getJsonFile({root:this.root,path:"resources",locale:this.locale,merge:!0}),enyo.g11n.Utils.releaseAllJsonFiles()},enyo.g11n.Resources._pseudoMap={a:"\u00e1",e:"\u00e8",i:"\u00ef",o:"\u00f5",u:"\u00fb",c:"\u00e7",A:"\u00c5",E:"\u00cb",I:"\u00ce",O:"\u00d5",U:"\u00db",C:"\u00c7",B:"\u00df",y:"\u00ff",Y:"\u00dd",D:"\u010e",d:"\u0111",g:"\u011d",G:"\u011c",H:"\u0124",h:"\u0125",J:"\u0134",j:"\u0135",K:"\u0136",k:"\u0137",N:"\u00d1",n:"\u00f1",S:"\u015e",s:"\u015f",T:"\u0164",t:"\u0165",W:"\u0174",w:"\u0175",Z:"\u0179",z:"\u017a"};

// javascript/character.js
enyo.g11n.Char=enyo.g11n.Char||{},enyo.g11n.Char._strTrans=function(e,t){var n,o,a="";for(o=0;e.length>o;o++)n=t[e.charAt(o)],a+=n||e.charAt(o);return a},enyo.g11n.Char._objectIsEmpty=function(e){var t;for(t in e)return!1;return!0},enyo.g11n.Char._isIdeoLetter=function(e){return e>=19968&&40907>=e||e>=63744&&64217>=e||e>=13312&&19893>=e||e>=12353&&12447>=e||e>=12449&&12543>=e||e>=65382&&65437>=e||e>=12784&&12799>=e||e>=12549&&12589>=e||e>=12704&&12727>=e||e>=12593&&12686>=e||e>=65440&&65500>=e||e>=44032&&55203>=e||e>=40960&&42124>=e||e>=4352&&4607>=e||e>=43360&&43388>=e||e>=55216&&55291>=e?!0:!1},enyo.g11n.Char._isIdeoOther=function(e){return e>=42125&&42191>=e||e>=12544&&12548>=e||e>=12590&&12591>=e||e>=64218&&64255>=e||e>=55292&&55295>=e||e>=40908&&40959>=e||e>=43389&&43391>=e||e>=12800&&13055>=e||e>=13056&&13183>=e||e>=13184&&13311>=e||12592===e||12687===e||12448===e||12352===e||12294===e||12348===e?!0:!1},enyo.g11n.Char.isIdeo=function(e){var t;return!e||1>e.length?!1:(t=e.charCodeAt(0),enyo.g11n.Char._isIdeoLetter(t)||enyo.g11n.Char._isIdeoOther(t))},enyo.g11n.Char.isPunct=function(e){var t,n;return!e||1>e.length?!1:(t=enyo.g11n.Utils.getNonLocaleFile({root:enyo.g11n.Utils._getEnyoRoot(),path:"base/character_data/chartype.punct.json"}),n=t&&e.charAt(0)in t,enyo.g11n.Utils.releaseAllJsonFiles(),n)},enyo.g11n.Char._space={9:1,10:1,11:1,12:1,13:1,32:1,133:1,160:1,5760:1,6158:1,8192:1,8193:1,8194:1,8195:1,8196:1,8197:1,8198:1,8199:1,8200:1,8201:1,8202:1,8232:1,8233:1,8239:1,8287:1,12288:1},enyo.g11n.Char.isSpace=function(e){var t;return!e||1>e.length?!1:(t=e.charCodeAt(0),t in enyo.g11n.Char._space)},enyo.g11n.Char.toUpper=function(e,t){var n;return e?(t||(t=enyo.g11n.currentLocale()),n=enyo.g11n.Utils.getJsonFile({root:enyo.g11n.Utils._getEnyoRoot(),path:"base/character_data",locale:t}),n&&n.upperMap||(n=enyo.g11n.Utils.getJsonFile({root:enyo.g11n.Utils._getEnyoRoot(),path:"base/character_data",locale:new enyo.g11n.Locale("en")})),n&&void 0!==n.upperMap?enyo.g11n.Char._strTrans(e,n.upperMap):(enyo.g11n.Utils.releaseAllJsonFiles(),e)):void 0},enyo.g11n.Char.isLetter=function(e){var t,n,o,a;return!e||1>e.length?!1:(t=e.charAt(0),n=e.charCodeAt(0),o=enyo.g11n.Utils.getNonLocaleFile({root:enyo.g11n.Utils._getEnyoRoot(),path:"base/character_data/chartype.letter.json"}),a=o&&t in o||enyo.g11n.Char._isIdeoLetter(n),enyo.g11n.Utils.releaseAllJsonFiles(),a)},enyo.g11n.Char.getIndexChars=function(e){var t,n,o,a,i=[];for(n=e?"string"==typeof e?new enyo.g11n.Locale(e):e:enyo.g11n.currentLocale(),enyo.g11n.Char._resources||(enyo.g11n.Char._resources={}),enyo.g11n.Char._resources[n.locale]||(enyo.g11n.Char._resources[n.locale]=new enyo.g11n.Resources({root:enyo.g11n.Utils._getEnyoRoot()+"/base",locale:n})),o=enyo.g11n.Char._resources[n.locale],t=enyo.g11n.Char._resources[n.locale].$L({key:"indexChars",value:"ABCDEFGHIJKLMNOPQRSTUVWXYZ#"}),a=0;t.length>a;a++)i.push(t[a]);return i},enyo.g11n.Char.getBaseString=function(e,t){var n,o;return e?(o=t?"string"==typeof t?new enyo.g11n.Locale(t):t:enyo.g11n.currentLocale(),n=enyo.g11n.Utils.getJsonFile({root:enyo.g11n.Utils._getEnyoRoot(),path:"base/character_data",locale:o}),(!n||enyo.g11n.Char._objectIsEmpty(n))&&(n=enyo.g11n.Utils.getJsonFile({root:enyo.g11n.Utils._getEnyoRoot(),path:"base/character_data",locale:new enyo.g11n.Locale("en")})),n&&void 0!==n.baseChars&&(e=enyo.g11n.Char._strTrans(e,n.baseChars)),enyo.g11n.Utils.releaseAllJsonFiles(),e):void 0};

// javascript/timezone.js
enyo.g11n._TZ=enyo.g11n._TZ||{},enyo.g11n.TzFmt=function(e){return this.setTZ(),void 0!==e&&void 0!==e.TZ&&this.setCurrentTimeZone(e.TZ),enyo.g11n.Utils.releaseAllJsonFiles(),this},enyo.g11n.TzFmt.prototype={toString:function(){return void 0!==this.TZ?this.TZ:this._TZ},setTZ:function(){var e=""+new Date,t=enyo.indexOf("(",e),n=enyo.indexOf(")",e),o=e.slice(t+1,n);void 0!==o?this.setCurrentTimeZone(o):this.setDefaultTimeZone()},getCurrentTimeZone:function(){return void 0!==this.TZ?this.TZ:void 0!==this._TZ?this._TZ:"unknown"},setCurrentTimeZone:function(e){this._TZ=e,this.TZ=e},setDefaultTimeZone:function(){var e=(""+new Date).match(/\(([A-Z]+)\)/);this._TZ=e&&e[1]||"PST"}};

// javascript/datetime.js
enyo.g11n.DateFmt=function(e){var t,o,n,a,r;if(r=this,r._normalizedComponents={date:{dm:"DM",md:"DM",my:"MY",ym:"MY",d:"D",dmy:"",dym:"",mdy:"",myd:"",ydm:"",ymd:""},time:{az:"AZ",za:"AZ",a:"A",z:"Z","":""},timeLength:{"short":"small",medium:"small","long":"big",full:"big"}},r._normalizeDateTimeFormatComponents=function(e){var t,o,n,a=e.dateComponents,i=e.timeComponents,s=e.time;return e.date&&a&&(t=r._normalizedComponents.date[a],void 0===t&&(enyo.log("date component error: '"+a+"'"),t="")),s&&void 0!==i&&(n=r._normalizedComponents.timeLength[s],void 0===n&&(enyo.log("time format error: "+s),n="small"),o=r._normalizedComponents.time[i],void 0===o&&enyo.log("time component error: '"+i+"'")),e.dateComponents=t,e.timeComponents=o,e},r._finalDateTimeFormat=function(e,t){var o=r.dateTimeFormatHash.dateTimeFormat||r.defaultFormats.dateTimeFormat;return e&&t?r._buildDateTimeFormat(o,"dateTime",{TIME:t,DATE:e}):t||e||"M/d/yy h:mm a"},r._buildDateTimeFormat=function(e,t,o){var n,a,i,s=[],l=r._getTokenizedFormat(e,t);for(n=0,a=l.length;a>n&&void 0!==l[n];++n)i=o[l[n]],i?s.push(i):s.push(l[n]);return s.join("")},r._getDateFormat=function(e,t){var o=r._formatFetch(e,t.dateComponents,"Date");if("full"!==e&&t.weekday){var n=r._formatFetch(t.weekday===!0?e:t.weekday,"","Weekday");o=r._buildDateTimeFormat(r.dateTimeFormatHash.weekDateFormat||r.defaultFormats.weekDateFormat,"weekDate",{WEEK:n,DATE:o})}return o},r._getTimeFormat=function(e,t){var o=r._formatFetch(e,"",r.twelveHourFormat?"Time12":"Time24");if(t.timeComponents){var n="time"+t.timeComponents,a=n+"Format";return r._buildDateTimeFormat(r.dateTimeFormatHash[a]||r.defaultFormats[a],n,{TIME:o,AM:"a",ZONE:"zzz"})}return o},r.ParserChunks={full:"('[^']+'|y{2,4}|M{1,4}|d{1,2}|z{1,3}|a|h{1,2}|H{1,2}|k{1,2}|K{1,2}|E{1,4}|m{1,2}|s{1,2}|[^A-Za-z']+)?",dateTime:"(DATE|TIME|[^A-Za-z]+|'[^']+')?",weekDate:"(DATE|WEEK|[^A-Za-z]+|'[^']+')?",timeA:"(TIME|AM|[^A-Za-z]+|'[^']+')?",timeZ:"(TIME|ZONE|[^A-Za-z]+|'[^']+')?",timeAZ:"(TIME|AM|ZONE|[^A-Za-z]+|'[^']+')?"},r._getTokenizedFormat=function(e,t){for(var o,n,a=t&&r.ParserChunks[t]||r.ParserChunks.full,i=e.length,s=[],l=RegExp(a,"g");i>0;){if(o=l.exec(e)[0],n=o.length,0===n)return[];s.push(o),i-=n}return s},r._formatFetch=function(e,t,o){switch(e){case"short":case"medium":case"long":case"full":case"small":case"big":case"default":return r.dateTimeFormatHash[e+(t||"")+o];default:return e}},r._dayOffset=function(e,t){var o;return t=r._roundToMidnight(t),e=r._roundToMidnight(e),o=(e.getTime()-t.getTime())/864e5},r._roundToMidnight=function(e){var t=e.getTime(),o=new Date;return o.setTime(t),o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0),o},r.inputParams=e,t=void 0!==e&&e.locale?"string"==typeof e.locale?new enyo.g11n.Locale(e.locale):e.locale:enyo.g11n.formatLocale(),t.language||t.useDefaultLang(),this.locale=t,"string"==typeof e?r.formatType=e:e===void 0?(e={format:"short"},r.formatType=e.format):r.formatType=e.format,r.formatType||e.time||e.date||(e?e.format="short":e={format:"short"},r.formatType="short"),r.dateTimeHash=enyo.g11n.Utils.getJsonFile({root:enyo.g11n.Utils._getEnyoRoot(),path:"base/datetime_data",locale:t,type:"language"}),r.dateTimeHash||(r.dateTimeHash=enyo.g11n.Utils.getJsonFile({root:enyo.g11n.Utils._getEnyoRoot(),path:"base/datetime_data",locale:new enyo.g11n.Locale("en_us")})),r.dateTimeFormatHash=enyo.g11n.Utils.getJsonFile({root:enyo.g11n.Utils._getEnyoRoot(),path:"base/formats",locale:t,type:"region"}),r.dateTimeFormatHash||(r.dateTimeFormatHash=enyo.g11n.Utils.getJsonFile({root:enyo.g11n.Utils._getEnyoRoot(),path:"base/formats",locale:new enyo.g11n.Locale("en_us"),type:"region"})),r.rb=new enyo.g11n.Resources({root:enyo.g11n.Utils._getEnyoRoot()+"/base",locale:t}),r.twelveHourFormat=e===void 0||e.twelveHourFormat===void 0?r.dateTimeFormatHash.is12HourDefault:e.twelveHourFormat,r.formatType)switch(r.formatType){case"short":case"medium":case"long":case"full":case"default":r.partsLength=r.formatType,a=r._finalDateTimeFormat(r._getDateFormat(r.formatType,e),r._getTimeFormat(r.formatType,e),e);break;default:a=r.formatType}else e=r._normalizeDateTimeFormatComponents(e),e.time&&(n=r._getTimeFormat(e.time,e),r.partsLength=e.time),e.date&&(o=r._getDateFormat(e.date,e),r.partsLength=e.date),a=r._finalDateTimeFormat(o,n,e);r.tokenized=r._getTokenizedFormat(a),r.partsLength||(r.partsLength="full")},enyo.g11n.DateFmt.prototype.toString=function(){return this.tokenized.join("")},enyo.g11n.DateFmt.prototype.isAmPm=function(){return this.twelveHourFormat},enyo.g11n.DateFmt.prototype.isAmPmDefault=function(){return this.dateTimeFormatHash.is12HourDefault},enyo.g11n.DateFmt.prototype.getFirstDayOfWeek=function(){return this.dateTimeFormatHash.firstDayOfWeek},enyo.g11n.DateFmt.prototype._format=function(e,t){var o,n,a,r,i,s,l,g,h,c=this,u=[];for(g=c.dateTimeHash,s=0,l=t.length;l>s&&void 0!==t[s];s++){switch(t[s]){case"yy":n="",u.push((e.getFullYear()+"").substring(2));break;case"yyyy":n="",u.push(e.getFullYear());break;case"MMMM":n="long",a="month",r=e.getMonth();break;case"MMM":n="medium",a="month",r=e.getMonth();break;case"MM":n="short",a="month",r=e.getMonth();break;case"M":n="single",a="month",r=e.getMonth();break;case"dd":n="short",a="date",r=e.getDate()-1;break;case"d":n="single",a="date",r=e.getDate()-1;break;case"zzz":n="",c.timezoneFmt===void 0&&(c.timezoneFmt=c.inputParams===void 0||c.inputParams.TZ===void 0?new enyo.g11n.TzFmt:new enyo.g11n.TzFmt(c.inputParams)),i=c.timezoneFmt.getCurrentTimeZone(),u.push(i);break;case"a":n="",e.getHours()>11?u.push(g.pm):u.push(g.am);break;case"K":n="",u.push(e.getHours()%12);break;case"KK":n="",o=e.getHours()%12,u.push(10>o?"0"+(""+o):o);break;case"h":n="",o=e.getHours()%12,u.push(0===o?12:o);break;case"hh":n="",o=e.getHours()%12,u.push(0===o?12:10>o?"0"+(""+o):o);break;case"H":n="",u.push(e.getHours());break;case"HH":n="",o=e.getHours(),u.push(10>o?"0"+(""+o):o);break;case"k":n="",o=e.getHours()%12,u.push(0===o?12:o);break;case"kk":n="",o=e.getHours()%12,u.push(0===o?12:10>o?"0"+(""+o):o);break;case"EEEE":n="long",a="day",r=e.getDay();break;case"EEE":n="medium",a="day",r=e.getDay();break;case"EE":n="short",a="day",r=e.getDay();break;case"E":n="single",a="day",r=e.getDay();break;case"mm":case"m":n="";var m=e.getMinutes();u.push(10>m?"0"+(""+m):m);break;case"ss":case"s":n="";var y=e.getSeconds();u.push(10>y?"0"+(""+y):y);break;default:h=/'([A-Za-z]+)'/.exec(t[s]),n="",h?u.push(h[1]):u.push(t[s])}n&&u.push(g[n][a][r])}return u.join("")},enyo.g11n.DateFmt.prototype.format=function(e){var t=this;return"object"!=typeof e||null===t.tokenized?(enyo.warn("DateFmt.format: no date to format or no format loaded"),void 0):this._format(e,t.tokenized)},enyo.g11n.DateFmt.prototype.formatRelativeDate=function(e,t){var o,n,a,r,i=this;if("object"!=typeof e)return void 0;switch(t===void 0?(n=!1,o=new Date):(o=t.referenceDate!==void 0?t.referenceDate:new Date,n=t.verbosity!==void 0?t.verbosity:!1),r=i._dayOffset(o,e)){case 0:return i.dateTimeHash.relative.today;case 1:return i.dateTimeHash.relative.yesterday;case-1:return i.dateTimeHash.relative.tomorrow;default:if(7>r)return i.dateTimeHash.long.day[e.getDay()];if(30>r){if(n){a=new enyo.g11n.Template(i.dateTimeHash.relative.thisMonth);var s=Math.floor(r/7);return a.formatChoice(s,{num:s})}return i.format(e)}if(365>r){if(n){a=new enyo.g11n.Template(i.dateTimeHash.relative.thisYear);var l=Math.floor(r/30);return a.formatChoice(l,{num:l})}return i.format(e)}return i.format(e)}},enyo.g11n.DateFmt.prototype.formatRange=function(e,t){var o,n,a,r,i,s,l,g,h=this.partsLength||"medium",c=this.dateTimeHash,u=this.dateTimeFormatHash;return e||t?e&&t?(t.getTime()<e.getTime()&&(o=t,t=e,e=o),l=new Date(e.getTime()),l.setHours(0),l.setMinutes(0),l.setSeconds(0),l.setMilliseconds(0),g=new Date(t.getTime()),g.setHours(0),g.setMinutes(0),g.setSeconds(0),g.setMilliseconds(0),864e5===g.getTime()-l.getTime()?(r="shortTime"+(this.twelveHourFormat?"12":"24"),n=this._getTokenizedFormat(u[r]),r=h+"Date",a=this._getTokenizedFormat(u[r]),s=new enyo.g11n.Template(this.rb.$L({key:"dateRangeConsecutiveDays",value:"#{startDate} #{startTime} - #{endDate} #{endTime}"})),s.evaluate({startTime:this._format(e,n),endTime:this._format(t,n),startDate:this._format(e,a),endDate:this._format(t,a)})):e.getYear()===t.getYear()?(i="short"===h||"single"===h?(e.getFullYear()+"").substring(2):e.getFullYear(),e.getMonth()===t.getMonth()?e.getDate()===t.getDate()?(r="shortTime"+(this.twelveHourFormat?"12":"24"),n=this._getTokenizedFormat(u[r]),r=h+"Date",a=this._getTokenizedFormat(u[r]),s=new enyo.g11n.Template(this.rb.$L({key:"dateRangeWithinDay",value:"#{startTime}-#{endTime}, #{date}"})),s.evaluate({startTime:this._format(e,n),endTime:this._format(t,n),date:this._format(e,a)})):(r=h+"DDate",a=this._getTokenizedFormat(u[r]),s=new enyo.g11n.Template(this.rb.$L({key:"dateRangeWithinMonth",value:"#{month} #{startDate}-#{endDate}, #{year}"})),s.evaluate({month:c[h].month[e.getMonth()],startDate:this._format(e,a),endDate:this._format(t,a),year:i})):("full"===h?h="long":"single"===h&&(h="short"),r=h+"DMDate",a=this._getTokenizedFormat(u[r]),s=new enyo.g11n.Template(this.rb.$L({key:"dateRangeWithinYear",value:"#{start} - #{end}, #{year}"})),s.evaluate({start:this._format(e,a),end:this._format(t,a),year:i}))):2>t.getYear()-e.getYear()?(r=h+"Date",a=this._getTokenizedFormat(u[r]),s=new enyo.g11n.Template(this.rb.$L({key:"dateRangeWithinConsecutiveYears",value:"#{start} - #{end}"})),s.evaluate({start:this._format(e,a),end:this._format(t,a)})):("full"===h?h="long":"single"===h&&(h="short"),r=h+"MYDate",a=this._getTokenizedFormat(u[r]),s=new enyo.g11n.Template(this.rb.$L({key:"dateRangeMultipleYears",value:"#{startMonthYear} - #{endMonthYear}"})),s.evaluate({startMonthYear:this._format(e,a),endMonthYear:this._format(t,a)}))):this.format(e||t):""};

// javascript/numberfmt.js
enyo.g11n.NumberFmt=function(e){var t,o,n,a,r,i,s;"number"==typeof e?this.fractionDigits=e:e&&"number"==typeof e.fractionDigits&&(this.fractionDigits=e.fractionDigits),this.locale=e&&e.locale?"string"==typeof e.locale?new enyo.g11n.Locale(e.locale):e.locale:enyo.g11n.formatLocale(),this.style=e&&e.style||"number",t=enyo.g11n.Utils.getJsonFile({root:enyo.g11n.Utils._getEnyoRoot(),path:"base/formats",locale:this.locale,type:"region"}),"currency"===this.style&&(n=e&&e.currency||t&&t.currency&&t.currency.name,n?(n=n.toUpperCase(),this.currencyStyle=e&&"iso"===e.currencyStyle?"iso":"common",o=enyo.g11n.Utils.getNonLocaleFile({root:enyo.g11n.Utils._getEnyoRoot(),path:"base/number_data/iso4217.json"}),o?(a=o[n],a||(r=new enyo.g11n.Locale(n),s=enyo.g11n.Utils.getJsonFile({root:enyo.g11n.Utils._getEnyoRoot(),path:"base/formats",locale:r,type:"region"}),s&&(n=s.currency&&s.currency.name,a=o[n])),a||(n=t&&t.currency&&t.currency.name,a=o[n]),a?(this.sign="iso"!==this.currencyStyle?a.sign:n,this.fractionDigits=e&&"number"==typeof e.fractionDigits?e.fractionDigits:a.digits):this.style="number"):(n=t&&t.currency&&t.currency.name,this.sign=n)):(n=t&&t.currency&&t.currency.name,this.sign=n),n?(i=t&&t.currency&&t.currency[this.currencyStyle]||"#{sign} #{amt}",this.currencyTemplate=new enyo.g11n.Template(i)):this.style="number"),t?(this.decimal=t.numberDecimal||".",this.divider=t.numberDivider||",",this.numberGroupRegex=t.dividerIndex?4===t.dividerIndex?/(\d+)(\d{4})/:/(\d+)(\d{3})/:/(\d+)(\d{3})/,this.percentageSpace=t.percentageSpace):(this.decimal=".",this.divider=",",this.numberGroupRegex=/(\d+)(\d{3})/,this.percentageSpace=!1),this.numberGroupRegex.compile(this.numberGroupRegex),enyo.g11n.Utils.releaseAllJsonFiles()},enyo.g11n.NumberFmt.prototype.format=function(e){try{var t,o,n,a;if("string"==typeof e&&(e=parseFloat(e)),isNaN(e))return void 0;for(t=this.fractionDigits!==void 0?e.toFixed(this.fractionDigits):""+e,o=t.split("."),n=o[0];this.divider&&this.numberGroupRegex.test(n);)n=n.replace(this.numberGroupRegex,"$1"+this.divider+"$2");return o[0]=n,a=o.join(this.decimal),"currency"===this.style&&this.currencyTemplate?a=this.currencyTemplate.evaluate({amt:a,sign:this.sign}):"percent"===this.style&&(a+=this.percentageSpace?" %":"%"),a}catch(r){return enyo.log("formatNumber error : "+r),(e||"0")+"."+(this.fractionDigits||"")}};

// javascript/duration.js
enyo.g11n.DurationFmt=function(e){e===void 0?(this.locale=enyo.g11n.formatLocale(),this.style="short"):(this.locale=e.locale?"string"==typeof e.locale?new enyo.g11n.Locale(e.locale):e.locale:enyo.g11n.formatLocale(),e.style?(this.style=e.style,"short"!==this.style&&"medium"!==this.style&&"long"!==this.style&&"full"!==this.style&&(this.style="short")):this.style="short"),this.rb=new enyo.g11n.Resources({root:enyo.g11n.Utils._getEnyoRoot()+"/base",locale:this.locale}),"short"===this.style?this.parts={years:new enyo.g11n.Template(this.rb.$L({key:"yearsFormatShort",value:"##{num}y"})),months:new enyo.g11n.Template(this.rb.$L({key:"monthsFormatShort",value:"##{num}m"})),weeks:new enyo.g11n.Template(this.rb.$L({key:"weeksFormatShort",value:"##{num}w"})),days:new enyo.g11n.Template(this.rb.$L({key:"daysFormatShort",value:"##{num}d"})),hours:new enyo.g11n.Template(this.rb.$L({key:"hoursFormatShort",value:"##{num}"})),minutes:new enyo.g11n.Template(this.rb.$L({key:"minutesFormatShort",value:"##{num}"})),seconds:new enyo.g11n.Template(this.rb.$L({key:"secondsFormatShort",value:"##{num}"})),separator:this.rb.$L({key:"separatorShort",value:" "}),dateTimeSeparator:this.rb.$L({key:"dateTimeSeparatorShort",value:" "}),longTimeFormat:new enyo.g11n.Template(this.rb.$L({key:"longTimeFormatShort",value:"#{hours}:#{minutes}:#{seconds}"})),shortTimeFormat:new enyo.g11n.Template(this.rb.$L({key:"shortTimeFormatShort",value:"#{minutes}:#{seconds}"})),finalSeparator:""}:"medium"===this.style?this.parts={years:new enyo.g11n.Template(this.rb.$L({key:"yearsFormatMedium",value:"##{num} yr"})),months:new enyo.g11n.Template(this.rb.$L({key:"monthsFormatMedium",value:"##{num} mo"})),weeks:new enyo.g11n.Template(this.rb.$L({key:"weeksFormatMedium",value:"##{num} wk"})),days:new enyo.g11n.Template(this.rb.$L({key:"daysFormatMedium",value:"##{num} dy"})),hours:new enyo.g11n.Template(this.rb.$L({key:"hoursFormatMedium",value:"##{num}"})),minutes:new enyo.g11n.Template(this.rb.$L({key:"minutesFormatMedium",value:"##{num}"})),seconds:new enyo.g11n.Template(this.rb.$L({key:"secondsFormatMedium",value:"##{num}"})),separator:this.rb.$L({key:"separatorMedium",value:" "}),dateTimeSeparator:this.rb.$L({key:"dateTimeSeparatorMedium",value:" "}),longTimeFormat:new enyo.g11n.Template(this.rb.$L({key:"longTimeFormatMedium",value:"#{hours}:#{minutes}:#{seconds}"})),shortTimeFormat:new enyo.g11n.Template(this.rb.$L({key:"shortTimeFormatMedium",value:"#{minutes}:#{seconds}"})),finalSeparator:""}:"long"===this.style?this.parts={years:new enyo.g11n.Template(this.rb.$L({key:"yearsFormatLong",value:"1#1 yr|1>##{num} yrs"})),months:new enyo.g11n.Template(this.rb.$L({key:"monthsFormatLong",value:"1#1 mon|1>##{num} mos"})),weeks:new enyo.g11n.Template(this.rb.$L({key:"weeksFormatLong",value:"1#1 wk|1>##{num} wks"})),days:new enyo.g11n.Template(this.rb.$L({key:"daysFormatLong",value:"1#1 day|1>##{num} dys"})),hours:new enyo.g11n.Template(this.rb.$L({key:"hoursFormatLong",value:"0#|1#1 hr|1>##{num} hrs"})),minutes:new enyo.g11n.Template(this.rb.$L({key:"minutesFormatLong",value:"0#|1#1 min|1>##{num} min"})),seconds:new enyo.g11n.Template(this.rb.$L({key:"secondsFormatLong",value:"0#|1#1 sec|1>##{num} sec"})),separator:this.rb.$L({key:"separatorLong",value:" "}),dateTimeSeparator:this.rb.$L({key:"dateTimeSeparatorLong",value:" "}),longTimeFormat:"",shortTimeFormat:"",finalSeparator:""}:"full"===this.style&&(this.parts={years:new enyo.g11n.Template(this.rb.$L({key:"yearsFormatFull",value:"1#1 year|1>##{num} years"})),months:new enyo.g11n.Template(this.rb.$L({key:"monthsFormatFull",value:"1#1 month|1>##{num} months"})),weeks:new enyo.g11n.Template(this.rb.$L({key:"weeksFormatFull",value:"1#1 week|1>##{num} weeks"})),days:new enyo.g11n.Template(this.rb.$L({key:"daysFormatFull",value:"1#1 day|1>##{num} days"})),hours:new enyo.g11n.Template(this.rb.$L({key:"hoursFormatFull",value:"0#|1#1 hour|1>##{num} hours"})),minutes:new enyo.g11n.Template(this.rb.$L({key:"minutesFormatFull",value:"0#|1#1 minute|1>##{num} minutes"})),seconds:new enyo.g11n.Template(this.rb.$L({key:"secondsFormatFull",value:"0#|1#1 second|1>##{num} seconds"})),separator:this.rb.$L({key:"separatorFull",value:", "}),dateTimeSeparator:this.rb.$L({key:"dateTimeSeparatorFull",value:", "}),longTimeFormat:"",shortTimeFormat:"",finalSeparator:this.rb.$L({key:"finalSeparatorFull",value:" and "})}),this.dateParts=["years","months","weeks","days"],this.timeParts=["hours","minutes","seconds"]},enyo.g11n.DurationFmt.prototype.format=function(e){var t,o,n,a,r=[],i=[];if(!e||enyo.g11n.Char._objectIsEmpty(e))return"";for(o=0;this.dateParts.length>o;o++)n=e[this.dateParts[o]]||0,n>0&&(a=this.parts[this.dateParts[o]].formatChoice(n,{num:n}),a&&a.length>0&&(r.length>0&&r.push(this.parts.separator),r.push(a)));if("long"===this.style||"full"===this.style)for(o=0;this.timeParts.length>o;o++)n=e[this.timeParts[o]]||0,n>0&&(a=this.parts[this.timeParts[o]].formatChoice(n,{num:n}),a&&a.length>0&&(i.length>0&&i.push(this.parts.separator),i.push(a)));else{var s={},l=e.hours?this.parts.longTimeFormat:this.parts.shortTimeFormat;for(o=0;this.timeParts.length>o;o++){if(n=e[this.timeParts[o]]||0,10>n)switch(this.timeParts[o]){case"minutes":e.hours&&(n="0"+n);break;case"seconds":n="0"+n;break;case"hours":}a=this.parts[this.timeParts[o]].formatChoice(n,{num:n}),a&&a.length>0&&(s[this.timeParts[o]]=a)}i.push(l.evaluate(s))}for(t=r,t.length>0&&i.length>0&&t.push(this.parts.dateTimeSeparator),o=0;i.length>o;o++)t.push(i[o]);return t.length>2&&"full"===this.style&&(t[t.length-2]=this.parts.finalSeparator),t.join("")||""};

// ContextualLayout.js
enyo.kind({name:"enyo.ContextualLayout",kind:"Layout",adjustPosition:function(){if(this.container.showing&&this.container.hasNode()){this.resetPositioning();var e=this.getViewWidth(),t=this.getViewHeight(),o=this.container.vertFlushMargin,n=t-this.container.vertFlushMargin,i=this.container.horizFlushMargin,a=e-this.container.horizFlushMargin;if(o>this.offset.top+this.offset.height||this.offset.top>n){if(this.applyVerticalFlushPositioning(i,a))return;if(this.applyHorizontalFlushPositioning(i,a))return;if(this.applyVerticalPositioning())return}else if((i>this.offset.left+this.offset.width||this.offset.left>a)&&this.applyHorizontalPositioning())return;var s=this.getBoundingRect(this.container.node);if(s.width>this.container.widePopup){if(this.applyVerticalPositioning())return}else if(s.height>this.container.longPopup&&this.applyHorizontalPositioning())return;if(this.applyVerticalPositioning())return;if(this.applyHorizontalPositioning())return}},initVerticalPositioning:function(){this.resetPositioning(),this.container.addClass("vertical");var e=this.getBoundingRect(this.container.node),t=this.getViewHeight();return this.container.floating?t/2>this.offset.top?(this.applyPosition({top:this.offset.top+this.offset.height,bottom:"auto"}),this.container.addClass("below")):(this.applyPosition({top:this.offset.top-e.height,bottom:"auto"}),this.container.addClass("above")):e.top+e.height>t&&t-e.bottom<e.top-e.height?this.container.addClass("above"):this.container.addClass("below"),e=this.getBoundingRect(this.container.node),e.top+e.height>t||0>e.top?!1:!0},applyVerticalPositioning:function(){if(!this.initVerticalPositioning())return!1;var e=this.getBoundingRect(this.container.node),t=this.getViewWidth();if(this.container.floating){var o=this.offset.left+this.offset.width/2-e.width/2;o+e.width>t?(this.applyPosition({left:this.offset.left+this.offset.width-e.width}),this.container.addClass("left")):0>o?(this.applyPosition({left:this.offset.left}),this.container.addClass("right")):this.applyPosition({left:o})}else{var n=this.offset.left+this.offset.width/2-e.left-e.width/2;e.right+n>t?(this.applyPosition({left:this.offset.left+this.offset.width-e.right}),this.container.addRemoveClass("left",!0)):0>e.left+n?this.container.addRemoveClass("right",!0):this.applyPosition({left:n})}return!0},applyVerticalFlushPositioning:function(e,t){if(!this.initVerticalPositioning())return!1;var o=this.getBoundingRect(this.container.node),n=this.getViewWidth();return e>this.offset.left+this.offset.width/2?(this.offset.left+this.offset.width/2<this.container.horizBuffer?this.applyPosition({left:this.container.horizBuffer+(this.container.floating?0:-o.left)}):this.applyPosition({left:this.offset.width/2+(this.container.floating?this.offset.left:0)}),this.container.addClass("right"),this.container.addClass("corner"),!0):this.offset.left+this.offset.width/2>t?(this.offset.left+this.offset.width/2>n-this.container.horizBuffer?this.applyPosition({left:n-this.container.horizBuffer-o.right}):this.applyPosition({left:this.offset.left+this.offset.width/2-o.right}),this.container.addClass("left"),this.container.addClass("corner"),!0):!1},initHorizontalPositioning:function(){this.resetPositioning();var e=this.getBoundingRect(this.container.node),t=this.getViewWidth();return this.container.floating?t/2>this.offset.left+this.offset.width?(this.applyPosition({left:this.offset.left+this.offset.width}),this.container.addRemoveClass("left",!0)):(this.applyPosition({left:this.offset.left-e.width}),this.container.addRemoveClass("right",!0)):this.offset.left-e.width>0?(this.applyPosition({left:this.offset.left-e.left-e.width}),this.container.addRemoveClass("right",!0)):(this.applyPosition({left:this.offset.width}),this.container.addRemoveClass("left",!0)),this.container.addRemoveClass("horizontal",!0),e=this.getBoundingRect(this.container.node),0>e.left||e.left+e.width>t?!1:!0},applyHorizontalPositioning:function(){if(!this.initHorizontalPositioning())return!1;var e=this.getBoundingRect(this.container.node),t=this.getViewHeight(),o=this.offset.top+this.offset.height/2;return this.container.floating?o>=t/2-.05*t&&t/2+.05*t>=o?this.applyPosition({top:this.offset.top+this.offset.height/2-e.height/2,bottom:"auto"}):t/2>this.offset.top+this.offset.height?(this.applyPosition({top:this.offset.top-this.offset.height,bottom:"auto"}),this.container.addRemoveClass("high",!0)):(this.applyPosition({top:this.offset.top-e.height+2*this.offset.height,bottom:"auto"}),this.container.addRemoveClass("low",!0)):o>=t/2-.05*t&&t/2+.05*t>=o?this.applyPosition({top:(this.offset.height-e.height)/2}):t/2>this.offset.top+this.offset.height?(this.applyPosition({top:-this.offset.height}),this.container.addRemoveClass("high",!0)):(this.applyPosition({top:e.top-e.height-this.offset.top+this.offset.height}),this.container.addRemoveClass("low",!0)),!0},applyHorizontalFlushPositioning:function(e,t){if(!this.initHorizontalPositioning())return!1;var o=this.getBoundingRect(this.container.node),n=this.getViewHeight();return this.container.floating?n/2>this.offset.top?(this.applyPosition({top:this.offset.top+this.offset.height/2}),this.container.addRemoveClass("high",!0)):(this.applyPosition({top:this.offset.top+this.offset.height/2-o.height}),this.container.addRemoveClass("low",!0)):o.top+o.height>n&&n-o.bottom<o.top-o.height?(this.applyPosition({top:o.top-o.height-this.offset.top-this.offset.height/2}),this.container.addRemoveClass("low",!0)):(this.applyPosition({top:this.offset.height/2}),this.container.addRemoveClass("high",!0)),e>this.offset.left+this.offset.width?(this.container.addClass("left"),this.container.addClass("corner"),!0):this.offset.left>t?(this.container.addClass("right"),this.container.addClass("corner"),!0):!1},getBoundingRect:function(e){var t=e.getBoundingClientRect();return t.width&&t.height?t:{left:t.left,right:t.right,top:t.top,bottom:t.bottom,width:t.right-t.left,height:t.bottom-t.top}},getViewHeight:function(){return void 0===window.innerHeight?document.documentElement.clientHeight:window.innerHeight},getViewWidth:function(){return void 0===window.innerWidth?document.documentElement.clientWidth:window.innerWidth},applyPosition:function(e){var t="";for(var o in e)t+=o+":"+e[o]+(isNaN(e[o])?"; ":"px; ");this.container.addStyles(t)},resetPositioning:function(){this.container.removeClass("right"),this.container.removeClass("left"),this.container.removeClass("high"),this.container.removeClass("low"),this.container.removeClass("corner"),this.container.removeClass("below"),this.container.removeClass("above"),this.container.removeClass("vertical"),this.container.removeClass("horizontal"),this.applyPosition({left:"auto"}),this.applyPosition({top:"auto"})},reflow:function(){this.offset=this.container.activatorOffset,this.adjustPosition()}});

// FittableLayout.js
enyo.kind({name:"enyo.FittableLayout",kind:"Layout",calcFitIndex:function(){for(var e,t=0,o=this.container.children;e=o[t];t++)if(e.fit&&e.showing)return t},getFitControl:function(){var e=this.container.children,t=e[this.fitIndex];return t&&t.fit&&t.showing||(this.fitIndex=this.calcFitIndex(),t=e[this.fitIndex]),t},getLastControl:function(){for(var e=this.container.children,t=e.length-1,o=e[t];(o=e[t])&&!o.showing;)t--;return o},_reflow:function(e,t,o,n){this.container.addRemoveClass("enyo-stretch",!this.container.noStretch);var i=this.getFitControl();if(i){var a,s=0,r=0,l=0,h=this.container.hasNode();h&&(a=enyo.dom.calcPaddingExtents(h),s=h[t]-(a[o]+a[n]));var g=i.getBounds();r=g[o]-(a&&a[o]||0);var c=this.getLastControl();if(c){var u=enyo.dom.getComputedBoxValue(c.hasNode(),"margin",n)||0;if(c!=i){var m=c.getBounds(),y=g[o]+g[e],f=m[o]+m[e]+u;l=f-y}else l=u}this.applyFitSize(e,s,r,l)}},applyFitSize:function(e,t,o,n){var i=t-(o+n),a=this.getFitControl();a.applyStyle(e,i+"px")},reflow:function(){"h"==this.orient?this._reflow("width","clientWidth","left","right"):this._reflow("height","clientHeight","top","bottom")}}),enyo.kind({name:"enyo.FittableColumnsLayout",kind:"FittableLayout",orient:"h",layoutClass:"enyo-fittable-columns-layout"}),enyo.kind({name:"enyo.FittableRowsLayout",kind:"FittableLayout",layoutClass:"enyo-fittable-rows-layout",orient:"v"});

// FittableRows.js
enyo.kind({name:"enyo.FittableRows",layoutKind:"FittableRowsLayout",noStretch:!1});

// FittableColumns.js
enyo.kind({name:"enyo.FittableColumns",layoutKind:"FittableColumnsLayout",noStretch:!1});

// FittableHeaderLayout.js
enyo.kind({name:"enyo.FittableHeaderLayout",kind:"FittableColumnsLayout",applyFitSize:function(e,t,o,n){var i=o-n,a=this.getFitControl();0>i?(a.applyStyle("padding-left",Math.abs(i)+"px"),a.applyStyle("padding-right",null)):i>0?(a.applyStyle("padding-left",null),a.applyStyle("padding-right",Math.abs(i)+"px")):(a.applyStyle("padding-left",null),a.applyStyle("padding-right",null)),this.inherited(arguments)}});

// FlyweightRepeater.js
enyo.kind({name:"enyo.FlyweightRepeater",published:{count:0,noSelect:!1,multiSelect:!1,toggleSelected:!1,clientClasses:"",clientStyle:"",rowOffset:0,orient:"v"},events:{onSetupItem:"",onRenderRow:""},bottomUp:!1,components:[{kind:"Selection",onSelect:"selectDeselect",onDeselect:"selectDeselect"},{name:"client"}],create:function(){this.inherited(arguments),this.noSelectChanged(),this.multiSelectChanged(),this.clientClassesChanged(),this.clientStyleChanged()},noSelectChanged:function(){this.noSelect&&this.$.selection.clear()},multiSelectChanged:function(){this.$.selection.setMulti(this.multiSelect)},clientClassesChanged:function(){this.$.client.setClasses(this.clientClasses)},clientStyleChanged:function(){this.$.client.setStyle(this.clientStyle)},setupItem:function(e){this.doSetupItem({index:e,selected:this.isSelected(e)})},generateChildHtml:function(){var e="";this.index=null;for(var t=0,o=0;this.count>t;t++)o=this.rowOffset+(this.bottomUp?this.count-t-1:t),this.setupItem(o),this.$.client.setAttribute("data-enyo-index",o),"h"==this.orient&&this.$.client.setStyle("display:inline-block;"),e+=this.inherited(arguments),this.$.client.teardownRender();return e},previewDomEvent:function(e){var t=this.index=this.rowForEvent(e);e.rowIndex=e.index=t,e.flyweight=this},decorateEvent:function(e,t){var o=t&&null!=t.index?t.index:this.index;t&&null!=o&&(t.index=o,t.flyweight=this),this.inherited(arguments)},tap:function(e,t){this.noSelect||-1===t.index||(this.toggleSelected?this.$.selection.toggle(t.index):this.$.selection.select(t.index))},selectDeselect:function(e,t){this.renderRow(t.key)},getSelection:function(){return this.$.selection},isSelected:function(e){return this.getSelection().isSelected(e)},renderRow:function(e){if(!(this.rowOffset>e||e>=this.count+this.rowOffset)){this.setupItem(e);var t=this.fetchRowNode(e);t&&(enyo.dom.setInnerHtml(t,this.$.client.generateChildHtml()),this.$.client.teardownChildren(),this.doRenderRow({rowIndex:e}))}},fetchRowNode:function(e){return this.hasNode()?this.node.querySelector('[data-enyo-index="'+e+'"]'):void 0},rowForEvent:function(e){if(!this.hasNode())return-1;for(var t=e.target;t&&t!==this.node;){var o=t.getAttribute&&t.getAttribute("data-enyo-index");if(null!==o)return Number(o);t=t.parentNode}return-1},prepareRow:function(e){if(!(this.rowOffset>e||e>=this.count+this.rowOffset)){this.setupItem(e);var t=this.fetchRowNode(e);enyo.FlyweightRepeater.claimNode(this.$.client,t)}},lockRow:function(){this.$.client.teardownChildren()},performOnRow:function(e,t,o){this.rowOffset>e||e>=this.count+this.rowOffset||t&&(this.prepareRow(e),enyo.call(o||null,t),this.lockRow())},statics:{claimNode:function(e,t){var o;t&&(o=t.id!==e.id?t.querySelector("#"+e.id):t),e.generated=Boolean(o||!e.tag),e.node=o,e.node&&e.rendered();for(var n,i=0,a=e.children;n=a[i];i++)this.claimNode(n,t)}}});

// List.js
enyo.kind({name:"enyo.List",kind:"Scroller",classes:"enyo-list",published:{count:0,rowsPerPage:50,orient:"v",bottomUp:!1,noSelect:!1,multiSelect:!1,toggleSelected:!1,fixedSize:!1,reorderable:!1,centerReorderContainer:!0,reorderComponents:[],pinnedReorderComponents:[],swipeableComponents:[],enableSwipe:!1,persistSwipeableItem:!1},events:{onSetupItem:"",onSetupReorderComponents:"",onSetupPinnedReorderComponents:"",onReorder:"",onSetupSwipeItem:"",onSwipeDrag:"",onSwipe:"",onSwipeComplete:""},handlers:{onAnimateFinish:"animateFinish",onRenderRow:"rowRendered",ondragstart:"dragstart",ondrag:"drag",ondragfinish:"dragfinish",onup:"up",onholdpulse:"holdpulse",onflick:"flick"},rowSize:0,listTools:[{name:"port",classes:"enyo-list-port enyo-border-box",components:[{name:"generator",kind:"FlyweightRepeater",canGenerate:!1,components:[{tag:null,name:"client"}]},{name:"holdingarea",allowHtml:!0,classes:"enyo-list-holdingarea"},{name:"page0",allowHtml:!0,classes:"enyo-list-page"},{name:"page1",allowHtml:!0,classes:"enyo-list-page"},{name:"placeholder",classes:"enyo-list-placeholder"},{name:"swipeableComponents",style:"position:absolute; display:block; top:-1000px; left:0;"}]}],reorderHoldTimeMS:600,draggingRowIndex:-1,initHoldCounter:3,holdCounter:3,holding:!1,draggingRowNode:null,placeholderRowIndex:-1,dragToScrollThreshold:.1,prevScrollTop:0,autoScrollTimeoutMS:20,autoScrollTimeout:null,autoscrollPageY:0,pinnedReorderMode:!1,initialPinPosition:-1,itemMoved:!1,currentPageNumber:-1,completeReorderTimeout:null,swipeIndex:null,swipeDirection:null,persistentItemVisible:!1,persistentItemOrigin:null,swipeComplete:!1,completeSwipeTimeout:null,completeSwipeDelayMS:500,normalSwipeSpeedMS:200,fastSwipeSpeedMS:100,percentageDraggedThreshold:.2,importProps:function(e){e&&e.reorderable&&(this.touch=!0),this.inherited(arguments)},create:function(){this.pageSizes=[],this.orientV="v"==this.orient,this.vertical=this.orientV?"default":"hidden",this.inherited(arguments),this.$.generator.orient=this.orient,this.getStrategy().translateOptimized=!0,this.pageBound=this.orientV?"top":"left",this.$.port.addRemoveClass("horizontal",!this.orientV),this.$.page0.addRemoveClass("vertical",this.orientV),this.$.page1.addRemoveClass("vertical",this.orientV),this.bottomUpChanged(),this.noSelectChanged(),this.multiSelectChanged(),this.toggleSelectedChanged(),this.$.generator.setRowOffset(0),this.$.generator.setCount(this.count)},initComponents:function(){this.createReorderTools(),this.inherited(arguments),this.createSwipeableComponents()},createReorderTools:function(){this.createComponent({name:"reorderContainer",classes:"enyo-list-reorder-container",ondown:"sendToStrategy",ondrag:"sendToStrategy",ondragstart:"sendToStrategy",ondragfinish:"sendToStrategy",onflick:"sendToStrategy"})},createStrategy:function(){this.controlParentName="strategy",this.inherited(arguments),this.createChrome(this.listTools),this.controlParentName="client",this.discoverControlParent()},createSwipeableComponents:function(){for(var e=0;this.swipeableComponents.length>e;e++)this.$.swipeableComponents.createComponent(this.swipeableComponents[e],{owner:this.owner})},rendered:function(){this.inherited(arguments),this.$.generator.node=this.$.port.hasNode(),this.$.generator.generated=!0,this.reset()},resizeHandler:function(){this.inherited(arguments),this.refresh()},bottomUpChanged:function(){this.$.generator.bottomUp=this.bottomUp,this.$.page0.applyStyle(this.pageBound,null),this.$.page1.applyStyle(this.pageBound,null),this.pageBound=this.orientV?this.bottomUp?"bottom":"top":this.bottomUp?"right":"left",!this.orientV&&this.bottomUp&&(this.$.page0.applyStyle("left","auto"),this.$.page1.applyStyle("left","auto")),this.hasNode()&&this.reset()},noSelectChanged:function(){this.$.generator.setNoSelect(this.noSelect)},multiSelectChanged:function(){this.$.generator.setMultiSelect(this.multiSelect)},toggleSelectedChanged:function(){this.$.generator.setToggleSelected(this.toggleSelected)},countChanged:function(){this.hasNode()&&this.updateMetrics()},sendToStrategy:function(e,t){this.$.strategy.dispatchEvent("on"+t.type,t,e)},updateMetrics:function(){this.defaultPageSize=this.rowsPerPage*(this.rowSize||100),this.pageCount=Math.ceil(this.count/this.rowsPerPage),this.portSize=0;for(var e=0;this.pageCount>e;e++)this.portSize+=this.getPageSize(e);this.adjustPortSize()},holdpulse:function(e,t){return this.getReorderable()&&!this.isReordering()?t.holdTime>=this.reorderHoldTimeMS&&this.shouldStartReordering(e,t)?(this.startReordering(t),!1):void 0:void 0},dragstart:function(e,t){return this.isReordering()?!0:this.isSwipeable()?this.swipeDragStart(e,t):void 0},drag:function(e,t){return this.shouldDoReorderDrag(t)?(t.preventDefault(),this.reorderDrag(t),!0):this.isSwipeable()?(t.preventDefault(),this.swipeDrag(e,t),!0):void 0},dragfinish:function(e,t){this.isReordering()?this.finishReordering(e,t):this.isSwipeable()&&this.swipeDragFinish(e,t)},up:function(e,t){this.isReordering()&&this.finishReordering(e,t)},generatePage:function(e,t){this.page=e;var o=this.rowsPerPage*this.page;this.$.generator.setRowOffset(o);var i=Math.min(this.count-o,this.rowsPerPage);this.$.generator.setCount(i);var n=this.$.generator.generateChildHtml();t.setContent(n),this.getReorderable()&&this.draggingRowIndex>-1&&this.hideReorderingRow();var s=t.getBounds(),r=this.orientV?s.height:s.width;if(!this.rowSize&&r>0&&(this.rowSize=Math.floor(r/i),this.updateMetrics()),!this.fixedSize){var a=this.getPageSize(e);a!=r&&r>0&&(this.pageSizes[e]=r,this.portSize+=r-a)}},pageForRow:function(e){return Math.floor(e/this.rowsPerPage)},preserveDraggingRowNode:function(e){this.draggingRowNode&&this.pageForRow(this.draggingRowIndex)===e&&(this.$.holdingarea.hasNode().appendChild(this.draggingRowNode),this.draggingRowNode=null,this.removedInitialPage=!0)},update:function(e){var t=!1,o=this.positionToPageInfo(e),i=o.pos+this.scrollerSize/2,n=Math.floor(i/Math.max(o.size,this.scrollerSize)+.5)+o.no,s=0===n%2?n:n-1;this.p0!=s&&this.isPageInRange(s)&&(this.preserveDraggingRowNode(this.p0),this.generatePage(s,this.$.page0),this.positionPage(s,this.$.page0),this.p0=s,t=!0,this.p0RowBounds=this.getPageRowSizes(this.$.page0)),s=0===n%2?Math.max(1,n-1):n,this.p1!=s&&this.isPageInRange(s)&&(this.preserveDraggingRowNode(this.p1),this.generatePage(s,this.$.page1),this.positionPage(s,this.$.page1),this.p1=s,t=!0,this.p1RowBounds=this.getPageRowSizes(this.$.page1)),t&&(this.$.generator.setRowOffset(0),this.$.generator.setCount(this.count),this.fixedSize||(this.adjustBottomPage(),this.adjustPortSize()))},getPageRowSizes:function(e){for(var t,o,i={},n=e.hasNode().querySelectorAll("div[data-enyo-index]"),s=0;n.length>s;s++)t=n[s].getAttribute("data-enyo-index"),null!==t&&(o=enyo.dom.getBounds(n[s]),i[parseInt(t,10)]={height:o.height,width:o.width});return i},updateRowBounds:function(e){this.p0RowBounds[e]?this.updateRowBoundsAtIndex(e,this.p0RowBounds,this.$.page0):this.p1RowBounds[e]&&this.updateRowBoundsAtIndex(e,this.p1RowBounds,this.$.page1)},updateRowBoundsAtIndex:function(e,t,o){var i=o.hasNode().querySelector('div[data-enyo-index="'+e+'"]'),n=enyo.dom.getBounds(i);t[e].height=n.height,t[e].width=n.width},updateForPosition:function(e){this.update(this.calcPos(e))},calcPos:function(e){return this.bottomUp?this.portSize-this.scrollerSize-e:e},adjustBottomPage:function(){var e=this.p0>=this.p1?this.$.page0:this.$.page1;this.positionPage(e.pageNo,e)},adjustPortSize:function(){this.scrollerSize=this.orientV?this.getBounds().height:this.getBounds().width;var e=Math.max(this.scrollerSize,this.portSize);this.$.port.applyStyle(this.orientV?"height":"width",e+"px"),this.orientV||this.$.port.applyStyle("height",this.getBounds().height+"px")},positionPage:function(e,t){t.pageNo=e;var o=this.pageToPosition(e);t.applyStyle(this.pageBound,o+"px")},pageToPosition:function(e){for(var t=0,o=e;o>0;)o--,t+=this.getPageSize(o);return t},positionToPageInfo:function(e){for(var t=-1,o=this.calcPos(e),i=this.defaultPageSize;o>=0;)t++,i=this.getPageSize(t),o-=i;return t=Math.max(t,0),{no:t,size:i,pos:o+i,startRow:t*this.rowsPerPage,endRow:Math.min((t+1)*this.rowsPerPage-1,this.count-1)}},isPageInRange:function(e){return e==Math.max(0,Math.min(this.pageCount-1,e))},getPageSize:function(e){var t=this.pageSizes[e];if(!t){var o=this.rowsPerPage*e,i=Math.min(this.count-o,this.rowsPerPage);t=this.defaultPageSize*(i/this.rowsPerPage)}return Math.max(1,t)},invalidatePages:function(){this.p0=this.p1=null,this.p0RowBounds={},this.p1RowBounds={},this.$.page0.setContent(""),this.$.page1.setContent("")},invalidateMetrics:function(){this.pageSizes=[],this.rowSize=0,this.updateMetrics()},scroll:function(e,t){var o=this.inherited(arguments),i=this.orientV?this.getScrollTop():this.getScrollLeft();return this.lastPos===i?o:(this.lastPos=i,this.update(i),this.pinnedReorderMode&&this.reorderScroll(e,t),o)},setScrollTop:function(e){this.update(e),this.inherited(arguments),this.twiddle()},getScrollPosition:function(){return this.calcPos(this[this.orientV?"getScrollTop":"getScrollLeft"]())},setScrollPosition:function(e){this[this.orientV?"setScrollTop":"setScrollLeft"](this.calcPos(e))},scrollToBottom:function(){this.update(this.getScrollBounds().maxTop),this.inherited(arguments)},scrollToRow:function(e){var t=this.pageForRow(e),o=this.pageToPosition(t);if(this.updateForPosition(o),o=this.pageToPosition(t),this.setScrollPosition(o),t==this.p0||t==this.p1){var i=this.$.generator.fetchRowNode(e);if(i){var n=this.orientV?i.offsetTop:i.offsetLeft;this.bottomUp&&(n=this.getPageSize(t)-(this.orientV?i.offsetHeight:i.offsetWidth)-n);var s=this.getScrollPosition()+n;this.setScrollPosition(s)}}},scrollToStart:function(){this[this.bottomUp?this.orientV?"scrollToBottom":"scrollToRight":"scrollToTop"]()},scrollToEnd:function(){this[this.bottomUp?this.orientV?"scrollToTop":"scrollToLeft":this.orientV?"scrollToBottom":"scrollToRight"]()},refresh:function(){this.invalidatePages(),this.update(this[this.orientV?"getScrollTop":"getScrollLeft"]()),this.stabilize(),4===enyo.platform.android&&this.twiddle()},reset:function(){this.getSelection().clear(),this.invalidateMetrics(),this.invalidatePages(),this.stabilize(),this.scrollToStart()},getSelection:function(){return this.$.generator.getSelection()},select:function(e,t){return this.getSelection().select(e,t)},deselect:function(e){return this.getSelection().deselect(e)},isSelected:function(e){return this.$.generator.isSelected(e)},renderRow:function(e){this.$.generator.renderRow(e)},rowRendered:function(e,t){this.updateRowBounds(t.rowIndex)},prepareRow:function(e){this.$.generator.prepareRow(e)},lockRow:function(){this.$.generator.lockRow()},performOnRow:function(e,t,o){this.$.generator.performOnRow(e,t,o)},animateFinish:function(){return this.twiddle(),!0},twiddle:function(){var e=this.getStrategy();enyo.call(e,"twiddle")},pageForPageNumber:function(e,t){return 0===e%2?t&&e!==this.p0?null:this.$.page0:t&&e!==this.p1?null:this.$.page1},shouldStartReordering:function(e,t){return!this.getReorderable()||null==t.rowIndex||0>t.rowIndex||this.pinnedReorderMode||e!==this.$.strategy||null==t.index||0>t.index?!1:!0},startReordering:function(e){this.$.strategy.listReordering=!0,this.buildReorderContainer(),this.doSetupReorderComponents(e),this.styleReorderContainer(e),this.draggingRowIndex=this.placeholderRowIndex=e.rowIndex,this.draggingRowNode=e.target,this.removedInitialPage=!1,this.itemMoved=!1,this.initialPageNumber=this.currentPageNumber=this.pageForRow(e.rowIndex),this.prevScrollTop=this.getScrollTop(),this.replaceNodeWithPlaceholder(e.rowIndex)},buildReorderContainer:function(){this.$.reorderContainer.destroyClientControls();for(var e=0;this.reorderComponents.length>e;e++)this.$.reorderContainer.createComponent(this.reorderComponents[e],{owner:this.owner});this.$.reorderContainer.render()},styleReorderContainer:function(e){this.setItemPosition(this.$.reorderContainer,e.rowIndex),this.setItemBounds(this.$.reorderContainer,e.rowIndex),this.$.reorderContainer.setShowing(!0),this.centerReorderContainer&&this.centerReorderContainerOnPointer(e)},appendNodeToReorderContainer:function(e){this.$.reorderContainer.createComponent({allowHtml:!0,content:e.innerHTML}).render()},centerReorderContainerOnPointer:function(e){var t=enyo.dom.calcNodePosition(this.hasNode()),o=e.pageX-t.left-parseInt(this.$.reorderContainer.domStyles.width,10)/2,i=e.pageY-t.top+this.getScrollTop()-parseInt(this.$.reorderContainer.domStyles.height,10)/2;"ScrollStrategy"!=this.getStrategyKind()&&(o-=this.getScrollLeft(),i-=this.getScrollTop()),this.positionReorderContainer(o,i)},positionReorderContainer:function(e,t){this.$.reorderContainer.addClass("enyo-animatedTopAndLeft"),this.$.reorderContainer.addStyles("left:"+e+"px;top:"+t+"px;"),this.setPositionReorderContainerTimeout()},setPositionReorderContainerTimeout:function(){this.clearPositionReorderContainerTimeout(),this.positionReorderContainerTimeout=setTimeout(this.bindSafely(function(){this.$.reorderContainer.removeClass("enyo-animatedTopAndLeft"),this.clearPositionReorderContainerTimeout()}),100)},clearPositionReorderContainerTimeout:function(){this.positionReorderContainerTimeout&&(clearTimeout(this.positionReorderContainerTimeout),this.positionReorderContainerTimeout=null)},shouldDoReorderDrag:function(){return!this.getReorderable()||0>this.draggingRowIndex||this.pinnedReorderMode?!1:!0},reorderDrag:function(e){this.positionReorderNode(e),this.checkForAutoScroll(e),this.updatePlaceholderPosition(e.pageY)},updatePlaceholderPosition:function(e){var t=this.getRowIndexFromCoordinate(e);-1!==t&&(t>=this.placeholderRowIndex?this.movePlaceholderToIndex(Math.min(this.count,t+1)):this.movePlaceholderToIndex(t))},positionReorderNode:function(e){var t=this.$.reorderContainer.getBounds(),o=t.left+e.ddx,i=t.top+e.ddy;i="ScrollStrategy"==this.getStrategyKind()?i+(this.getScrollTop()-this.prevScrollTop):i,this.$.reorderContainer.addStyles("top: "+i+"px ; left: "+o+"px"),this.prevScrollTop=this.getScrollTop()},checkForAutoScroll:function(e){var t,o=enyo.dom.calcNodePosition(this.hasNode()),i=this.getBounds();this.autoscrollPageY=e.pageY,e.pageY-o.top<i.height*this.dragToScrollThreshold?(t=100*(1-(e.pageY-o.top)/(i.height*this.dragToScrollThreshold)),this.scrollDistance=-1*t):e.pageY-o.top>i.height*(1-this.dragToScrollThreshold)?(t=100*((e.pageY-o.top-i.height*(1-this.dragToScrollThreshold))/(i.height-i.height*(1-this.dragToScrollThreshold))),this.scrollDistance=1*t):this.scrollDistance=0,0===this.scrollDistance?this.stopAutoScrolling():this.autoScrollTimeout||this.startAutoScrolling()},stopAutoScrolling:function(){this.autoScrollTimeout&&(clearTimeout(this.autoScrollTimeout),this.autoScrollTimeout=null)},startAutoScrolling:function(){this.autoScrollTimeout=setInterval(this.bindSafely(this.autoScroll),this.autoScrollTimeoutMS)},autoScroll:function(){0===this.scrollDistance?this.stopAutoScrolling():this.autoScrollTimeout||this.startAutoScrolling(),this.setScrollPosition(this.getScrollPosition()+this.scrollDistance),this.positionReorderNode({ddx:0,ddy:0}),this.updatePlaceholderPosition(this.autoscrollPageY)},movePlaceholderToIndex:function(e){var t,o;if(!(0>e)){e>=this.count?(t=null,o=this.pageForPageNumber(this.pageForRow(this.count-1)).hasNode()):(t=this.$.generator.fetchRowNode(e),o=t.parentNode);var i=this.pageForRow(e);i>=this.pageCount&&(i=this.currentPageNumber),o.insertBefore(this.placeholderNode,t),this.currentPageNumber!==i&&(this.updatePageSize(this.currentPageNumber),this.updatePageSize(i),this.updatePagePositions(i)),this.placeholderRowIndex=e,this.currentPageNumber=i,this.itemMoved=!0}},finishReordering:function(e,t){return!this.isReordering()||this.pinnedReorderMode||this.completeReorderTimeout?void 0:(this.stopAutoScrolling(),this.$.strategy.listReordering=!1,this.moveReorderedContainerToDroppedPosition(t),this.completeReorderTimeout=setTimeout(this.bindSafely(this.completeFinishReordering,t),100),t.preventDefault(),!0)},moveReorderedContainerToDroppedPosition:function(){var e=this.getRelativeOffset(this.placeholderNode,this.hasNode()),t="ScrollStrategy"==this.getStrategyKind()?e.top:e.top-this.getScrollTop(),o=e.left-this.getScrollLeft();this.positionReorderContainer(o,t)},completeFinishReordering:function(e){return this.completeReorderTimeout=null,this.placeholderRowIndex>this.draggingRowIndex&&(this.placeholderRowIndex=Math.max(0,this.placeholderRowIndex-1)),this.draggingRowIndex!=this.placeholderRowIndex||!this.pinnedReorderComponents.length||this.pinnedReorderMode||this.itemMoved?(this.removeDraggingRowNode(),this.removePlaceholderNode(),this.emptyAndHideReorderContainer(),this.pinnedReorderMode=!1,this.reorderRows(e),this.draggingRowIndex=this.placeholderRowIndex=-1,this.refresh(),void 0):(this.beginPinnedReorder(e),void 0)},beginPinnedReorder:function(e){this.buildPinnedReorderContainer(),this.doSetupPinnedReorderComponents(enyo.mixin(e,{index:this.draggingRowIndex})),this.pinnedReorderMode=!0,this.initialPinPosition=e.pageY},emptyAndHideReorderContainer:function(){this.$.reorderContainer.destroyComponents(),this.$.reorderContainer.setShowing(!1)},buildPinnedReorderContainer:function(){this.$.reorderContainer.destroyClientControls();for(var e=0;this.pinnedReorderComponents.length>e;e++)this.$.reorderContainer.createComponent(this.pinnedReorderComponents[e],{owner:this.owner});this.$.reorderContainer.render()},reorderRows:function(e){this.doReorder(this.makeReorderEvent(e)),this.positionReorderedNode(),this.updateListIndices()},makeReorderEvent:function(e){return e.reorderFrom=this.draggingRowIndex,e.reorderTo=this.placeholderRowIndex,e},positionReorderedNode:function(){if(!this.removedInitialPage){var e=this.$.generator.fetchRowNode(this.placeholderRowIndex);if(e&&(e.parentNode.insertBefore(this.hiddenNode,e),this.showNode(this.hiddenNode)),this.hiddenNode=null,this.currentPageNumber!=this.initialPageNumber){var t,o,i=this.pageForPageNumber(this.currentPageNumber),n=this.pageForPageNumber(this.currentPageNumber+1);this.initialPageNumber<this.currentPageNumber?(t=i.hasNode().firstChild,n.hasNode().appendChild(t)):(t=i.hasNode().lastChild,o=n.hasNode().firstChild,n.hasNode().insertBefore(t,o)),this.correctPageSizes(),this.updatePagePositions(this.initialPageNumber)}}},updateListIndices:function(){if(this.shouldDoRefresh())return this.refresh(),this.correctPageSizes(),void 0;var e,t,o,i,n=Math.min(this.draggingRowIndex,this.placeholderRowIndex),s=Math.max(this.draggingRowIndex,this.placeholderRowIndex),r=this.draggingRowIndex-this.placeholderRowIndex>0?1:-1;if(1===r){for(e=this.$.generator.fetchRowNode(this.draggingRowIndex),e&&e.setAttribute("data-enyo-index","reordered"),t=s-1,o=s;t>=n;t--)e=this.$.generator.fetchRowNode(t),e&&(i=parseInt(e.getAttribute("data-enyo-index"),10),o=i+1,e.setAttribute("data-enyo-index",o));e=this.hasNode().querySelector('[data-enyo-index="reordered"]'),e.setAttribute("data-enyo-index",this.placeholderRowIndex)}else for(e=this.$.generator.fetchRowNode(this.draggingRowIndex),e&&e.setAttribute("data-enyo-index",this.placeholderRowIndex),t=n+1,o=n;s>=t;t++)e=this.$.generator.fetchRowNode(t),e&&(i=parseInt(e.getAttribute("data-enyo-index"),10),o=i-1,e.setAttribute("data-enyo-index",o))},shouldDoRefresh:function(){return Math.abs(this.initialPageNumber-this.currentPageNumber)>1},getNodeStyle:function(e){var t=this.$.generator.fetchRowNode(e);if(t){var o=this.getRelativeOffset(t,this.hasNode()),i=enyo.dom.getBounds(t);return{h:i.height,w:i.width,left:o.left,top:o.top}}},getRelativeOffset:function(e,t){var o={top:0,left:0};if(e!==t&&e.parentNode)do o.top+=e.offsetTop||0,o.left+=e.offsetLeft||0,e=e.offsetParent;while(e&&e!==t);return o},replaceNodeWithPlaceholder:function(e){var t=this.$.generator.fetchRowNode(e);if(!t)return enyo.log("No node - "+e),void 0;this.placeholderNode=this.createPlaceholderNode(t),this.hiddenNode=this.hideNode(t);var o=this.pageForPageNumber(this.currentPageNumber);o.hasNode().insertBefore(this.placeholderNode,this.hiddenNode)},createPlaceholderNode:function(e){var t=this.$.placeholder.hasNode().cloneNode(!0),o=enyo.dom.getBounds(e);return t.style.height=o.height+"px",t.style.width=o.width+"px",t},removePlaceholderNode:function(){this.removeNode(this.placeholderNode),this.placeholderNode=null},removeDraggingRowNode:function(){this.draggingRowNode=null;var e=this.$.holdingarea.hasNode();e.innerHTML=""},removeNode:function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},updatePageSize:function(e){if(!(0>e)){var t=this.pageForPageNumber(e,!0);if(t){var o=this.pageSizes[e],i=Math.max(1,t.getBounds().height);this.pageSizes[e]=i,this.portSize+=i-o}}},updatePagePositions:function(e){this.positionPage(this.currentPageNumber,this.pageForPageNumber(this.currentPageNumber)),this.positionPage(e,this.pageForPageNumber(e))},correctPageSizes:function(){var e=this.initialPageNumber%2;this.updatePageSize(this.currentPageNumber,this.$["page"+this.currentPage]),e!=this.currentPageNumber&&this.updatePageSize(this.initialPageNumber,this.$["page"+e])},hideNode:function(e){return e.style.display="none",e},showNode:function(e){return e.style.display="block",e},dropPinnedRow:function(e){this.moveReorderedContainerToDroppedPosition(e),this.completeReorderTimeout=setTimeout(this.bindSafely(this.completeFinishReordering,e),100)},cancelPinnedMode:function(e){this.placeholderRowIndex=this.draggingRowIndex,this.dropPinnedRow(e)},getRowIndexFromCoordinate:function(e){var t=this.getScrollTop()+e-enyo.dom.calcNodePosition(this.hasNode()).top;if(0>t)return-1;var o=this.positionToPageInfo(t),i=o.no==this.p0?this.p0RowBounds:this.p1RowBounds;if(!i)return this.count;for(var n=o.pos,s=this.placeholderNode?enyo.dom.getBounds(this.placeholderNode).height:0,r=0,a=o.startRow;o.endRow>=a;++a){if(a===this.placeholderRowIndex&&(r+=s,r>=n))return-1;if(a!==this.draggingRowIndex&&(r+=i[a].height,r>=n))return a}return a},getIndexPosition:function(e){return enyo.dom.calcNodePosition(this.$.generator.fetchRowNode(e))},setItemPosition:function(e,t){var o=this.getNodeStyle(t),i="ScrollStrategy"==this.getStrategyKind()?o.top:o.top-this.getScrollTop(),n="top:"+i+"px; left:"+o.left+"px;";e.addStyles(n)},setItemBounds:function(e,t){var o=this.getNodeStyle(t),i="width:"+o.w+"px; height:"+o.h+"px;";e.addStyles(i)},reorderScroll:function(){"ScrollStrategy"==this.getStrategyKind()&&this.$.reorderContainer.addStyles("top:"+(this.initialPinPosition+this.getScrollTop()-this.rowSize)+"px;"),this.updatePlaceholderPosition(this.initialPinPosition)},hideReorderingRow:function(){var e=this.hasNode().querySelector('[data-enyo-index="'+this.draggingRowIndex+'"]');e&&(this.hiddenNode=this.hideNode(e))},isReordering:function(){return this.draggingRowIndex>-1},isSwiping:function(){return null!=this.swipeIndex&&!this.swipeComplete&&null!=this.swipeDirection},swipeDragStart:function(e,t){return null==t.index||t.vertical?!0:(this.completeSwipeTimeout&&this.completeSwipe(t),this.swipeComplete=!1,this.swipeIndex!=t.index&&(this.clearSwipeables(),this.swipeIndex=t.index),this.swipeDirection=t.xDirection,this.persistentItemVisible||this.startSwipe(t),this.draggedXDistance=0,this.draggedYDistance=0,!0)},swipeDrag:function(e,t){return this.persistentItemVisible?(this.dragPersistentItem(t),this.preventDragPropagation):this.isSwiping()?(this.dragSwipeableComponents(this.calcNewDragPosition(t.ddx)),this.draggedXDistance=t.dx,this.draggedYDistance=t.dy,!0):!1},swipeDragFinish:function(e,t){if(this.persistentItemVisible)this.dragFinishPersistentItem(t);else{if(!this.isSwiping())return!1;var o=this.calcPercentageDragged(this.draggedXDistance);o>this.percentageDraggedThreshold&&t.xDirection===this.swipeDirection?this.swipe(this.fastSwipeSpeedMS):this.backOutSwipe(t)}return this.preventDragPropagation},isSwipeable:function(){return this.enableSwipe&&0!==this.$.swipeableComponents.controls.length&&!this.isReordering()&&!this.pinnedReorderMode},positionSwipeableContainer:function(e,t){var o=this.$.generator.fetchRowNode(e);if(o){var i=this.getRelativeOffset(o,this.hasNode()),n=enyo.dom.getBounds(o),s=1==t?-1*n.width:n.width;this.$.swipeableComponents.addStyles("top: "+i.top+"px; left: "+s+"px; height: "+n.height+"px; width: "+n.width+"px;")}},calcNewDragPosition:function(e){var t=this.$.swipeableComponents.getBounds(),o=t.left,i=this.$.swipeableComponents.getBounds(),n=1==this.swipeDirection?0:-1*i.width,s=1==this.swipeDirection?o+e>n?n:o+e:n>o+e?n:o+e;return s},dragSwipeableComponents:function(e){this.$.swipeableComponents.applyStyle("left",e+"px")},startSwipe:function(e){e.index=this.swipeIndex,this.positionSwipeableContainer(this.swipeIndex,e.xDirection),this.$.swipeableComponents.setShowing(!0),this.setPersistentItemOrigin(e.xDirection),this.doSetupSwipeItem(e)},dragPersistentItem:function(e){var t=0,o="right"==this.persistentItemOrigin?Math.max(t,t+e.dx):Math.min(t,t+e.dx);this.$.swipeableComponents.applyStyle("left",o+"px")},dragFinishPersistentItem:function(e){var t=this.calcPercentageDragged(e.dx)>.2,o=e.dx>0?"right":0>e.dx?"left":null;this.persistentItemOrigin==o?t?this.slideAwayItem():this.bounceItem(e):this.bounceItem(e)},setPersistentItemOrigin:function(e){this.persistentItemOrigin=1==e?"left":"right"},calcPercentageDragged:function(e){return Math.abs(e/this.$.swipeableComponents.getBounds().width)},swipe:function(e){this.swipeComplete=!0,this.animateSwipe(0,e)},backOutSwipe:function(){var e=this.$.swipeableComponents.getBounds(),t=1==this.swipeDirection?-1*e.width:e.width;this.animateSwipe(t,this.fastSwipeSpeedMS),this.swipeDirection=null},bounceItem:function(){var e=this.$.swipeableComponents.getBounds();e.left!=e.width&&this.animateSwipe(0,this.normalSwipeSpeedMS)},slideAwayItem:function(){var e=this.$.swipeableComponents,t=e.getBounds().width,o="left"==this.persistentItemOrigin?-1*t:t;this.animateSwipe(o,this.normalSwipeSpeedMS),this.persistentItemVisible=!1,this.setPersistSwipeableItem(!1)},clearSwipeables:function(){this.$.swipeableComponents.setShowing(!1),this.persistentItemVisible=!1,this.setPersistSwipeableItem(!1)},completeSwipe:function(){this.completeSwipeTimeout&&(clearTimeout(this.completeSwipeTimeout),this.completeSwipeTimeout=null),this.getPersistSwipeableItem()?this.persistentItemVisible=!0:(this.$.swipeableComponents.setShowing(!1),this.swipeComplete&&this.doSwipeComplete({index:this.swipeIndex,xDirection:this.swipeDirection})),this.swipeIndex=null,this.swipeDirection=null},animateSwipe:function(e,t){var o=enyo.now(),i=this.$.swipeableComponents,n=parseInt(i.domStyles.left,10),s=e-n;this.stopAnimateSwipe();var r=this.bindSafely(function(){var e=enyo.now()-o,a=e/t,h=n+s*Math.min(a,1);i.applyStyle("left",h+"px"),this.job=enyo.requestAnimationFrame(r),e/t>=1&&(this.stopAnimateSwipe(),this.completeSwipeTimeout=setTimeout(this.bindSafely(function(){this.completeSwipe()}),this.completeSwipeDelayMS))});this.job=enyo.requestAnimationFrame(r)},stopAnimateSwipe:function(){this.job&&(this.job=enyo.cancelRequestAnimationFrame(this.job))}});

// PulldownList.js
enyo.kind({name:"enyo.PulldownList",kind:"List",touch:!0,pully:null,pulldownTools:[{name:"pulldown",classes:"enyo-list-pulldown",components:[{name:"puller",kind:"Puller"}]}],events:{onPullStart:"",onPullCancel:"",onPull:"",onPullRelease:"",onPullComplete:""},handlers:{onScrollStart:"scrollStartHandler",onScrollStop:"scrollStopHandler",ondragfinish:"dragfinish"},pullingMessage:"Pull down to refresh...",pulledMessage:"Release to refresh...",loadingMessage:"Loading...",pullingIconClass:"enyo-puller-arrow enyo-puller-arrow-down",pulledIconClass:"enyo-puller-arrow enyo-puller-arrow-up",loadingIconClass:"",create:function(){var e={kind:"Puller",showing:!1,text:this.loadingMessage,iconClass:this.loadingIconClass,onCreate:"setPully"};this.listTools.splice(0,0,e),this.inherited(arguments),this.setPulling()},initComponents:function(){this.createChrome(this.pulldownTools),this.accel=enyo.dom.canAccelerate(),this.translation=this.accel?"translate3d":"translate",this.strategyKind=this.resetStrategyKind(),this.inherited(arguments)},resetStrategyKind:function(){return enyo.platform.android>=3?"TranslateScrollStrategy":"TouchScrollStrategy"},setPully:function(e,t){this.pully=t.originator},scrollStartHandler:function(){this.firedPullStart=!1,this.firedPull=!1,this.firedPullCancel=!1},scroll:function(){var e=this.inherited(arguments);this.completingPull&&this.pully.setShowing(!1);var t=this.getStrategy().$.scrollMath||this.getStrategy(),i=-1*this.getScrollTop();return t.isInOverScroll()&&i>0&&(enyo.dom.transformValue(this.$.pulldown,this.translation,"0,"+i+"px"+(this.accel?",0":"")),this.firedPullStart||(this.firedPullStart=!0,this.pullStart(),this.pullHeight=this.$.pulldown.getBounds().height),i>this.pullHeight&&!this.firedPull&&(this.firedPull=!0,this.firedPullCancel=!1,this.pull()),this.firedPull&&!this.firedPullCancel&&this.pullHeight>i&&(this.firedPullCancel=!0,this.firedPull=!1,this.pullCancel())),e},scrollStopHandler:function(){this.completingPull&&(this.completingPull=!1,this.doPullComplete())},dragfinish:function(){if(this.firedPull){var e=this.getStrategy().$.scrollMath||this.getStrategy();e.setScrollY(-1*this.getScrollTop()-this.pullHeight),this.pullRelease()}},completePull:function(){this.completingPull=!0;var e=this.getStrategy().$.scrollMath||this.getStrategy();e.setScrollY(this.pullHeight),e.start()},pullStart:function(){this.setPulling(),this.pully.setShowing(!1),this.$.puller.setShowing(!0),this.doPullStart()},pull:function(){this.setPulled(),this.doPull()},pullCancel:function(){this.setPulling(),this.doPullCancel()},pullRelease:function(){this.$.puller.setShowing(!1),this.pully.setShowing(!0),this.doPullRelease()},setPulling:function(){this.$.puller.setText(this.pullingMessage),this.$.puller.setIconClass(this.pullingIconClass)},setPulled:function(){this.$.puller.setText(this.pulledMessage),this.$.puller.setIconClass(this.pulledIconClass)}}),enyo.kind({name:"enyo.Puller",classes:"enyo-puller",published:{text:"",iconClass:""},events:{onCreate:""},components:[{name:"icon"},{name:"text",tag:"span",classes:"enyo-puller-text"}],create:function(){this.inherited(arguments),this.doCreate(),this.textChanged(),this.iconClassChanged()},textChanged:function(){this.$.text.setContent(this.text)},iconClassChanged:function(){this.$.icon.setClasses(this.iconClass)}});

// AroundList.js
enyo.kind({name:"enyo.AroundList",kind:"enyo.List",listTools:[{name:"port",classes:"enyo-list-port enyo-border-box",components:[{name:"aboveClient"},{name:"generator",kind:"FlyweightRepeater",canGenerate:!1,components:[{tag:null,name:"client"}]},{name:"holdingarea",allowHtml:!0,classes:"enyo-list-holdingarea"},{name:"page0",allowHtml:!0,classes:"enyo-list-page"},{name:"page1",allowHtml:!0,classes:"enyo-list-page"},{name:"belowClient"},{name:"placeholder"},{name:"swipeableComponents",style:"position:absolute; display:block; top:-1000px; left:0px;"}]}],aboveComponents:null,initComponents:function(){this.inherited(arguments),this.aboveComponents&&this.$.aboveClient.createComponents(this.aboveComponents,{owner:this.owner}),this.belowComponents&&this.$.belowClient.createComponents(this.belowComponents,{owner:this.owner})},updateMetrics:function(){this.defaultPageSize=this.rowsPerPage*(this.rowSize||100),this.pageCount=Math.ceil(this.count/this.rowsPerPage),this.aboveHeight=this.$.aboveClient.getBounds().height,this.belowHeight=this.$.belowClient.getBounds().height,this.portSize=this.aboveHeight+this.belowHeight;for(var e=0;this.pageCount>e;e++)this.portSize+=this.getPageSize(e);this.adjustPortSize()},positionPage:function(e,t){t.pageNo=e;var o=this.pageToPosition(e),i=this.bottomUp?this.belowHeight:this.aboveHeight;o+=i,t.applyStyle(this.pageBound,o+"px")},scrollToContentStart:function(){var e=this.bottomUp?this.belowHeight:this.aboveHeight;this.setScrollPosition(e)}});

// GridFlyweightRepeater.js
enyo.kind({name:"enyo.GridFlyWeightRepeater",kind:"enyo.FlyweightRepeater",events:{onSizeupItem:""},itemsPerRow:0,_itemsFromPreviousPage:0,generateChildHtml:function(){return this.itemFluidWidth||this.itemFixedSize?this._generateChildHtmlEqualSizedItems():this._generateChildHtmlVariableSizedItems()},_generateChildHtmlEqualSizedItems:function(){var e=this.owner.hasNode().clientWidth,t=this.$.client,i="",o=0,n=this.itemWidth,s=this.itemHeight;if(this.itemFluidWidth){o=100/this.itemsPerRow;var r=0;this.itemSpacing>=0&&(r=(this.itemsPerRow+1)*this.itemSpacing,o=100/this.itemsPerRow-100*r/(this.itemsPerRow*e)),n=o/100*e,s=n*(this.itemHeight/this.itemWidth)}for(var a=this.rowOffset;this.rowOffset+this.count>a;a++)t.setAttribute("data-enyo-index",a),this.doSetupItem({index:a,selected:this.isSelected(a)}),this.itemFluidWidth?t.addStyles("width:"+o+"%;height:"+s+"px;"):t.addStyles("width:"+this.itemWidth+"px;height:"+this.itemHeight+"px;"),this.itemSpacing>=0&&(t.addStyles("margin-top:"+this.itemSpacing+"px; margin-left:"+this.itemSpacing+"px;"),a%this.itemsPerRow==this.itemsPerRow-1?t.addStyles("margin-right:"+this.itemSpacing+"px;"):t.addStyles("margin-right: 0px;"),a>=this.count-this.itemsPerRow&&t.addStyles("margin-bottom:"+this.itemSpacing+"px;")),i+=t.generateHtml(),t.teardownRender();return i},_generateChildHtmlVariableSizedItems:function(){this.index=null;var e,t,i=null,o=this.$.client,n=this.owner.hasNode().clientWidth,s=0,r=0,a=0,h=0,l=0,g=0,d=0,c=0,u=0,p=this.itemMinWidth/this.itemMinHeight,m=[{index:0,items:[]}],f=this.owner.$._dummy_.hasNode();0===this.owner.page&&(this._itemsFromPreviousPage=0);var y=this.count+this._itemsFromPreviousPage;for(e=0,t=e+this.rowOffset-this._itemsFromPreviousPage;y>e;e++,t++){c=0,u=0,this.doSizeupItem({index:t,selected:this.isSelected(t)}),c=this.itemWidth,u=this.itemHeight,(!c||0>=c)&&(this.doSetupItem({index:t,selected:this.isSelected(t)}),f.innerHTML=o.generateChildHtml(),c=f.clientWidth,u=f.clientHeight),(!c||0>=c)&&(c=this.itemMinWidth,u=this.itemMinHeight),(!u||0>=u)&&(u=this.itemMinHeight),p=c/u,s=Math.min(c,n),this.itemMinWidth&&this.itemMinWidth>0&&(s=Math.max(c,this.itemMinWidth));var w=e==y-1;if(a=s/p,r+=s,h+=a,i={index:t,pageIndex:e,width:s,height:a},m[d].items.push(i),this.normalizeRows&&(l=r/m[d].items.length,g=h/m[d].items.length,r>=n||w)){m[d].avgHeight=g,m[d].index=d;var v=m[d].items.length,S=(n-r)/v;if(this._itemsFromPreviousPage=0,w&&S+l>1.5*l){this._itemsFromPreviousPage=v,m[d]={avgHeight:0,index:d,items:[]};break}this._normalizeRow(m[d]),w||(d++,m[d]={avgHeight:0,index:0,items:[]}),r=h=g=l=s=a=c=u=0}}f.innerHTML="";var T,P="",C="";for(e=0;m.length>e;e++)if(T=m[e],T.items&&0!==T.items.length)for(var R=0;T.items.length>R;R++)i=T.items[R],this.doSetupItem({index:i.index,selected:this.isSelected(i.index)}),o.setAttribute("data-enyo-index",i.index),o.addStyles("width:"+i.width+"px;height:"+i.height+"px;"),this.itemSpacing>=0&&o.addStyles("margin-top:"+this.itemSpacing+"px;margin-left:"+this.itemSpacing+"px;"),C=o.generateHtml(),o.teardownRender(),P+=C;return P},_normalizeRow:function(e){if(this.normalizeRows&&e.items&&0!==e.items.length){var t,i,o=this.owner.hasNode().clientWidth,n=0,s=0,r="",a=0,h=0,l=0,g=0;for(i=0;e.items.length>i;i++)t=e.items[i],a=t.width,h=t.height,s=Math.floor(e.avgHeight/h*a),r+=" "+s,t.width=s,t.height=e.avgHeight,n+=s,this.itemSpacing>=0&&(n+=this.itemSpacing,i==e.items.length-1&&(n+=this.itemSpacing));for(g=o-n,l=o/(o-g),n=0,s=0,r="",i=0;e.items.length>i;i++){t=e.items[i],a=t.width,h=t.height,s=Math.floor(a*l),r+=" "+s;var d=Math.floor(h*l);t.width=s,t.height=d,n+=s,this.itemSpacing>=0&&(n+=this.itemSpacing,i==e.items.length-1&&(n+=this.itemSpacing))}g=o-n,t=e.items[e.items.length-1],a=t.width,h=t.height,t.width=a+g,t.height=h}}});

// GridList.js
enyo.kind({name:"enyo.GridList",kind:"enyo.List",classes:"enyo-gridlist",published:{itemFluidWidth:!1,itemFixedSize:!1,itemMinWidth:160,itemMinHeight:160,itemWidth:160,itemHeight:160,itemSpacing:0,normalizeRows:!1},horizontal:"hidden",events:{onSizeupItem:""},show:function(e){this._calculateItemsPerRow(),this.setCount(e),this.reset()},create:function(){this._setComponents(),this.inherited(arguments),this.itemFluidWidthChanged(),this.itemFixedSizeChanged(),this.itemMinWidthChanged(),this.itemMinHeightChanged(),this.itemWidthChanged(),this.itemHeightChanged(),this.itemSpacingChanged(),this.normalizeRowsChanged(),this.$.generator.setClientClasses("enyo-gridlist-row")},itemFluidWidthChanged:function(){this.$.generator.itemFluidWidth=this.itemFluidWidth,this.setNormalizeRows(!this.itemFluidWidth&&!this.itemFixedSize)},itemFixedSizeChanged:function(){this.$.generator.itemFixedSize=this.itemFixedSize,this.setNormalizeRows(!this.itemFluidWidth&&!this.itemFixedSize)},itemWidthChanged:function(){this.$.generator.itemWidth=this.itemWidth},itemHeightChanged:function(){this.$.generator.itemHeight=this.itemHeight},itemMinWidthChanged:function(){var e=this.hasNode();e&&(this.itemMinWidth||(this.itemMinWidth=160),this.itemMinWidth=Math.min(this.itemMinWidth,e.clientWidth)),this.$.generator.itemMinWidth=this.itemMinWidth},itemMinHeightChanged:function(){var e=this.hasNode();e&&(this.itemMinHeight||(this.itemMinHeight=160),this.itemMinHeight=Math.min(this.itemMinHeight,e.clientHeight)),this.$.generator.itemMinHeight=this.itemMinHeight},itemSpacingChanged:function(){0>this.itemSpacing&&(this.itemSpacing=0),this.itemSpacing=this.itemSpacing,this.$.generator.itemSpacing=this.itemSpacing},normalizeRowsChanged:function(){this.$.generator.normalizeRows=this.normalizeRows},bottomUpChanged:function(){this.bottomUp=!1,this.pageBound="top"},reflow:function(){this._calculateItemsPerRow(),this.inherited(arguments)},_calculateItemsPerRow:function(){var e=this.hasNode();if(e){this.itemsPerRow=Math.floor((e.clientWidth-this.itemSpacing)/(this.itemMinWidth+this.itemSpacing));var t=Math.round((e.clientHeight-this.itemSpacing)/(this.itemMinHeight+this.itemSpacing));if(this.itemFixedSize||this.itemFluidWidth){var i=Math.floor((e.clientWidth-this.itemSpacing)/(this.itemWidth+this.itemSpacing)),o=Math.floor(i),n=Math.ceil(i),s=e.clientWidth-this.itemSpacing-n*(this.itemWidth+this.itemSpacing);this.itemsPerRow=s>0?n:o,t=Math.round((e.clientHeight-this.itemSpacing)/(this.itemHeight+this.itemSpacing))}this.itemsPerRow=Math.max(1,this.itemsPerRow),this.rowsPerPage=3*this.itemsPerRow*t,this.$.generator.itemsPerRow=this.itemsPerRow}},_setComponents:function(){var e,t=this.listTools[0].components;this.createComponent(new enyo.Component({name:"_dummy_",allowHtml:!0,classes:"enyo-gridlist-dummy",showing:!1},{owner:this}));for(var i=0;t.length>i;i++)if(e=t[i],"generator"==e.name)return e.kind="enyo.GridFlyWeightRepeater",void 0}});

// GridListImageItem.js
enyo.kind({name:"enyo.GridList.ImageItem",classes:"enyo-gridlist-imageitem",components:[{name:"image",kind:"enyo.Image"},{name:"caption",classes:"caption"},{name:"subCaption",classes:"sub-caption"}],create:function(){this.inherited(arguments),this.sourceChanged()},published:{source:"",caption:"",subCaption:"",selected:!1},sourceChanged:function(){this.source&&this.$.image.setAttribute("src",this.source)},captionChanged:function(){return this.caption?(this.$.caption.setShowing(!0),this.$.caption.setContent(this.caption),void 0):(this.$.caption.setContent(this.caption),this.$.caption.setShowing(!1),void 0)},subCaptionChanged:function(){return this.subCaption?(this.$.subCaption.setShowing(!0),this.$.subCaption.setContent(this.subCaption),void 0):(this.$.subCaption.setContent(this.subCaption),this.$.subCaption.setShowing(!1),void 0)},selectedChanged:function(){this.addRemoveClass("selected",this.selected)}});

// Slideable.js
enyo.kind({name:"enyo.Slideable",kind:"Control",published:{axis:"h",value:0,unit:"px",min:0,max:0,accelerated:"auto",overMoving:!0,draggable:!0},events:{onAnimateFinish:"",onChange:""},preventDragPropagation:!1,tools:[{kind:"Animator",onStep:"animatorStep",onEnd:"animatorComplete"}],handlers:{ondragstart:"dragstart",ondrag:"drag",ondragfinish:"dragfinish"},kDragScalar:1,dragEventProp:"dx",unitModifier:!1,canTransform:!1,create:function(){this.inherited(arguments),this.acceleratedChanged(),this.transformChanged(),this.axisChanged(),this.valueChanged(),this.addClass("enyo-slideable")},initComponents:function(){this.createComponents(this.tools),this.inherited(arguments)},rendered:function(){this.inherited(arguments),this.canModifyUnit(),this.updateDragScalar()},resizeHandler:function(){this.inherited(arguments),this.updateDragScalar()},canModifyUnit:function(){if(!this.canTransform){var e=this.getInitialStyleValue(this.hasNode(),this.boundary);e.match(/px/i)&&"%"===this.unit&&(this.unitModifier=this.getBounds()[this.dimension])}},getInitialStyleValue:function(e,t){var i=enyo.dom.getComputedStyle(e);return i?i.getPropertyValue(t):e&&e.currentStyle?e.currentStyle[t]:"0"},updateBounds:function(e,t){var i={};i[this.boundary]=e,this.setBounds(i,this.unit),this.setInlineStyles(e,t)},updateDragScalar:function(){if("%"==this.unit){var e=this.getBounds()[this.dimension];this.kDragScalar=e?100/e:1,this.canTransform||this.updateBounds(this.value,100)}},transformChanged:function(){this.canTransform=enyo.dom.canTransform()},acceleratedChanged:function(){(!enyo.platform.android||2>=enyo.platform.android)&&enyo.dom.accelerate(this,this.accelerated)},axisChanged:function(){var e="h"==this.axis;this.dragMoveProp=e?"dx":"dy",this.shouldDragProp=e?"horizontal":"vertical",this.transform=e?"translateX":"translateY",this.dimension=e?"width":"height",this.boundary=e?"left":"top"},setInlineStyles:function(e,t){var i={};this.unitModifier?(i[this.boundary]=this.percentToPixels(e,this.unitModifier),i[this.dimension]=this.unitModifier,this.setBounds(i)):(t?i[this.dimension]=t:i[this.boundary]=e,this.setBounds(i,this.unit))},valueChanged:function(e){var t=this.value;this.isOob(t)&&!this.isAnimating()&&(this.value=this.overMoving?this.dampValue(t):this.clampValue(t)),enyo.platform.android>2&&(this.value?(0===e||void 0===e)&&enyo.dom.accelerate(this,this.accelerated):enyo.dom.accelerate(this,!1)),this.canTransform?enyo.dom.transformValue(this,this.transform,this.value+this.unit):this.setInlineStyles(this.value,!1),this.doChange()},getAnimator:function(){return this.$.animator},isAtMin:function(){return this.value<=this.calcMin()},isAtMax:function(){return this.value>=this.calcMax()},calcMin:function(){return this.min},calcMax:function(){return this.max},clampValue:function(e){var t=this.calcMin(),i=this.calcMax();return Math.max(t,Math.min(e,i))},dampValue:function(e){return this.dampBound(this.dampBound(e,this.min,1),this.max,-1)},dampBound:function(e,t,i){var o=e;return t*i>o*i&&(o=t+(o-t)/4),o},percentToPixels:function(e,t){return Math.floor(t/100*e)},pixelsToPercent:function(e){var t=this.unitModifier?this.getBounds()[this.dimension]:this.container.getBounds()[this.dimension];return 100*(e/t)},shouldDrag:function(e){return this.draggable&&e[this.shouldDragProp]},isOob:function(e){return e>this.calcMax()||this.calcMin()>e},dragstart:function(e,t){return this.shouldDrag(t)?(t.preventDefault(),this.$.animator.stop(),t.dragInfo={},this.dragging=!0,this.drag0=this.value,this.dragd0=0,this.preventDragPropagation):void 0},drag:function(e,t){if(this.dragging){t.preventDefault();var i=this.canTransform?t[this.dragMoveProp]*this.kDragScalar:this.pixelsToPercent(t[this.dragMoveProp]),o=this.drag0+i,n=i-this.dragd0;return this.dragd0=i,n&&(t.dragInfo.minimizing=0>n),this.setValue(o),this.preventDragPropagation}},dragfinish:function(e,t){return this.dragging?(this.dragging=!1,this.completeDrag(t),t.preventTap(),this.preventDragPropagation):void 0},completeDrag:function(e){this.value!==this.calcMax()&&this.value!=this.calcMin()&&this.animateToMinMax(e.dragInfo.minimizing)},isAnimating:function(){return this.$.animator.isAnimating()},play:function(e,t){this.$.animator.play({startValue:e,endValue:t,node:this.hasNode()})},animateTo:function(e){this.play(this.value,e)},animateToMin:function(){this.animateTo(this.calcMin())},animateToMax:function(){this.animateTo(this.calcMax())},animateToMinMax:function(e){e?this.animateToMin():this.animateToMax()},animatorStep:function(e){return this.setValue(e.value),!0},animatorComplete:function(e){return this.doAnimateFinish(e),!0},toggleMinMax:function(){this.animateToMinMax(!this.isAtMin())}});

// Arranger.js
enyo.kind({name:"enyo.Arranger",kind:"Layout",layoutClass:"enyo-arranger",accelerated:"auto",dragProp:"ddx",dragDirectionProp:"xDirection",canDragProp:"horizontal",incrementalPoints:!1,destroy:function(){for(var e,t=this.container.getPanels(),i=0;e=t[i];i++)e._arranger=null;this.inherited(arguments)},arrange:function(){},size:function(){},start:function(){var e=this.container.fromIndex,t=this.container.toIndex,i=this.container.transitionPoints=[e];if(this.incrementalPoints)for(var o=Math.abs(t-e)-2,n=e;o>=0;)n+=e>t?-1:1,i.push(n),o--;i.push(this.container.toIndex)},finish:function(){},calcArrangementDifference:function(){},canDragEvent:function(e){return e[this.canDragProp]},calcDragDirection:function(e){return e[this.dragDirectionProp]},calcDrag:function(e){return e[this.dragProp]},drag:function(e,t,i,o,n){var s=this.measureArrangementDelta(-e,t,i,o,n);return s},measureArrangementDelta:function(e,t,i,o,n){var s=this.calcArrangementDifference(t,i,o,n),a=s?e/Math.abs(s):0;return a*=this.container.fromIndex>this.container.toIndex?-1:1},_arrange:function(e){this.containerBounds||this.reflow();var t=this.getOrderedControls(e);this.arrange(t,e)},arrangeControl:function(e,t){e._arranger=enyo.mixin(e._arranger||{},t)},flow:function(){this.c$=[].concat(this.container.getPanels()),this.controlsIndex=0;for(var e,t=0,i=this.container.getPanels();e=i[t];t++)if(enyo.dom.accelerate(e,this.accelerated),enyo.platform.safari)for(var o,n=e.children,s=0;o=n[s];s++)enyo.dom.accelerate(o,this.accelerated)},reflow:function(){var e=this.container.hasNode();this.containerBounds=e?{width:e.clientWidth,height:e.clientHeight}:{},this.size()},flowArrangement:function(){var e=this.container.arrangement;if(e)for(var t,i=0,o=this.container.getPanels();t=o[i];i++)this.flowControl(t,e[i])},flowControl:function(e,t){enyo.Arranger.positionControl(e,t);var i=t.opacity;null!=i&&enyo.Arranger.opacifyControl(e,i)},getOrderedControls:function(e){for(var t=Math.floor(e),i=t-this.controlsIndex,o=i>0,n=this.c$||[],s=0;Math.abs(i)>s;s++)o?n.push(n.shift()):n.unshift(n.pop());return this.controlsIndex=t,n},statics:{positionControl:function(e,t,i){var o=i||"px";if(!this.updating)if(enyo.dom.canTransform()&&!enyo.platform.android&&10!==enyo.platform.ie){var n=t.left,s=t.top;n=enyo.isString(n)?n:n&&n+o,s=enyo.isString(s)?s:s&&s+o,enyo.dom.transform(e,{translateX:n||null,translateY:s||null})}else e.setBounds(t,i)},opacifyControl:function(e,t){var i=t;i=i>.99?1:.01>i?0:i,9>enyo.platform.ie?e.applyStyle("filter","progid:DXImageTransform.Microsoft.Alpha(Opacity="+100*i+")"):e.applyStyle("opacity",i)}}});

// CardArranger.js
enyo.kind({name:"enyo.CardArranger",kind:"Arranger",layoutClass:"enyo-arranger enyo-arranger-fit",calcArrangementDifference:function(){return this.containerBounds.width},arrange:function(e){for(var t,i,n=0;t=e[n];n++)i=0===n?1:0,this.arrangeControl(t,{opacity:i})},start:function(){this.inherited(arguments);for(var e,t=this.container.getPanels(),i=0;e=t[i];i++){var n=e.showing;e.setShowing(i==this.container.fromIndex||i==this.container.toIndex),e.showing&&!n&&e.resized()}},finish:function(){this.inherited(arguments);for(var e,t=this.container.getPanels(),i=0;e=t[i];i++)e.setShowing(i==this.container.toIndex)},destroy:function(){for(var e,t=this.container.getPanels(),i=0;e=t[i];i++)enyo.Arranger.opacifyControl(e,1),e.showing||e.setShowing(!0);this.inherited(arguments)}});

// CardSlideInArranger.js
enyo.kind({name:"enyo.CardSlideInArranger",kind:"CardArranger",start:function(){for(var e,t=this.container.getPanels(),i=0;e=t[i];i++){var n=e.showing;e.setShowing(i==this.container.fromIndex||i==this.container.toIndex),e.showing&&!n&&e.resized()}var o=this.container.fromIndex;i=this.container.toIndex,this.container.transitionPoints=[i+"."+o+".s",i+"."+o+".f"]},finish:function(){this.inherited(arguments);for(var e,t=this.container.getPanels(),i=0;e=t[i];i++)e.setShowing(i==this.container.toIndex)},arrange:function(e,t){for(var i,n,o=t.split("."),s=o[0],a=o[1],r="s"==o[2],h=this.containerBounds.width,l=0,d=this.container.getPanels();i=d[l];l++)n=h,a==l&&(n=r?0:-h),s==l&&(n=r?h:0),a==l&&a==s&&(n=0),this.arrangeControl(i,{left:n})},destroy:function(){for(var e,t=this.container.getPanels(),i=0;e=t[i];i++)enyo.Arranger.positionControl(e,{left:null});this.inherited(arguments)}});

// CarouselArranger.js
enyo.kind({name:"enyo.CarouselArranger",kind:"Arranger",size:function(){var e,t,i,n,o,s=this.container.getPanels(),r=this.containerPadding=this.container.hasNode()?enyo.dom.calcPaddingExtents(this.container.node):{},a=this.containerBounds;a.height-=r.top+r.bottom,a.width-=r.left+r.right;var h;for(e=0,i=0;o=s[e];e++)n=enyo.dom.calcMarginExtents(o.hasNode()),o.width=o.getBounds().width,o.marginWidth=n.right+n.left,i+=(o.fit?0:o.width)+o.marginWidth,o.fit&&(h=o);if(h){var l=a.width-i;h.width=l>=0?l:h.width}for(e=0,t=r.left;o=s[e];e++)o.setBounds({top:r.top,bottom:r.bottom,width:o.fit?o.width:null})},arrange:function(e,t){this.container.wrap?this.arrangeWrap(e,t):this.arrangeNoWrap(e,t)},arrangeNoWrap:function(e,t){var i,n,o,s,r=this.container.getPanels(),a=this.container.clamp(t),h=this.containerBounds.width;for(i=a,o=0;(s=r[i])&&(o+=s.width+s.marginWidth,!(o>h));i++);var l=h-o,d=0;if(l>0)for(i=a-1,n=0;s=r[i];i--)if(n+=s.width+s.marginWidth,0>=l-n){d=l-n,a=i;break}var g,c;for(i=0,c=this.containerPadding.left+d;s=r[i];i++)g=s.width+s.marginWidth,a>i?this.arrangeControl(s,{left:-g}):(this.arrangeControl(s,{left:Math.floor(c)}),c+=g)},arrangeWrap:function(e){for(var t,i=0,n=this.containerPadding.left;t=e[i];i++)this.arrangeControl(t,{left:n}),n+=t.width+t.marginWidth},calcArrangementDifference:function(e,t,i,n){var o=Math.abs(e%this.c$.length);return t[o].left-n[o].left},destroy:function(){for(var e,t=this.container.getPanels(),i=0;e=t[i];i++)enyo.Arranger.positionControl(e,{left:null,top:null}),e.applyStyle("top",null),e.applyStyle("bottom",null),e.applyStyle("left",null),e.applyStyle("width",null);this.inherited(arguments)}});

// CollapsingArranger.js
enyo.kind({name:"enyo.CollapsingArranger",kind:"CarouselArranger",peekWidth:0,size:function(){this.clearLastSize(),this.inherited(arguments)},clearLastSize:function(){for(var e,t=0,i=this.container.getPanels();e=i[t];t++)e._fit&&t!=i.length-1&&(e.applyStyle("width",null),e._fit=null)},constructor:function(){this.inherited(arguments),this.peekWidth=null!=this.container.peekWidth?this.container.peekWidth:this.peekWidth},arrange:function(e,t){for(var i,n=this.container.getPanels(),o=0,s=this.containerPadding.left,r=0;i=n[o];o++)i.getShowing()?(this.arrangeControl(i,{left:s+r*this.peekWidth}),o>=t&&(s+=i.width+i.marginWidth-this.peekWidth),r++):(this.arrangeControl(i,{left:s}),o>=t&&(s+=i.width+i.marginWidth)),o==n.length-1&&0>t&&this.arrangeControl(i,{left:s-t})},calcArrangementDifference:function(e,t,i,n){var o=this.container.getPanels().length-1;return Math.abs(n[o].left-t[o].left)},flowControl:function(e,t){if(this.inherited(arguments),this.container.realtimeFit){var i=this.container.getPanels(),n=i.length-1,o=i[n];e==o&&this.fitControl(e,t.left)}},finish:function(){if(this.inherited(arguments),!this.container.realtimeFit&&this.containerBounds){var e=this.container.getPanels(),t=this.container.arrangement,i=e.length-1,n=e[i];this.fitControl(n,t[i].left)}},fitControl:function(e,t){e._fit=!0,e.applyStyle("width",this.containerBounds.width-t+"px"),e.resized()}});

// DockRightArranger.js
enyo.kind({name:"enyo.DockRightArranger",kind:"Arranger",basePanel:!1,overlap:0,layoutWidth:0,constructor:function(){this.inherited(arguments),this.overlap=null!=this.container.overlap?this.container.overlap:this.overlap,this.layoutWidth=null!=this.container.layoutWidth?this.container.layoutWidth:this.layoutWidth},size:function(){var e,t,i,n=this.container.getPanels(),o=this.containerPadding=this.container.hasNode()?enyo.dom.calcPaddingExtents(this.container.node):{},s=this.containerBounds;s.width-=o.left+o.right;var r,a=s.width,h=n.length;for(this.container.transitionPositions={},e=0;i=n[e];e++)i.width=0===e&&this.container.basePanel?a:i.getBounds().width;for(e=0;i=n[e];e++){0===e&&this.container.basePanel&&i.setBounds({width:a}),i.setBounds({top:o.top,bottom:o.bottom});for(var l=0;i=n[l];l++){var d;if(0===e&&this.container.basePanel)d=0;else if(e>l)d=a;else{if(e!==l)break;r=a>this.layoutWidth?this.overlap:0,d=a-n[e].width+r}this.container.transitionPositions[e+"."+l]=d}if(h>l)for(var g=!1,c=e+1;h>c;c++){if(r=0,g)r=0;else if(n[e].width+n[c].width-this.overlap>a)r=0,g=!0;else{for(r=n[e].width-this.overlap,t=e;c>t;t++){var u=r+n[t+1].width-this.overlap;if(!(a>u)){r=a;break}r=u}r=a-r}this.container.transitionPositions[e+"."+c]=r}}},arrange:function(e,t){var i,n,o=this.container.getPanels(),s=this.container.clamp(t);for(i=0;n=o[i];i++){var r=this.container.transitionPositions[i+"."+s];this.arrangeControl(n,{left:r})}},calcArrangementDifference:function(e,t,i){var n=this.container.getPanels(),o=i>e?n[i].width:n[e].width;return o},destroy:function(){for(var e,t=this.container.getPanels(),i=0;e=t[i];i++)enyo.Arranger.positionControl(e,{left:null,top:null}),e.applyStyle("top",null),e.applyStyle("bottom",null),e.applyStyle("left",null),e.applyStyle("width",null);this.inherited(arguments)}});

// OtherArrangers.js
enyo.kind({name:"enyo.LeftRightArranger",kind:"Arranger",margin:40,axisSize:"width",offAxisSize:"height",axisPosition:"left",constructor:function(){this.inherited(arguments),this.margin=null!=this.container.margin?this.container.margin:this.margin},size:function(){for(var t,e,i=this.container.getPanels(),n=this.containerBounds[this.axisSize],o=n-this.margin-this.margin,s=0;e=i[s];s++)t={},t[this.axisSize]=o,t[this.offAxisSize]="100%",e.setBounds(t)},start:function(){this.inherited(arguments);for(var t,e=this.container.fromIndex,i=this.container.toIndex,n=this.getOrderedControls(i),o=Math.floor(n.length/2),s=0;t=n[s];s++)e>i?s==n.length-o?t.applyStyle("z-index",0):t.applyStyle("z-index",1):s==n.length-1-o?t.applyStyle("z-index",0):t.applyStyle("z-index",1)},arrange:function(t,e){var i,n,o;if(1==this.container.getPanels().length)return o={},o[this.axisPosition]=this.margin,this.arrangeControl(this.container.getPanels()[0],o),void 0;var s=Math.floor(this.container.getPanels().length/2),r=this.getOrderedControls(Math.floor(e)-s),a=this.containerBounds[this.axisSize]-this.margin-this.margin,h=this.margin-a*s;for(i=0;n=r[i];i++)o={},o[this.axisPosition]=h,this.arrangeControl(n,o),h+=a},calcArrangementDifference:function(t,e,i,n){if(1==this.container.getPanels().length)return 0;var o=Math.abs(t%this.c$.length);return e[o][this.axisPosition]-n[o][this.axisPosition]},destroy:function(){for(var t,e=this.container.getPanels(),i=0;t=e[i];i++)enyo.Arranger.positionControl(t,{left:null,top:null}),enyo.Arranger.opacifyControl(t,1),t.applyStyle("left",null),t.applyStyle("top",null),t.applyStyle("height",null),t.applyStyle("width",null);this.inherited(arguments)}}),enyo.kind({name:"enyo.TopBottomArranger",kind:"LeftRightArranger",dragProp:"ddy",dragDirectionProp:"yDirection",canDragProp:"vertical",axisSize:"height",offAxisSize:"width",axisPosition:"top"}),enyo.kind({name:"enyo.SpiralArranger",kind:"Arranger",incrementalPoints:!0,inc:20,size:function(){for(var t,e=this.container.getPanels(),i=this.containerBounds,n=this.controlWidth=i.width/3,o=this.controlHeight=i.height/3,s=0;t=e[s];s++)t.setBounds({width:n,height:o})},arrange:function(t){for(var e,i=this.inc,n=0,o=t.length;e=t[n];n++){var s=Math.cos(2*(n/o)*Math.PI)*n*i+this.controlWidth,r=Math.sin(2*(n/o)*Math.PI)*n*i+this.controlHeight;this.arrangeControl(e,{left:s,top:r})}},start:function(){this.inherited(arguments);for(var t,e=this.getOrderedControls(this.container.toIndex),i=0;t=e[i];i++)t.applyStyle("z-index",e.length-i)},calcArrangementDifference:function(){return this.controlWidth},destroy:function(){for(var t,e=this.container.getPanels(),i=0;t=e[i];i++)t.applyStyle("z-index",null),enyo.Arranger.positionControl(t,{left:null,top:null}),t.applyStyle("left",null),t.applyStyle("top",null),t.applyStyle("height",null),t.applyStyle("width",null);this.inherited(arguments)}}),enyo.kind({name:"enyo.GridArranger",kind:"Arranger",incrementalPoints:!0,colWidth:100,colHeight:100,size:function(){for(var t,e=this.container.getPanels(),i=this.colWidth,n=this.colHeight,o=0;t=e[o];o++)t.setBounds({width:i,height:n})},arrange:function(t){for(var e,i=this.colWidth,n=this.colHeight,o=Math.max(1,Math.floor(this.containerBounds.width/i)),s=0,r=0;t.length>r;s++)for(var a=0;o>a&&(e=t[r]);a++,r++)this.arrangeControl(e,{left:i*a,top:n*s})},flowControl:function(t,e){this.inherited(arguments),enyo.Arranger.opacifyControl(t,0!==e.top%this.colHeight?.25:1)},calcArrangementDifference:function(){return this.colWidth},destroy:function(){for(var t,e=this.container.getPanels(),i=0;t=e[i];i++)enyo.Arranger.positionControl(t,{left:null,top:null}),t.applyStyle("left",null),t.applyStyle("top",null),t.applyStyle("height",null),t.applyStyle("width",null);this.inherited(arguments)}});

// Panels.js
enyo.kind({name:"enyo.Panels",classes:"enyo-panels",published:{index:0,draggable:!0,animate:!0,wrap:!1,arrangerKind:"CardArranger",narrowFit:!0},events:{onTransitionStart:"",onTransitionFinish:""},handlers:{ondragstart:"dragstart",ondrag:"drag",ondragfinish:"dragfinish",onscroll:"domScroll"},tools:[{kind:"Animator",onStep:"step",onEnd:"completed"}],fraction:0,create:function(){this.transitionPoints=[],this.inherited(arguments),this.arrangerKindChanged(),this.narrowFitChanged(),this.indexChanged()},rendered:function(){this.inherited(arguments),enyo.makeBubble(this,"scroll")},domScroll:function(){this.hasNode()&&this.node.scrollLeft>0&&(this.node.scrollLeft=0)},initComponents:function(){this.createChrome(this.tools),this.inherited(arguments)},arrangerKindChanged:function(){this.setLayoutKind(this.arrangerKind)},narrowFitChanged:function(){this.addRemoveClass("enyo-panels-fit-narrow",this.narrowFit)},destroy:function(){this.destroying=!0,this.inherited(arguments)},removeControl:function(t){if(this.destroying)return this.inherited(arguments);var e=-1,i=enyo.indexOf(t,this.controls);i===this.index&&(e=Math.max(i-1,0)),this.inherited(arguments),-1!==e&&this.controls.length>0&&(this.setIndex(e),this.flow(),this.reflow())},isPanel:function(){return!0},flow:function(){this.arrangements=[],this.inherited(arguments)},reflow:function(){this.arrangements=[],this.inherited(arguments),this.refresh()},getPanels:function(){var t=this.controlParent||this;return t.children},getActive:function(){var t=this.getPanels(),e=this.index%t.length;return 0>e&&(e+=t.length),t[e]},getAnimator:function(){return this.$.animator},setIndex:function(t){var e=this.get("index");this.index=this.clamp(t),this.notifyObservers("index",e,t)},setIndexDirect:function(t){this.setIndex(t),this.completed()},selectPanelByName:function(t){if(t)for(var e=0,i=this.getPanels(),n=i.length;n>e;++e)if(t===i[e].name)return this.setIndex(e),e},previous:function(){var t=this.index-1;this.wrap&&0>t&&(t=this.getPanels().length-1),this.setIndex(t)},next:function(){var t=this.index+1;this.wrap&&t>=this.getPanels().length&&(t=0),this.setIndex(t)},clamp:function(t){var e=this.getPanels().length-1;return this.wrap?t:Math.max(0,Math.min(t,e))},indexChanged:function(t){this.lastIndex=t,!this.dragging&&this.$.animator&&(this.$.animator.isAnimating()&&(this.finishTransitionInfo&&(this.finishTransitionInfo.animating=!0),this.completed()),this.$.animator.stop(),this.hasNode()&&(this.animate?(this.startTransition(),this.$.animator.play({startValue:this.fraction})):this.refresh()))},step:function(t){this.fraction=t.value,this.stepTransition()},completed:function(){return this.$.animator.isAnimating()&&this.$.animator.stop(),this.fraction=1,this.stepTransition(),this.finishTransition(),!0},dragstart:function(t,e){return this.draggable&&this.layout&&this.layout.canDragEvent(e)?(e.preventDefault(),this.dragstartTransition(e),this.dragging=!0,this.$.animator.stop(),!0):void 0},drag:function(t,e){this.dragging&&(e.preventDefault(),this.dragTransition(e))},dragfinish:function(t,e){this.dragging&&(this.dragging=!1,e.preventTap(),this.dragfinishTransition(e))},dragstartTransition:function(t){if(this.$.animator.isAnimating())this.verifyDragTransition(t);else{var e=this.fromIndex=this.index;this.toIndex=e-(this.layout?this.layout.calcDragDirection(t):0)}this.fromIndex=this.clamp(this.fromIndex),this.toIndex=this.clamp(this.toIndex),this.fireTransitionStart(),this.layout&&this.layout.start()},dragTransition:function(t){var e=this.layout?this.layout.calcDrag(t):0,i=this.transitionPoints,n=i[0],o=i[i.length-1],s=this.fetchArrangement(n),r=this.fetchArrangement(o),a=this.layout?this.layout.drag(e,n,s,o,r):0,h=e&&!a;this.fraction+=a;var l=this.fraction;(l>1||0>l||h)&&((l>0||h)&&this.dragfinishTransition(t),this.dragstartTransition(t),this.fraction=0),this.stepTransition()},dragfinishTransition:function(t){this.verifyDragTransition(t),this.setIndex(this.toIndex),this.dragging&&this.fireTransitionFinish()},verifyDragTransition:function(t){var e=this.layout?this.layout.calcDragDirection(t):0,i=Math.min(this.fromIndex,this.toIndex),n=Math.max(this.fromIndex,this.toIndex);if(e>0){var o=i;i=n,n=o}i!=this.fromIndex&&(this.fraction=1-this.fraction),this.fromIndex=i,this.toIndex=n},refresh:function(){this.$.animator&&this.$.animator.isAnimating()&&this.$.animator.stop(),this.startTransition(),this.fraction=1,this.stepTransition(),this.finishTransition()},startTransition:function(){this.fromIndex=null!=this.fromIndex?this.fromIndex:this.lastIndex||0,this.toIndex=null!=this.toIndex?this.toIndex:this.index,this.layout&&this.layout.start(),this.fireTransitionStart()},finishTransition:function(){this.layout&&this.layout.finish(),this.transitionPoints=[],this.fraction=0,this.fromIndex=this.toIndex=null,this.fireTransitionFinish()},fireTransitionStart:function(){var t=this.startTransitionInfo;!this.hasNode()||t&&t.fromIndex==this.fromIndex&&t.toIndex==this.toIndex||(this.startTransitionInfo={fromIndex:this.fromIndex,toIndex:this.toIndex},this.doTransitionStart(enyo.clone(this.startTransitionInfo)))},fireTransitionFinish:function(){var t=this.finishTransitionInfo;!this.hasNode()||t&&t.fromIndex==this.lastIndex&&t.toIndex==this.index||(this.finishTransitionInfo=t&&t.animating?{fromIndex:t.toIndex,toIndex:this.lastIndex}:{fromIndex:this.lastIndex,toIndex:this.index},this.doTransitionFinish(enyo.clone(this.finishTransitionInfo)))},stepTransition:function(){if(this.hasNode()){var t=this.transitionPoints,e=(this.fraction||0)*(t.length-1),i=Math.floor(e);e-=i;var n=t[i],o=t[i+1],s=this.fetchArrangement(n),r=this.fetchArrangement(o);this.arrangement=s&&r?enyo.Panels.lerp(s,r,e):s||r,this.arrangement&&this.layout&&this.layout.flowArrangement()}},fetchArrangement:function(t){return null!=t&&!this.arrangements[t]&&this.layout&&(this.layout._arrange(t),this.arrangements[t]=this.readArrangement(this.getPanels())),this.arrangements[t]},readArrangement:function(t){for(var e,i=[],n=0,o=t;e=o[n];n++)i.push(enyo.clone(e._arranger));return i},statics:{isScreenNarrow:function(){return 800>=enyo.dom.getWindowWidth()},lerp:function(t,e,i){for(var n,o=[],s=0,r=enyo.keys(t);n=r[s];s++)o.push(this.lerpObject(t[n],e[n],i));return o},lerpObject:function(t,e,i){var n,o,s=enyo.clone(t);if(e)for(var r in t)n=t[r],o=e[r],n!=o&&(s[r]=n-(n-o)*i);return s}}});

// Node.js
enyo.kind({name:"enyo.Node",published:{expandable:!1,expanded:!1,icon:"",onlyIconExpands:!1,selected:!1},style:"padding: 0 0 0 16px;",content:"Node",defaultKind:"Node",classes:"enyo-node",components:[{name:"icon",kind:"Image",showing:!1},{kind:"Control",name:"caption",Xtag:"span",style:"display: inline-block; padding: 4px;",allowHtml:!0},{kind:"Control",name:"extra",tag:"span",allowHtml:!0}],childClient:[{kind:"Control",name:"box",classes:"enyo-node-box",Xstyle:"border: 1px solid orange;",components:[{kind:"Control",name:"client",classes:"enyo-node-client",Xstyle:"border: 1px solid lightblue;"}]}],handlers:{ondblclick:"dblclick"},events:{onNodeTap:"nodeTap",onNodeDblClick:"nodeDblClick",onExpand:"nodeExpand",onDestroyed:"nodeDestroyed"},create:function(){this.inherited(arguments),this.selectedChanged(),this.iconChanged()},destroy:function(){this.doDestroyed(),this.inherited(arguments)},initComponents:function(){this.expandable&&(this.kindComponents=this.kindComponents.concat(this.childClient)),this.inherited(arguments)},contentChanged:function(){this.$.caption.setContent(this.content)},iconChanged:function(){this.$.icon.setSrc(this.icon),this.$.icon.setShowing(Boolean(this.icon))},selectedChanged:function(){this.addRemoveClass("enyo-selected",this.selected)},rendered:function(){this.inherited(arguments),this.expandable&&!this.expanded&&this.quickCollapse()},addNodes:function(t){this.destroyClientControls();for(var e,i=0;e=t[i];i++)this.createComponent(e);this.$.client.render()},addTextNodes:function(t){this.destroyClientControls();for(var e,i=0;e=t[i];i++)this.createComponent({content:e});this.$.client.render()},tap:function(t,e){return this.onlyIconExpands?e.target==this.$.icon.hasNode()?this.toggleExpanded():this.doNodeTap():(this.toggleExpanded(),this.doNodeTap()),!0},dblclick:function(){return this.doNodeDblClick(),!0},toggleExpanded:function(){this.setExpanded(!this.expanded)},quickCollapse:function(){this.removeClass("enyo-animate"),this.$.box.applyStyle("height","0");var t=this.$.client.getBounds().height;this.$.client.setBounds({top:-t})},_expand:function(){this.addClass("enyo-animate");var t=this.$.client.getBounds().height;this.$.box.setBounds({height:t}),this.$.client.setBounds({top:0}),setTimeout(this.bindSafely(function(){this.expanded&&(this.removeClass("enyo-animate"),this.$.box.applyStyle("height","auto"))}),225)},_collapse:function(){this.removeClass("enyo-animate");var t=this.$.client.getBounds().height;this.$.box.setBounds({height:t}),setTimeout(this.bindSafely(function(){this.addClass("enyo-animate"),this.$.box.applyStyle("height","0"),this.$.client.setBounds({top:-t})}),25)},expandedChanged:function(){if(this.expandable){var t={expanded:this.expanded};this.doExpand(t),t.wait||this.effectExpanded()}else this.expanded=!1},effectExpanded:function(){this.$.client&&(this.expanded?this._expand():this._collapse())}});

// ImageViewPin.js
enyo.kind({name:"enyo.ImageViewPin",kind:"enyo.Control",published:{highlightAnchorPoint:!1,anchor:{top:0,left:0},position:{top:0,left:0}},style:"position:absolute;z-index:1000;width:0px;height:0px;",handlers:{onPositionPin:"reAnchor"},create:function(){this.inherited(arguments),this.styleClientControls(),this.positionClientControls(),this.highlightAnchorPointChanged(),this.anchorChanged()},styleClientControls:function(){for(var t=this.getClientControls(),e=0;t.length>e;e++)t[e].applyStyle("position","absolute")},positionClientControls:function(){for(var t=this.getClientControls(),e=0;t.length>e;e++)for(var i in this.position)t[e].applyStyle(i,this.position[i]+"px")},highlightAnchorPointChanged:function(){this.addRemoveClass("pinDebug",this.highlightAnchorPoint)},anchorChanged:function(){var t=null,e=null;for(e in this.anchor)t=(""+this.anchor[e]).match(/^(\d+(?:\.\d+)?)(.*)$/),t&&(this.anchor[e+"Coords"]={value:t[1],units:t[2]||"px"})},reAnchor:function(t,e){var i=e.scale,n=e.bounds,o=this.anchor.right?"px"==this.anchor.rightCoords.units?n.width+n.x-this.anchor.rightCoords.value*i:n.width*(100-this.anchor.rightCoords.value)/100+n.x:"px"==this.anchor.leftCoords.units?this.anchor.leftCoords.value*i+n.x:n.width*this.anchor.leftCoords.value/100+n.x,s=this.anchor.bottom?"px"==this.anchor.bottomCoords.units?n.height+n.y-this.anchor.bottomCoords.value*i:n.height*(100-this.anchor.bottomCoords.value)/100+n.y:"px"==this.anchor.topCoords.units?this.anchor.topCoords.value*i+n.y:n.height*this.anchor.topCoords.value/100+n.y;this.applyStyle("left",o+"px"),this.applyStyle("top",s+"px")}});

// ImageView.js
enyo.kind({name:"enyo.ImageView",kind:enyo.Scroller,touchOverscroll:!1,thumb:!1,animate:!0,verticalDragPropagation:!0,horizontalDragPropagation:!0,published:{scale:"auto",disableZoom:!1,src:void 0},events:{onZoom:""},touch:!0,preventDragPropagation:!1,handlers:{ondragstart:"dragPropagation"},components:[{name:"animator",kind:"Animator",onStep:"zoomAnimationStep",onEnd:"zoomAnimationEnd"},{name:"viewport",style:"overflow:hidden;min-height:100%;min-width:100%;",classes:"enyo-fit",ongesturechange:"gestureTransform",ongestureend:"saveState",ontap:"singleTap",ondblclick:"doubleClick",onmousewheel:"mousewheel",components:[{kind:"Image",ondown:"down"}]}],create:function(){this.inherited(arguments),this.canTransform=enyo.dom.canTransform(),this.canTransform||this.$.image.applyStyle("position","relative"),this.canAccelerate=enyo.dom.canAccelerate(),this.bufferImage=new Image,this.bufferImage.onload=this.bindSafely("imageLoaded"),this.bufferImage.onerror=this.bindSafely("imageError"),this.srcChanged(),this.getStrategy().setDragDuringGesture(!1),this.getStrategy().$.scrollMath&&this.getStrategy().$.scrollMath.start()},destroy:function(){this.bufferImage&&(this.bufferImage.onerror=void 0,this.bufferImage.onerror=void 0,delete this.bufferImage),this.inherited(arguments)},down:function(t,e){e.preventDefault()},dragPropagation:function(t,e){var i=this.getStrategy().getScrollBounds(),n=0===i.top&&e.dy>0||i.top>=i.maxTop-2&&0>e.dy,o=0===i.left&&e.dx>0||i.left>=i.maxLeft-2&&0>e.dx;return!(n&&this.verticalDragPropagation||o&&this.horizontalDragPropagation)},mousewheel:function(t,e){e.pageX|=e.clientX+e.target.scrollLeft,e.pageY|=e.clientY+e.target.scrollTop;var i=(this.maxScale-this.minScale)/10,n=this.scale;return e.wheelDelta>0||0>e.detail?this.scale=this.limitScale(this.scale+i):(0>e.wheelDelta||e.detail>0)&&(this.scale=this.limitScale(this.scale-i)),this.eventPt=this.calcEventLocation(e),this.transformImage(this.scale),n!=this.scale&&this.doZoom({scale:this.scale}),this.ratioX=this.ratioY=null,e.preventDefault(),!0},srcChanged:function(){this.src&&this.src.length>0&&this.bufferImage&&this.src!=this.bufferImage.src&&(this.bufferImage.src=this.src)},imageLoaded:function(){this.originalWidth=this.bufferImage.width,this.originalHeight=this.bufferImage.height,this.scaleChanged(),this.$.image.setSrc(this.bufferImage.src),enyo.dom.transformValue(this.getStrategy().$.client,"translate3d","0px, 0px, 0"),this.positionClientControls(this.scale),this.alignImage()},resizeHandler:function(){this.inherited(arguments),this.$.image.src&&this.scaleChanged()},scaleChanged:function(){var t=this.hasNode();if(t){this.containerWidth=t.clientWidth,this.containerHeight=t.clientHeight;var e=this.containerWidth/this.originalWidth,i=this.containerHeight/this.originalHeight;this.minScale=Math.min(e,i),this.maxScale=1>3*this.minScale?1:3*this.minScale,"auto"==this.scale?this.scale=this.minScale:"width"==this.scale?this.scale=e:"height"==this.scale?this.scale=i:"fit"==this.scale?(this.fitAlignment="center",this.scale=Math.max(e,i)):(this.maxScale=Math.max(this.maxScale,this.scale),this.scale=this.limitScale(this.scale))}this.eventPt=this.calcEventLocation(),this.transformImage(this.scale)},imageError:function(t){enyo.error("Error loading image: "+this.src),this.bubble("onerror",t)},alignImage:function(){if(this.fitAlignment&&"center"===this.fitAlignment){var t=this.getScrollBounds();this.setScrollLeft(t.maxLeft/2),this.setScrollTop(t.maxTop/2)}},gestureTransform:function(t,e){this.eventPt=this.calcEventLocation(e),this.transformImage(this.limitScale(this.scale*e.scale))},calcEventLocation:function(t){var e={x:0,y:0};if(t&&this.hasNode()){var i=this.node.getBoundingClientRect();e.x=Math.round(t.pageX-i.left-this.imageBounds.x),e.x=Math.max(0,Math.min(this.imageBounds.width,e.x)),e.y=Math.round(t.pageY-i.top-this.imageBounds.y),e.y=Math.max(0,Math.min(this.imageBounds.height,e.y))}return e},transformImage:function(t){this.tapped=!1;var e=this.imageBounds||this.innerImageBounds(t);this.imageBounds=this.innerImageBounds(t),this.scale>this.minScale?this.$.viewport.applyStyle("cursor","move"):this.$.viewport.applyStyle("cursor",null),this.$.viewport.setBounds({width:this.imageBounds.width+"px",height:this.imageBounds.height+"px"}),this.ratioX=this.ratioX||(this.eventPt.x+this.getScrollLeft())/e.width,this.ratioY=this.ratioY||(this.eventPt.y+this.getScrollTop())/e.height;var i,n;if(this.$.animator.ratioLock?(i=this.$.animator.ratioLock.x*this.imageBounds.width-this.containerWidth/2,n=this.$.animator.ratioLock.y*this.imageBounds.height-this.containerHeight/2):(i=this.ratioX*this.imageBounds.width-this.eventPt.x,n=this.ratioY*this.imageBounds.height-this.eventPt.y),i=Math.max(0,Math.min(this.imageBounds.width-this.containerWidth,i)),n=Math.max(0,Math.min(this.imageBounds.height-this.containerHeight,n)),this.canTransform){var o={scale:t};o=this.canAccelerate?enyo.mixin({translate3d:Math.round(this.imageBounds.left)+"px, "+Math.round(this.imageBounds.top)+"px, 0px"},o):enyo.mixin({translate:this.imageBounds.left+"px, "+this.imageBounds.top+"px"},o),enyo.dom.transform(this.$.image,o)}else this.$.image.setBounds({width:this.imageBounds.width+"px",height:this.imageBounds.height+"px",left:this.imageBounds.left+"px",top:this.imageBounds.top+"px"});this.setScrollLeft(i),this.setScrollTop(n),this.positionClientControls(t)},limitScale:function(t){return this.disableZoom?t=this.scale:t>this.maxScale?t=this.maxScale:this.minScale>t&&(t=this.minScale),t},innerImageBounds:function(t){var e=this.originalWidth*t,i=this.originalHeight*t,n={x:0,y:0,transX:0,transY:0};return this.containerWidth>e&&(n.x+=(this.containerWidth-e)/2),this.containerHeight>i&&(n.y+=(this.containerHeight-i)/2),this.canTransform&&(n.transX-=(this.originalWidth-e)/2,n.transY-=(this.originalHeight-i)/2),{left:n.x+n.transX,top:n.y+n.transY,width:e,height:i,x:n.x,y:n.y}},saveState:function(t,e){var i=this.scale;this.scale*=e.scale,this.scale=this.limitScale(this.scale),i!=this.scale&&this.doZoom({scale:this.scale}),this.ratioX=this.ratioY=null},doubleClick:function(t,e){8==enyo.platform.ie&&(this.tapped=!0,e.pageX=e.clientX+e.target.scrollLeft,e.pageY=e.clientY+e.target.scrollTop,this.singleTap(t,e),e.preventDefault())},singleTap:function(t,e){setTimeout(this.bindSafely(function(){this.tapped=!1}),300),this.tapped?(this.tapped=!1,this.smartZoom(t,e)):this.tapped=!0},smartZoom:function(t,e){var i=this.hasNode(),n=this.$.image.hasNode();if(i&&n&&this.hasNode()&&!this.disableZoom){var o=this.scale;if(this.scale=this.scale!=this.minScale?this.minScale:this.maxScale,this.eventPt=this.calcEventLocation(e),this.animate){var s={x:(this.eventPt.x+this.getScrollLeft())/this.imageBounds.width,y:(this.eventPt.y+this.getScrollTop())/this.imageBounds.height};this.$.animator.play({duration:350,ratioLock:s,baseScale:o,deltaScale:this.scale-o})}else this.transformImage(this.scale),this.doZoom({scale:this.scale})}},zoomAnimationStep:function(){var t=this.$.animator.baseScale+this.$.animator.deltaScale*this.$.animator.value;this.transformImage(t)},zoomAnimationEnd:function(){this.doZoom({scale:this.scale}),this.$.animator.ratioLock=void 0},positionClientControls:function(t){this.waterfallDown("onPositionPin",{scale:t,bounds:this.imageBounds})}});

// ImageCarousel.js
enyo.kind({name:"enyo.ImageCarousel",kind:enyo.Panels,arrangerKind:"enyo.CarouselArranger",defaultScale:"auto",disableZoom:!1,lowMemory:!1,published:{images:[]},handlers:{onTransitionStart:"transitionStart",onTransitionFinish:"transitionFinish"},create:function(){this.inherited(arguments),this.imageCount=this.images.length,this.images.length>0&&(this.initContainers(),this.loadNearby())},initContainers:function(){for(var t=0;this.images.length>t;t++)this.$["container"+t]||(this.createComponent({name:"container"+t,style:"height:100%; width:100%;"}),this.$["container"+t].render());for(t=this.images.length;this.imageCount>t;t++)this.$["image"+t]&&this.$["image"+t].destroy(),this.$["container"+t].destroy();this.imageCount=this.images.length},loadNearby:function(){var t=this.getBufferRange();for(var e in t)this.loadImageView(t[e])},getBufferRange:function(){var t=[];if(this.layout.containerBounds){var e,i,n,o,s=1,a=this.layout.containerBounds;for(i=this.index-1,n=0,o=a.width*s;i>=0&&o>=n;)e=this.$["container"+i],n+=e.width+e.marginWidth,t.unshift(i),i--;for(i=this.index,n=0,o=a.width*(s+1);this.images.length>i&&o>=n;)e=this.$["container"+i],n+=e.width+e.marginWidth,t.push(i),i++}return t},reflow:function(){this.inherited(arguments),this.loadNearby()},loadImageView:function(t){return this.wrap&&(t=(t%this.images.length+this.images.length)%this.images.length),t>=0&&this.images.length-1>=t&&(this.$["image"+t]?this.$["image"+t].src!=this.images[t]&&(this.$["image"+t].setSrc(this.images[t]),this.$["image"+t].setScale(this.defaultScale),this.$["image"+t].setDisableZoom(this.disableZoom)):(this.$["container"+t].createComponent({name:"image"+t,kind:"ImageView",scale:this.defaultScale,disableZoom:this.disableZoom,src:this.images[t],verticalDragPropagation:!1,style:"height:100%; width:100%;"},{owner:this}),this.$["image"+t].render())),this.$["image"+t]},setImages:function(t){this.set("images",t)},imagesChanged:function(){this.initContainers(),this.loadNearby()},indexChanged:function(){this.loadNearby(),this.lowMemory&&this.cleanupMemory(),this.inherited(arguments)},transitionStart:function(t,e){return e.fromIndex==e.toIndex?!0:void 0},transitionFinish:function(){this.loadNearby(),this.lowMemory&&this.cleanupMemory()},getActiveImage:function(){return this.getImageByIndex(this.index)},getImageByIndex:function(t){return this.$["image"+t]||this.loadImageView(t)},cleanupMemory:function(){for(var t=this.getBufferRange(),e=0;this.images.length>e;e++)-1===enyo.indexOf(e,t)&&this.$["image"+e]&&this.$["image"+e].destroy()}});

// kind.FlexLayout.js
enyo.kind({name:"enyo.FlexLayout",kind:"Layout",orient:"horizontal",pack:"start",align:"stretch",prefix:"-webkit",defaultFlex:10,_getAbsoluteBounds:function(t){var e=0,i=0,n=null,o=t instanceof enyo.Control?t.hasNode():t,s=o.offsetWidth,a=o.offsetHeight,r=enyo.dom.getStyleTransformProp(),h=/translateX\((-?\d+)px\)/i,l=/translateY\((-?\d+)px\)/i;if(o.offsetParent)do e+=o.offsetLeft-(o.offsetParent?o.offsetParent.scrollLeft:0),i+=o.offsetTop-(o.offsetParent?o.offsetParent.scrollTop:0),r&&(n=o.style[r].match(h),n&&n[1]!==void 0&&n[1]&&(e+=parseInt(n[1],10)),n=o.style[r].match(l),n&&n[1]!==void 0&&n[1]&&(i+=parseInt(n[1],10)));while(o=o.offsetParent);return{top:i,left:e,bottom:document.body.offsetHeight-i-a,right:document.body.offsetWidth-e-s,height:a,width:s}},_getComputedStyle:function(t,e){return enyo.platform.ie&&9>enyo.platform.ie&&(e=e.replace(/([\-][a-z]+)/gi,function(t){return t.charAt(1).toUpperCase()+t.substr(2)})),t.getComputedStyleValue(e)},_getSumStyleValue:function(t,e){for(var i=0,n=0;e.length>i;i++)n+=parseInt(this._getComputedStyle(t,e[i]),10);return n},_getSumStyles:function(t){var e={v:{margin:this._getSumStyleValue(t,["margin-top","margin-bottom"]),border:this._getSumStyleValue(t,["border-top-width","border-bottom-width"]),padding:this._getSumStyleValue(t,["padding-top","padding-bottom"])},h:{margin:this._getSumStyleValue(t,["margin-left","margin-right"]),border:this._getSumStyleValue(t,["border-left-width","border-right-width"]),padding:this._getSumStyleValue(t,["padding-left","padding-right"])}};return e.h.offset=e.h.margin+e.h.border+e.h.padding,e.v.offset=e.v.margin+e.v.border+e.v.padding,e},_setStyles:function(t,e){enyo.mixin(t.domStyles,e),t.domStylesChanged()},_hasFlexLayout:function(t){return t.layout&&t.layout instanceof enyo.FlexLayout},_getFlex:function(t){return t.flex===void 0||t.flex===!1?0:t.flex===!0?this.defaultFlex:t.flex},_reflowChildrenWebkit:function(){for(var t,e,i,n=0,o="vertical"==this.orient?"height":"width";this.container.children.length>n;n++)t=this.container.children[n],e={},i=this._getFlex(t),this._setStyles(t,{display:"block"}),0!==i&&(e["-webkit-box-flex"]=i,e.overflow="hidden",t.domStyles[o]||(e[o]="0px"),this._setStyles(t,e))},_reflowChildrenMozilla:function(){for(var t,e,i,n=0;this.container.children.length>n;n++)t=this.container.children[n],e={},i=this._getFlex(t),0!==i&&(e["-moz-box-flex"]=i,e.overflow="hidden",this._setStyles(t,e))},_reflowChildrenIE:function(){for(var t,e,i,n=0,o=0,s=[],a=null,r=this._getSumStyles(this.container),h={},l=this._getAbsoluteBounds(this.container),d=0,g=0;this.container.children.length>n;n++)t=this.container.children[n],a=this._getSumStyles(t),i=this._getFlex(t),h=this._getAbsoluteBounds(t),"vertical"==this.orient?(i>0?s.push(t):o+=h.height+a.v.margin+a.v.border,e={overflow:"hidden",width:l.width-r.h.padding-r.h.border-a.h.offset+"px"}):(i>0?s.push(t):o+=h.width+a.h.margin+a.h.border,e={overflow:"hidden","float":"left",height:l.height-r.v.padding-r.v.border-a.v.offset+"px"}),this._setStyles(t,e);for(n=0;s.length>n;n++)t=s[n],a=this._getSumStyles(t),e={},"vertical"==this.orient?(d=Math.floor((l.height-r.v.offset-o)/s.length),e.height=d-a.v.offset+"px"):(g=Math.floor((l.width-r.h.offset-o)/s.length),e.width=g-a.h.offset+"px"),this._setStyles(t,e)},_reflowWebkit:function(){this._setStyles(this.container,{display:"-webkit-box","-webkit-box-pack":this.pack,"-webkit-box-align":this.align,"-webkit-box-orient":this.orient,"box-sizing":"border-box",overflow:"hidden"}),this._reflowChildrenWebkit()},_reflowMozilla:function(){var t={display:"-moz-box","-moz-box-pack":this.pack,"-moz-box-align":this.align,"-moz-box-orient":this.orient,"-moz-box-sizing":"border-box",position:"relative",overflow:"visible"};"horizontal"==this.orient&&(t.height="100%"),this._setStyles(this.container,t),this._reflowChildrenMozilla()},_reflowIE:function(){var t={"box-sizing":"border-box"};"horizontal"==this.orient?t.width="100%":t.height="100%",this._setStyles(this.container,t),this._reflowChildrenIE();var e=this;this._reflowIE.bRepeated||setTimeout(function(){e._reflowIE.bRepeated=!0,e._reflowIE()},50),enyo.FlexLayout.registerFlexLayout(this)},constructor:function(){this.inherited(arguments),this.pack=this.container.pack||this.pack,this.align=this.container.align||this.align},reflow:function(){this._setStyles(this.container,{margin:"0",padding:"0",border:"0",overflow:"hidden"}),enyo.platform.firefox?this._reflowMozilla():enyo.platform.ie?this._reflowIE():this._reflowWebkit()},statics:{_aFlexLayouts:[],registerFlexLayout:function(t){for(var e=!1,i=0;this._aFlexLayouts.length>i;i++)this._aFlexLayouts[i]===t&&(e=!0);e||this._aFlexLayouts.push(t)},unregisterFlexLayout:function(t){for(var e=0;this._aFlexLayouts.length>e;e++)if(this._aFlexLayouts[e]===t)return delete this._aFlexLayouts[e],void 0},reflowFlexLayouts:function(){for(var t=0;this._aFlexLayouts.length>t;t++)this._aFlexLayouts[t].reflow()}}}),enyo.kind({name:"enyo.VFlexLayout",kind:"FlexLayout",orient:"vertical",layoutClass:"enyo-vflex-layout"}),enyo.kind({name:"enyo.HFlexLayout",kind:"FlexLayout",layoutClass:"enyo-hflex-layout",orient:"horizontal"}),enyo.kind({name:"enyo.HFlexBox",kind:enyo.Control,layoutKind:"HFlexLayout"}),enyo.kind({name:"enyo.VFlexBox",kind:enyo.Control,layoutKind:"VFlexLayout"});

// mixin.LayoutInvalidator.js
enyo.platform.ie&&(enyo.createMixin({name:"LayoutInvalidator",invalidateLayout:function(){enyo.FlexLayout.reflowFlexLayouts()},contentChanged:function(){this.inherited(arguments),this.invalidateLayout()},classesChanged:function(){this.inherited(arguments),this.invalidateLayout()}}),enyo.Control.extend({mixins:["LayoutInvalidator"]}));

// Icon.js
enyo.kind({name:"onyx.Icon",published:{src:"",disabled:!1},classes:"onyx-icon",create:function(){this.inherited(arguments),this.src&&this.srcChanged(),this.disabledChanged()},disabledChanged:function(){this.addRemoveClass("disabled",this.disabled)},srcChanged:function(){this.applyStyle("background-image","url("+enyo.path.rewrite(this.src)+")")}});

// Button.js
enyo.kind({name:"onyx.Button",kind:"enyo.Button",classes:"onyx-button enyo-unselectable",create:function(){enyo.platform.firefoxOS&&(this.handlers.ondown="fxosDown",this.handlers.onenter="fxosEnter",this.handlers.ondrag="fxosDrag",this.handlers.onleave="fxosLeave",this.handlers.onup="fxosUp"),this.inherited(arguments)},fxosDown:function(){this.addClass("pressed"),this._isInControl=!0},fxosEnter:function(){this._isInControl=!0},fxosDrag:function(){this.addRemoveClass("pressed",this._isInControl)},fxosLeave:function(){this.removeClass("pressed"),this._isInControl=!1},fxosUp:function(){this.removeClass("pressed"),this._isInControl=!1}});

// IconButton.js
enyo.kind({name:"onyx.IconButton",kind:"onyx.Icon",published:{active:!1},classes:"onyx-icon-button",create:function(){enyo.platform.firefoxOS&&(this.handlers.ondown="fxosDown",this.handlers.onenter="fxosEnter",this.handlers.ondrag="fxosDrag",this.handlers.onleave="fxosLeave",this.handlers.onup="fxosUp"),this.inherited(arguments)},fxosDown:function(){this.addClass("pressed"),this._isInControl=!0},fxosEnter:function(){this._isInControl=!0},fxosDrag:function(){this.addRemoveClass("pressed",this._isInControl)},fxosLeave:function(){this.removeClass("pressed"),this._isInControl=!1},fxosUp:function(){this.removeClass("pressed"),this._isInControl=!1},rendered:function(){this.inherited(arguments),this.activeChanged()},tap:function(){return this.disabled?!0:(this.setActive(!0),void 0)},activeChanged:function(){this.bubble("onActivate")}});

// Checkbox.js
enyo.kind({name:"onyx.Checkbox",classes:"onyx-checkbox",kind:enyo.Checkbox,tag:"div",handlers:{onclick:""},tap:function(){return this.disabled||(this.setChecked(!this.getChecked()),this.bubble("onchange")),!this.disabled},dragstart:function(){}});

// Drawer.js
enyo.kind({name:"onyx.Drawer",kind:"enyo.Drawer"});

// Grabber.js
enyo.kind({name:"onyx.Grabber",classes:"onyx-grabber"});

// Groupbox.js
enyo.kind({name:"onyx.Groupbox",classes:"onyx-groupbox"}),enyo.kind({name:"onyx.GroupboxHeader",classes:"onyx-groupbox-header"});

// Input.js
enyo.kind({name:"onyx.Input",kind:"enyo.Input",classes:"onyx-input"});

// Popup.js
enyo.kind({name:"onyx.Popup",kind:"Popup",classes:"onyx-popup",published:{scrimWhenModal:!0,scrim:!1,scrimClassName:""},statics:{count:0,highestZ:120},defaultZ:120,showingChanged:function(){this.showing?(onyx.Popup.count++,this.applyZIndex()):onyx.Popup.count>0&&onyx.Popup.count--,this.showHideScrim(this.showing),this.inherited(arguments)},showHideScrim:function(t){if(this.floating&&(this.scrim||this.modal&&this.scrimWhenModal)){var e=this.getScrim();if(t){var i=this.getScrimZIndex();this._scrimZ=i,e.showAtZIndex(i)}else e.hideAtZIndex(this._scrimZ);enyo.call(e,"addRemoveClass",[this.scrimClassName,e.showing])}},getScrimZIndex:function(){return onyx.Popup.highestZ>=this._zIndex?this._zIndex-1:onyx.Popup.highestZ},getScrim:function(){return this.modal&&this.scrimWhenModal&&!this.scrim?onyx.scrimTransparent.make():onyx.scrim.make()},applyZIndex:function(){this._zIndex=2*onyx.Popup.count+this.findZIndex()+1,this._zIndex<=onyx.Popup.highestZ&&(this._zIndex=onyx.Popup.highestZ+1),this._zIndex>onyx.Popup.highestZ&&(onyx.Popup.highestZ=this._zIndex),this.applyStyle("z-index",this._zIndex)},findZIndex:function(){var t=this.defaultZ;return this._zIndex?t=this._zIndex:this.hasNode()&&(t=Number(enyo.dom.getComputedStyleValue(this.node,"z-index"))||t),this.defaultZ>t&&(t=this.defaultZ),this._zIndex=t,this._zIndex}});

// TextArea.js
enyo.kind({name:"onyx.TextArea",kind:"enyo.TextArea",classes:"onyx-textarea"});

// RichText.js
enyo.kind({name:"onyx.RichText",kind:"enyo.RichText",classes:"onyx-richtext"});

// InputDecorator.js
enyo.kind({name:"onyx.InputDecorator",kind:"enyo.ToolDecorator",tag:"label",classes:"onyx-input-decorator",published:{alwaysLooksFocused:!1},handlers:{onDisabledChange:"disabledChange",onfocus:"receiveFocus",onblur:"receiveBlur"},create:function(){this.inherited(arguments),this.updateFocus(!1)},alwaysLooksFocusedChanged:function(){this.updateFocus(this.focus)},updateFocus:function(t){this.focused=t,this.addRemoveClass("onyx-focused",this.alwaysLooksFocused||this.focused)},receiveFocus:function(){this.updateFocus(!0)},receiveBlur:function(){this.updateFocus(!1)},disabledChange:function(t,e){this.addRemoveClass("onyx-disabled",e.originator.disabled)}});

// Tooltip.js
enyo.kind({name:"onyx.Tooltip",kind:"onyx.Popup",classes:"onyx-tooltip below left-arrow",autoDismiss:!1,showDelay:500,defaultLeft:-6,handlers:{onRequestShowTooltip:"requestShow",onRequestHideTooltip:"requestHide"},requestShow:function(){return this.showJob=setTimeout(this.bindSafely("show"),this.showDelay),!0},cancelShow:function(){clearTimeout(this.showJob)},requestHide:function(){return this.cancelShow(),this.inherited(arguments)},showingChanged:function(){this.cancelShow(),this.adjustPosition(!0),this.inherited(arguments)},applyPosition:function(t){var e="";for(var i in t)e+=i+":"+t[i]+(isNaN(t[i])?"; ":"px; ");this.addStyles(e)},adjustPosition:function(){if(this.showing&&this.hasNode()){var t=this.node.getBoundingClientRect();t.top+t.height>window.innerHeight?(this.addRemoveClass("below",!1),this.addRemoveClass("above",!0)):(this.addRemoveClass("above",!1),this.addRemoveClass("below",!0)),t.left+t.width>window.innerWidth&&(this.applyPosition({"margin-left":-t.width,bottom:"auto"}),this.addRemoveClass("left-arrow",!1),this.addRemoveClass("right-arrow",!0))}},resizeHandler:function(){this.applyPosition({"margin-left":this.defaultLeft,bottom:"auto"}),this.addRemoveClass("left-arrow",!0),this.addRemoveClass("right-arrow",!1),this.adjustPosition(!0),this.inherited(arguments)}});

// TooltipDecorator.js
enyo.kind({name:"onyx.TooltipDecorator",defaultKind:"onyx.Button",classes:"onyx-popup-decorator",handlers:{onenter:"enter",onleave:"leave"},enter:function(){this.requestShowTooltip()},leave:function(){this.requestHideTooltip()},tap:function(){this.requestHideTooltip()},requestShowTooltip:function(){this.waterfallDown("onRequestShowTooltip")},requestHideTooltip:function(){this.waterfallDown("onRequestHideTooltip")}});

// MenuDecorator.js
enyo.kind({name:"onyx.MenuDecorator",kind:"onyx.TooltipDecorator",defaultKind:"onyx.Button",classes:"onyx-popup-decorator enyo-unselectable",handlers:{onActivate:"activated",onHide:"menuHidden"},activated:function(t,e){this.requestHideTooltip(),e.originator.active&&(this.menuActive=!0,this.activator=e.originator,this.activator.addClass("active"),this.requestShowMenu())},requestShowMenu:function(){this.waterfallDown("onRequestShowMenu",{activator:this.activator})},requestHideMenu:function(){this.waterfallDown("onRequestHideMenu")},menuHidden:function(){this.menuActive=!1,this.activator&&(this.activator.setActive(!1),this.activator.removeClass("active"))},enter:function(){this.menuActive||this.inherited(arguments)},leave:function(){this.menuActive||this.inherited(arguments)}});

// Menu.js
enyo.kind({name:"onyx.Menu",kind:"onyx.Popup",modal:!0,defaultKind:"onyx.MenuItem",classes:"onyx-menu",published:{maxHeight:200,scrolling:!0},handlers:{onActivate:"itemActivated",onRequestShowMenu:"requestMenuShow",onRequestHideMenu:"requestHide"},childComponents:[{name:"client",kind:"enyo.Scroller",strategyKind:"TouchScrollStrategy"}],showOnTop:!1,scrollerName:"client",create:function(){this.inherited(arguments),this.maxHeightChanged()},initComponents:function(){this.scrolling&&this.createComponents(this.childComponents,{isChrome:!0}),this.inherited(arguments)},getScroller:function(){return this.$[this.scrollerName]},maxHeightChanged:function(){this.scrolling&&this.getScroller().setMaxHeight(this.maxHeight+"px")},itemActivated:function(t,e){return e.originator.setActive(!1),!0},showingChanged:function(){this.inherited(arguments),this.scrolling&&this.getScroller().setShowing(this.showing),this.adjustPosition(!0)},requestMenuShow:function(t,e){if(this.floating){var i=e.activator.hasNode();if(i){var n=this.activatorOffset=this.getPageOffset(i);this.applyPosition({top:n.top+(this.showOnTop?0:n.height),left:n.left,width:n.width})}}return this.show(),!0},applyPosition:function(t){var e="";for(var i in t)e+=i+":"+t[i]+(isNaN(t[i])?"; ":"px; ");this.addStyles(e)},getPageOffset:function(t){var e=t.getBoundingClientRect(),i=void 0===window.pageYOffset?document.documentElement.scrollTop:window.pageYOffset,n=void 0===window.pageXOffset?document.documentElement.scrollLeft:window.pageXOffset,o=void 0===e.height?e.bottom-e.top:e.height,s=void 0===e.width?e.right-e.left:e.width;return{top:e.top+i,left:e.left+n,height:o,width:s}},adjustPosition:function(){if(this.showing&&this.hasNode()){this.scrolling&&!this.showOnTop&&this.getScroller().setMaxHeight(this.maxHeight+"px"),this.removeClass("onyx-menu-up"),this.floating||this.applyPosition({left:"auto"});var t=this.node.getBoundingClientRect(),e=void 0===t.height?t.bottom-t.top:t.height,i=void 0===window.innerHeight?document.documentElement.clientHeight:window.innerHeight,n=void 0===window.innerWidth?document.documentElement.clientWidth:window.innerWidth;if(this.menuUp=t.top+e>i&&i-t.bottom<t.top-e,this.addRemoveClass("onyx-menu-up",this.menuUp),this.floating){var o=this.activatorOffset;this.menuUp?this.applyPosition({top:o.top-e+(this.showOnTop?o.height:0),bottom:"auto"}):t.top<o.top&&i>o.top+(this.showOnTop?0:o.height)+e&&this.applyPosition({top:o.top+(this.showOnTop?0:o.height),bottom:"auto"})}if(t.right>n&&(this.floating?this.applyPosition({left:n-t.width}):this.applyPosition({left:-(t.right-n)})),0>t.left&&(this.floating?this.applyPosition({left:0,right:"auto"}):"auto"==this.getComputedStyleValue("right")?this.applyPosition({left:-t.left}):this.applyPosition({right:t.left})),this.scrolling&&!this.showOnTop){t=this.node.getBoundingClientRect();var s;s=this.menuUp?this.maxHeight<t.bottom?this.maxHeight:t.bottom:i>t.top+this.maxHeight?this.maxHeight:i-t.top,this.getScroller().setMaxHeight(s+"px")}}},resizeHandler:function(){this.inherited(arguments),this.adjustPosition()},requestHide:function(){this.setShowing(!1)}});

// MenuItem.js
enyo.kind({name:"onyx.MenuItem",kind:"enyo.Button",events:{onSelect:"",onItemContentChange:""},classes:"onyx-menu-item",tag:"div",create:function(){this.silence(),this.inherited(arguments),this.unsilence(),this.active&&this.bubble("onActivate")},tap:function(){this.inherited(arguments),this.bubble("onRequestHideMenu"),this.doSelect({selected:this,content:this.content})},contentChanged:function(){this.inherited(arguments),this.doItemContentChange({content:this.content})}});

// Submenu.js
enyo.kind({name:"onyx.Submenu",defaultKind:"onyx.MenuItem",initComponents:function(){this.createChrome([{name:"label",kind:"enyo.Control",classes:"onyx-menu-item",content:this.content||this.name,isChrome:!0,ontap:"toggleOpen"},{kind:"onyx.Drawer",name:"client",classes:"client onyx-submenu",isChrome:!0,open:!1}]),this.inherited(arguments)},toggleOpen:function(){this.setOpen(!this.getOpen())},setOpen:function(t){this.$.client.setOpen(t)},getOpen:function(){return this.$.client.getOpen()}});

// PickerDecorator.js
enyo.kind({name:"onyx.PickerDecorator",kind:"onyx.MenuDecorator",classes:"onyx-picker-decorator",defaultKind:"onyx.PickerButton",handlers:{onChange:"change"},change:function(t,e){this.waterfallDown("onChange",e)}});

// PickerButton.js
enyo.kind({name:"onyx.PickerButton",kind:"onyx.Button",handlers:{onChange:"change"},change:function(t,e){void 0!==e.content&&this.setContent(e.content)}});

// Picker.js
enyo.kind({name:"onyx.Picker",kind:"onyx.Menu",classes:"onyx-picker enyo-unselectable",published:{selected:null},events:{onChange:""},handlers:{onItemContentChange:"itemContentChange"},floating:!0,showOnTop:!0,initComponents:function(){this.setScrolling(!0),this.inherited(arguments)},showingChanged:function(){this.getScroller().setShowing(this.showing),this.inherited(arguments),this.showing&&this.selected&&this.scrollToSelected()},scrollToSelected:function(){this.getScroller().scrollToControl(this.selected,!this.menuUp)},itemActivated:function(t,e){return this.processActivatedItem(e.originator),this.inherited(arguments)},processActivatedItem:function(t){t.active&&this.setSelected(t)},selectedChanged:function(t){t&&t.removeClass("selected"),this.selected&&(this.selected.addClass("selected"),this.doChange({selected:this.selected,content:this.selected.content}))},itemContentChange:function(t,e){e.originator==this.selected&&this.doChange({selected:this.selected,content:this.selected.content})},resizeHandler:function(){this.inherited(arguments),this.adjustPosition()}});

// FlyweightPicker.js
enyo.kind({name:"onyx.FlyweightPicker",kind:"onyx.Picker",classes:"onyx-flyweight-picker",published:{count:0},events:{onSetupItem:"",onSelect:""},handlers:{onSelect:"itemSelect"},components:[{name:"scroller",kind:"enyo.Scroller",strategyKind:"TouchScrollStrategy",components:[{name:"flyweight",kind:"FlyweightRepeater",noSelect:!0,ontap:"itemTap"}]}],scrollerName:"scroller",initComponents:function(){this.controlParentName="flyweight",this.inherited(arguments),this.$.flyweight.$.client.children[0].setActive(!0)},create:function(){this.inherited(arguments),this.countChanged()},rendered:function(){this.inherited(arguments),this.selectedChanged()},scrollToSelected:function(){var t=this.$.flyweight.fetchRowNode(this.selected);this.getScroller().scrollToNode(t,!this.menuUp)},countChanged:function(){this.$.flyweight.count=this.count},processActivatedItem:function(t){this.item=t},selectedChanged:function(t){if(this.item){null!=t&&(this.item.removeClass("selected"),this.$.flyweight.renderRow(t));var e;null!=this.selected&&(this.item.addClass("selected"),this.$.flyweight.renderRow(this.selected),this.item.removeClass("selected"),e=this.$.flyweight.fetchRowNode(this.selected)),this.doChange({selected:this.selected,content:e&&e.textContent||this.item.content})}},itemTap:function(t,e){this.setSelected(e.rowIndex),this.doSelect({selected:this.item,content:this.item.content})},itemSelect:function(t,e){return e.originator!=this?!0:void 0}});

// DatePicker.js
enyo.kind({name:"onyx.DatePicker",classes:"onyx-toolbar-inline",published:{disabled:!1,locale:"en_us",dayHidden:!1,monthHidden:!1,yearHidden:!1,minYear:1900,maxYear:2099,value:null},events:{onSelect:""},create:function(){this.inherited(arguments),enyo.g11n&&(this.locale=enyo.g11n.currentLocale().getLocale()),this.initDefaults()},initDefaults:function(){var t=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];enyo.g11n&&(this._tf=new enyo.g11n.Fmts({locale:this.locale}),t=this._tf.getMonthFields()),this.setupPickers(this._tf?this._tf.getDateFieldOrder():"mdy"),this.dayHiddenChanged(),this.monthHiddenChanged(),this.yearHiddenChanged();for(var e,i=this.value=this.value||new Date,n=0;e=t[n];n++)this.$.monthPicker.createComponent({content:e,value:n,active:n==i.getMonth()});var o=i.getFullYear();for(this.$.yearPicker.setSelected(o-this.minYear),n=1;this.monthLength(i.getYear(),i.getMonth())>=n;n++)this.$.dayPicker.createComponent({content:n,value:n,active:n==i.getDate()})},monthLength:function(t,e){return 32-new Date(t,e,32).getDate()},setupYear:function(t,e){return this.$.year.setContent(this.minYear+e.index),!0},setupPickers:function(t){var e,i,n,o=t.split("");for(i=0,n=o.length;n>i;i++)switch(e=o[i]){case"d":this.createDay();break;case"m":this.createMonth();break;case"y":this.createYear();break;default:}},createYear:function(){var t=this.maxYear-this.minYear;this.createComponent({kind:"onyx.PickerDecorator",onSelect:"updateYear",components:[{classes:"onyx-datepicker-year",name:"yearPickerButton",disabled:this.disabled},{name:"yearPicker",kind:"onyx.FlyweightPicker",count:++t,onSetupItem:"setupYear",components:[{name:"year"}]}]})},createMonth:function(){this.createComponent({kind:"onyx.PickerDecorator",onSelect:"updateMonth",components:[{classes:"onyx-datepicker-month",name:"monthPickerButton",disabled:this.disabled},{name:"monthPicker",kind:"onyx.Picker"}]})},createDay:function(){this.createComponent({kind:"onyx.PickerDecorator",onSelect:"updateDay",components:[{classes:"onyx-datepicker-day",name:"dayPickerButton",disabled:this.disabled},{name:"dayPicker",kind:"onyx.Picker"}]})},localeChanged:function(){this.refresh()},dayHiddenChanged:function(){this.$.dayPicker.getParent().setShowing(this.dayHidden?!1:!0)},monthHiddenChanged:function(){this.$.monthPicker.getParent().setShowing(this.monthHidden?!1:!0)},yearHiddenChanged:function(){this.$.yearPicker.getParent().setShowing(this.yearHidden?!1:!0)},minYearChanged:function(){this.refresh()},maxYearChanged:function(){this.refresh()},valueChanged:function(){this.refresh()},disabledChanged:function(){this.$.yearPickerButton.setDisabled(this.disabled),this.$.monthPickerButton.setDisabled(this.disabled),this.$.dayPickerButton.setDisabled(this.disabled)},updateDay:function(t,e){var i=this.calcDate(this.value.getFullYear(),this.value.getMonth(),e.selected.value);return this.doSelect({name:this.name,value:i}),this.setValue(i),!0},updateMonth:function(t,e){var i=this.calcDate(this.value.getFullYear(),e.selected.value,this.value.getDate());return this.doSelect({name:this.name,value:i}),this.setValue(i),!0},updateYear:function(t,e){if(-1!=e.originator.selected){var i=this.calcDate(this.minYear+e.originator.selected,this.value.getMonth(),this.value.getDate());this.doSelect({name:this.name,value:i}),this.setValue(i)}return!0},calcDate:function(t,e,i){return new Date(t,e,i,this.value.getHours(),this.value.getMinutes(),this.value.getSeconds(),this.value.getMilliseconds())},refresh:function(){this.destroyClientControls(),this.initDefaults(),this.render()}});

// TimePicker.js
enyo.kind({name:"onyx.TimePicker",classes:"onyx-toolbar-inline",published:{disabled:!1,locale:"en_us",is24HrMode:null,value:null},events:{onSelect:""},create:function(){this.inherited(arguments),enyo.g11n&&(this.locale=enyo.g11n.currentLocale().getLocale()),this.initDefaults()},initDefaults:function(){var t="AM",e="PM";null==this.is24HrMode&&(this.is24HrMode=!1),enyo.g11n&&(this._tf=new enyo.g11n.Fmts({locale:this.locale}),t=this._tf.getAmCaption(),e=this._tf.getPmCaption(),null==this.is24HrMode&&(this.is24HrMode=!this._tf.isAmPm())),this.setupPickers(this._tf?this._tf.getTimeFieldOrder():"hma");var i,n=this.value=this.value||new Date;if(this.is24HrMode)for(i=0;24>i;i++)this.$.hourPicker.createComponent({content:i,value:i,active:i==n.getHours()});else{var o=n.getHours();for(o=0===o?12:o,i=1;12>=i;i++)this.$.hourPicker.createComponent({content:i,value:i,active:i==(o>12?o%12:o)})}for(i=0;59>=i;i++)this.$.minutePicker.createComponent({content:10>i?"0"+i:i,value:i,active:i==n.getMinutes()});n.getHours()>=12?this.$.ampmPicker.createComponents([{content:t},{content:e,active:!0}]):this.$.ampmPicker.createComponents([{content:t,active:!0},{content:e}]),this.$.ampmPicker.getParent().setShowing(!this.is24HrMode)},setupPickers:function(t){var e,i,n,o=t.split("");for(i=0,n=o.length;n>i;i++)switch(e=o[i]){case"h":this.createHour();break;case"m":this.createMinute();break;case"a":this.createAmPm();break;default:}},createHour:function(){this.createComponent({kind:"onyx.PickerDecorator",onSelect:"updateHour",components:[{classes:"onyx-timepicker-hour",name:"hourPickerButton",disabled:this.disabled},{name:"hourPicker",kind:"onyx.Picker"}]})},createMinute:function(){this.createComponent({kind:"onyx.PickerDecorator",onSelect:"updateMinute",components:[{classes:"onyx-timepicker-minute",name:"minutePickerButton",disabled:this.disabled},{name:"minutePicker",kind:"onyx.Picker"}]})},createAmPm:function(){this.createComponent({kind:"onyx.PickerDecorator",onSelect:"updateAmPm",components:[{classes:"onyx-timepicker-ampm",name:"ampmPickerButton",disabled:this.disabled},{name:"ampmPicker",kind:"onyx.Picker"}]})},disabledChanged:function(){this.$.hourPickerButton.setDisabled(this.disabled),this.$.minutePickerButton.setDisabled(this.disabled),this.$.ampmPickerButton.setDisabled(this.disabled)},localeChanged:function(){this.is24HrMode=null,this.refresh()},is24HrModeChanged:function(){this.refresh()},valueChanged:function(){this.refresh()},updateHour:function(t,e){var i=e.selected.value;if(!this.is24HrMode){var n=this.$.ampmPicker.getParent().controlAtIndex(0).content;i=i+(12==i?-12:0)+(this.isAm(n)?0:12)}return this.value=this.calcTime(i,this.value.getMinutes()),this.doSelect({name:this.name,value:this.value}),!0},updateMinute:function(t,e){return this.value=this.calcTime(this.value.getHours(),e.selected.value),this.doSelect({name:this.name,value:this.value}),!0},updateAmPm:function(t,e){var i=this.value.getHours();return this.is24HrMode||(i+=i>11?this.isAm(e.content)?-12:0:this.isAm(e.content)?0:12),this.value=this.calcTime(i,this.value.getMinutes()),this.doSelect({name:this.name,value:this.value}),!0},calcTime:function(t,e){return new Date(this.value.getFullYear(),this.value.getMonth(),this.value.getDate(),t,e,this.value.getSeconds(),this.value.getMilliseconds())},isAm:function(t){var e,i;try{e=this._tf.getAmCaption(),i=this._tf.getPmCaption()}catch(n){e="AM",i="PM"}return t==e?!0:!1},refresh:function(){this.destroyClientControls(),this.initDefaults(),this.render()}});

// RadioButton.js
enyo.kind({name:"onyx.RadioButton",kind:"Button",classes:"onyx-radiobutton"});

// RadioGroup.js
enyo.kind({name:"onyx.RadioGroup",kind:"Group",defaultKind:"onyx.RadioButton",highlander:!0});

// ToggleButton.js
enyo.kind({name:"onyx.ToggleButton",classes:"onyx-toggle-button",published:{active:!1,value:!1,onContent:"On",offContent:"Off",disabled:!1},events:{onChange:""},handlers:{ondragstart:"dragstart",ondrag:"drag",ondragfinish:"dragfinish"},components:[{name:"contentOn",classes:"onyx-toggle-content on"},{name:"contentOff",classes:"onyx-toggle-content off"},{classes:"onyx-toggle-button-knob"}],create:function(){this.inherited(arguments),this.value=Boolean(this.value||this.active),this.onContentChanged(),this.offContentChanged(),this.disabledChanged()},rendered:function(){this.inherited(arguments),this.updateVisualState()},updateVisualState:function(){this.addRemoveClass("off",!this.value),this.$.contentOn.setShowing(this.value),this.$.contentOff.setShowing(!this.value),this.setActive(this.value)},valueChanged:function(){this.updateVisualState(),this.doChange({value:this.value})},activeChanged:function(){this.setValue(this.active),this.bubble("onActivate")},onContentChanged:function(){this.$.contentOn.setContent(this.onContent||""),this.$.contentOn.addRemoveClass("empty",!this.onContent)},offContentChanged:function(){this.$.contentOff.setContent(this.offContent||""),this.$.contentOff.addRemoveClass("empty",!this.onContent)},disabledChanged:function(){this.addRemoveClass("disabled",this.disabled)},updateValue:function(t){this.disabled||this.setValue(t)},tap:function(){this.updateValue(!this.value)},dragstart:function(t,e){return e.horizontal?(e.preventDefault(),this.dragging=!0,this.dragged=!1,!0):void 0},drag:function(t,e){if(this.dragging){var i=e.dx;return Math.abs(i)>10&&(this.updateValue(i>0),this.dragged=!0),!0}},dragfinish:function(t,e){this.dragging=!1,this.dragged&&e.preventTap()}});

// ToggleIconButton.js
enyo.kind({name:"onyx.ToggleIconButton",kind:"onyx.Icon",published:{active:!1,value:!1},events:{onChange:""},classes:"onyx-icon-button onyx-icon-toggle",activeChanged:function(){this.addRemoveClass("active",this.value),this.bubble("onActivate")},updateValue:function(t){this.disabled||(this.setValue(t),this.doChange({value:this.value}))},tap:function(){this.updateValue(!this.value)},valueChanged:function(){this.setActive(this.value)},create:function(){this.inherited(arguments),this.value=Boolean(this.value||this.active)},rendered:function(){this.inherited(arguments),this.valueChanged(),this.removeClass("onyx-icon")}});

// Toolbar.js
enyo.kind({name:"onyx.Toolbar",classes:"onyx onyx-toolbar onyx-toolbar-inline",create:function(){this.inherited(arguments),this.hasClass("onyx-menu-toolbar")&&enyo.platform.android>=4&&this.applyStyle("position","static")}});

// ProgressBar.js
enyo.kind({name:"onyx.ProgressBar",classes:"onyx-progress-bar",published:{progress:0,min:0,max:100,barClasses:"",showStripes:!0,animateStripes:!0,increment:0},events:{onAnimateProgressFinish:""},components:[{name:"progressAnimator",kind:"Animator",onStep:"progressAnimatorStep",onEnd:"progressAnimatorComplete"},{name:"bar",classes:"onyx-progress-bar-bar"}],create:function(){this.inherited(arguments),this.progressChanged(),this.barClassesChanged(),this.showStripesChanged(),this.animateStripesChanged()},barClassesChanged:function(t){this.$.bar.removeClass(t),this.$.bar.addClass(this.barClasses)},showStripesChanged:function(){this.$.bar.addRemoveClass("striped",this.showStripes)},animateStripesChanged:function(){this.$.bar.addRemoveClass("animated",this.animateStripes)},progressChanged:function(){this.progress=this.clampValue(this.min,this.max,this.progress);var t=this.calcPercent(this.progress);this.updateBarPosition(t)},calcIncrement:function(t){return Math.round(t/this.increment)*this.increment},clampValue:function(t,e,i){return Math.max(t,Math.min(i,e))},calcRatio:function(t){return(t-this.min)/(this.max-this.min)},calcPercent:function(t){return 100*this.calcRatio(t)},updateBarPosition:function(t){this.$.bar.applyStyle("width",t+"%")},animateProgressTo:function(t){this.$.progressAnimator.play({startValue:this.progress,endValue:t,node:this.hasNode()})},progressAnimatorStep:function(t){return this.setProgress(t.value),!0},progressAnimatorComplete:function(t){return this.doAnimateProgressFinish(t),!0}});

// ProgressButton.js
enyo.kind({name:"onyx.ProgressButton",kind:"onyx.ProgressBar",classes:"onyx-progress-button",events:{onCancel:""},components:[{name:"progressAnimator",kind:"Animator",onStep:"progressAnimatorStep",onEnd:"progressAnimatorComplete"},{name:"bar",classes:"onyx-progress-bar-bar onyx-progress-button-bar"},{name:"client",classes:"onyx-progress-button-client"},{kind:"onyx.Icon",src:"$lib/onyx/images/progress-button-cancel.png",classes:"onyx-progress-button-icon",ontap:"cancelTap"}],cancelTap:function(){this.doCancel()}});

// Scrim.js
enyo.kind({name:"onyx.Scrim",showing:!1,classes:"onyx-scrim enyo-fit",floating:!1,create:function(){this.inherited(arguments),this.zStack=[],this.floating&&this.setParent(enyo.floatingLayer)},showingChanged:function(){this.floating&&this.showing&&!this.hasNode()&&this.render(),this.inherited(arguments)},addZIndex:function(t){0>enyo.indexOf(t,this.zStack)&&this.zStack.push(t)},removeZIndex:function(t){enyo.remove(t,this.zStack)},showAtZIndex:function(t){this.addZIndex(t),void 0!==t&&this.setZIndex(t),this.show()},hideAtZIndex:function(t){if(this.removeZIndex(t),this.zStack.length){var e=this.zStack[this.zStack.length-1];this.setZIndex(e)}else this.hide()},setZIndex:function(t){this.zIndex=t,this.applyStyle("z-index",t)},make:function(){return this}}),enyo.kind({name:"onyx.scrimSingleton",kind:null,constructor:function(t,e){this.instanceName=t,enyo.setPath(this.instanceName,this),this.props=e||{}},make:function(){var t=new onyx.Scrim(this.props);return enyo.setPath(this.instanceName,t),t},showAtZIndex:function(t){var e=this.make();e.showAtZIndex(t)},hideAtZIndex:enyo.nop,show:function(){var t=this.make();t.show()}}),new onyx.scrimSingleton("onyx.scrim",{floating:!0,classes:"onyx-scrim-translucent"}),new onyx.scrimSingleton("onyx.scrimTransparent",{floating:!0,classes:"onyx-scrim-transparent"});

// Slider.js
enyo.kind({name:"onyx.Slider",kind:"onyx.ProgressBar",classes:"onyx-slider",published:{value:0,lockBar:!0,tappable:!0},events:{onChange:"",onChanging:"",onAnimateFinish:""},showStripes:!1,handlers:{ondragstart:"dragstart",ondrag:"drag",ondragfinish:"dragfinish"},moreComponents:[{kind:"Animator",onStep:"animatorStep",onEnd:"animatorComplete"},{classes:"onyx-slider-taparea"},{name:"knob",classes:"onyx-slider-knob"}],create:function(){this.inherited(arguments),enyo.platform.firefoxOS&&(this.moreComponents[2].ondown="fxosDown",this.moreComponents[2].onenter="fxosEnter",this.moreComponents[2].ondrag="fxosDrag",this.moreComponents[2].onleave="fxosLeave",this.moreComponents[2].onup="fxosUp"),this.createComponents(this.moreComponents),this.valueChanged()},valueChanged:function(){this.value=this.clampValue(this.min,this.max,this.value);var t=this.calcPercent(this.value);this.updateKnobPosition(t),this.lockBar&&this.setProgress(this.value)},updateKnobPosition:function(t){this.$.knob.applyStyle("left",t+"%")},calcKnobPosition:function(t){var e=t.clientX-this.hasNode().getBoundingClientRect().left;return e/this.getBounds().width*(this.max-this.min)+this.min},dragstart:function(t,e){return e.horizontal?(e.preventDefault(),this.dragging=!0,!0):void 0},drag:function(t,e){if(this.dragging){var i=this.calcKnobPosition(e);return i=this.increment?this.calcIncrement(i):i,this.setValue(i),this.doChanging({value:this.value}),!0}},dragfinish:function(t,e){return this.dragging=!1,e.preventTap(),this.doChange({value:this.value}),!0},tap:function(t,e){if(this.tappable){var i=this.calcKnobPosition(e);return i=this.increment?this.calcIncrement(i):i,this.tapped=!0,this.animateTo(i),!0}},fxosDown:function(){this.$.knob.addClass("pressed"),this._isInControl=!0},fxosEnter:function(){this._isInControl=!0},fxosDrag:function(){this.$.knob.addRemoveClass("pressed",this._isInControl)},fxosLeave:function(){this.$.knob.removeClass("pressed"),this._isInControl=!1},fxosUp:function(){this.$.knob.removeClass("pressed"),this._isInControl=!1},animateTo:function(t){this.$.animator.play({startValue:this.value,endValue:t,node:this.hasNode()})},animatorStep:function(t){return this.setValue(t.value),!0},animatorComplete:function(t){return this.tapped&&(this.tapped=!1,this.doChange({value:this.value})),this.doAnimateFinish(t),!0}});

// RangeSlider.js
enyo.kind({name:"onyx.RangeSlider",kind:"onyx.ProgressBar",classes:"onyx-slider",published:{rangeMin:0,rangeMax:100,rangeStart:0,rangeEnd:100,beginValue:0,endValue:0},events:{onChange:"",onChanging:""},showStripes:!1,showLabels:!1,handlers:{ondragstart:"dragstart",ondrag:"drag",ondragfinish:"dragfinish",ondown:"down"},moreComponents:[{name:"startKnob",classes:"onyx-slider-knob"},{name:"endKnob",classes:"onyx-slider-knob onyx-range-slider-knob"}],create:function(){this.inherited(arguments),this.createComponents(this.moreComponents),this.initControls()},rendered:function(){this.inherited(arguments);var t=this.calcPercent(this.beginValue);this.updateBarPosition(t)},initControls:function(){this.$.bar.applyStyle("position","relative"),this.refreshRangeSlider(),this.showLabels&&(this.$.startKnob.createComponent({name:"startLabel",kind:"onyx.RangeSliderKnobLabel"}),this.$.endKnob.createComponent({name:"endLabel",kind:"onyx.RangeSliderKnobLabel"}))},refreshRangeSlider:function(){this.beginValue=this.calcKnobPercent(this.rangeStart),this.endValue=this.calcKnobPercent(this.rangeEnd),this.beginValueChanged(),this.endValueChanged()},calcKnobRatio:function(t){return(t-this.rangeMin)/(this.rangeMax-this.rangeMin)},calcKnobPercent:function(t){return 100*this.calcKnobRatio(t)},beginValueChanged:function(t){if(void 0===t){var e=this.calcPercent(this.beginValue);this.updateKnobPosition(e,this.$.startKnob)}},endValueChanged:function(t){if(void 0===t){var e=this.calcPercent(this.endValue);this.updateKnobPosition(e,this.$.endKnob)}},calcKnobPosition:function(t){var e=t.clientX-this.hasNode().getBoundingClientRect().left;return e/this.getBounds().width*(this.max-this.min)+this.min},updateKnobPosition:function(t,e){e.applyStyle("left",t+"%"),this.updateBarPosition()},updateBarPosition:function(){if(void 0!==this.$.startKnob&&void 0!==this.$.endKnob){var t=this.calcKnobPercent(this.rangeStart),e=this.calcKnobPercent(this.rangeEnd)-t;this.$.bar.applyStyle("left",t+"%"),this.$.bar.applyStyle("width",e+"%")}},calcRangeRatio:function(t){return t/100*(this.rangeMax-this.rangeMin)+this.rangeMin-this.increment/2},swapZIndex:function(t){"startKnob"===t?(this.$.startKnob.applyStyle("z-index",1),this.$.endKnob.applyStyle("z-index",0)):"endKnob"===t&&(this.$.startKnob.applyStyle("z-index",0),this.$.endKnob.applyStyle("z-index",1))},down:function(t){this.swapZIndex(t.name)},dragstart:function(t,e){return e.horizontal?(e.preventDefault(),this.dragging=!0,!0):void 0},drag:function(t,e){if(this.dragging){var i,n,o,s=this.calcKnobPosition(e);if("startKnob"===t.name&&s>=0){if(!(this.endValue>=s&&-1===e.xDirection||this.endValue>=s))return this.drag(this.$.endKnob,e);this.setBeginValue(s),i=this.calcRangeRatio(this.beginValue),n=this.increment?this.calcIncrement(i+.5*this.increment):i,o=this.calcKnobPercent(n),this.updateKnobPosition(o,this.$.startKnob),this.setRangeStart(n),this.doChanging({value:n})}else if("endKnob"===t.name&&100>=s){if(!(s>=this.beginValue&&1===e.xDirection||s>=this.beginValue))return this.drag(this.$.startKnob,e);this.setEndValue(s),i=this.calcRangeRatio(this.endValue),n=this.increment?this.calcIncrement(i+.5*this.increment):i,o=this.calcKnobPercent(n),this.updateKnobPosition(o,this.$.endKnob),this.setRangeEnd(n),this.doChanging({value:n})}return!0}},dragfinish:function(t,e){this.dragging=!1,e.preventTap();var i;return"startKnob"===t.name?(i=this.calcRangeRatio(this.beginValue),this.doChange({value:i,startChanged:!0})):"endKnob"===t.name&&(i=this.calcRangeRatio(this.endValue),this.doChange({value:i,startChanged:!1})),!0},rangeMinChanged:function(){this.refreshRangeSlider()},rangeMaxChanged:function(){this.refreshRangeSlider()},rangeStartChanged:function(){this.refreshRangeSlider()},rangeEndChanged:function(){this.refreshRangeSlider()},setStartLabel:function(t){this.$.startKnob.waterfallDown("onSetLabel",t)},setEndLabel:function(t){this.$.endKnob.waterfallDown("onSetLabel",t)}}),enyo.kind({name:"onyx.RangeSliderKnobLabel",classes:"onyx-range-slider-label",handlers:{onSetLabel:"setLabel"},setLabel:function(t,e){this.setContent(e)}});

// Item.js
enyo.kind({name:"onyx.Item",classes:"onyx-item",tapHighlight:!0,handlers:{onhold:"hold",onrelease:"release"},hold:function(t,e){this.tapHighlight&&onyx.Item.addRemoveFlyweightClass(this.controlParent||this,"onyx-highlight",!0,e)},release:function(t,e){this.tapHighlight&&onyx.Item.addRemoveFlyweightClass(this.controlParent||this,"onyx-highlight",!1,e)},statics:{addRemoveFlyweightClass:function(t,e,i,n,o){var s=n.flyweight;if(s){var a=void 0!==o?o:n.index;s.performOnRow(a,function(){t.addRemoveClass(e,i)})}}}});

// Spinner.js
enyo.kind({name:"onyx.Spinner",classes:"onyx-spinner",stop:function(){this.setShowing(!1)},start:function(){this.setShowing(!0)},toggle:function(){this.setShowing(!this.getShowing())}});

// MoreToolbar.js
enyo.kind({name:"onyx.MoreToolbar",classes:"onyx-toolbar onyx-more-toolbar",menuClass:"",movedClass:"",layoutKind:"FittableColumnsLayout",noStretch:!0,handlers:{onHide:"reflow"},published:{clientLayoutKind:"FittableColumnsLayout"},tools:[{name:"client",noStretch:!0,fit:!0,classes:"onyx-toolbar-inline"},{name:"nard",kind:"onyx.MenuDecorator",showing:!1,onActivate:"activated",components:[{kind:"onyx.IconButton",classes:"onyx-more-button"},{name:"menu",kind:"onyx.Menu",scrolling:!1,classes:"onyx-more-menu"}]}],initComponents:function(){this.menuClass&&this.menuClass.length>0&&!this.$.menu.hasClass(this.menuClass)&&this.$.menu.addClass(this.menuClass),this.createChrome(this.tools),this.inherited(arguments),this.$.client.setLayoutKind(this.clientLayoutKind)},clientLayoutKindChanged:function(){this.$.client.setLayoutKind(this.clientLayoutKind)},reflow:function(){this.inherited(arguments),this.isContentOverflowing()?(this.$.nard.show(),this.popItem()&&this.reflow()):this.tryPushItem()?this.reflow():this.$.menu.children.length||(this.$.nard.hide(),this.$.menu.hide())},activated:function(t,e){this.addRemoveClass("active",e.originator.active)},popItem:function(){var t=this.findCollapsibleItem();if(t){this.movedClass&&this.movedClass.length>0&&!t.hasClass(this.movedClass)&&t.addClass(this.movedClass),this.$.menu.addChild(t,null);var e=this.$.menu.hasNode();return e&&t.hasNode()&&t.insertNodeInParent(e),!0}},pushItem:function(){var t=this.$.menu.children,e=t[0];if(e){this.movedClass&&this.movedClass.length>0&&e.hasClass(this.movedClass)&&e.removeClass(this.movedClass),this.$.client.addChild(e);var i=this.$.client.hasNode();if(i&&e.hasNode()){for(var n,o,s=0;this.$.client.children.length>s;s++){var a=this.$.client.children[s];if(void 0!==a.toolbarIndex&&a.toolbarIndex!=s){n=a,o=s;break}}if(n&&n.hasNode()){e.insertNodeInParent(i,n.node);var r=this.$.client.children.pop();this.$.client.children.splice(o,0,r)}else e.appendNodeToParent(i)}return!0}},tryPushItem:function(){if(this.pushItem()){if(!this.isContentOverflowing())return!0;this.popItem()}},isContentOverflowing:function(){if(this.$.client.hasNode()){var t=this.$.client.children,e=t.length&&t[t.length-1].hasNode();if(e)return this.$.client.reflow(),e.offsetLeft+e.offsetWidth>this.$.client.node.clientWidth}},findCollapsibleItem:function(){for(var t,e=this.$.client.children,i=e.length-1;t=e[i];i--){if(!t.unmoveable)return t;void 0===t.toolbarIndex&&(t.toolbarIndex=i)}}});

// IntegerPicker.js
enyo.kind({name:"onyx.IntegerPicker",kind:"onyx.Picker",published:{value:0,min:0,max:9},create:function(){this.inherited(arguments),this.rangeChanged()},minChanged:function(){this.destroyClientControls(),this.rangeChanged(),this.render()},maxChanged:function(){this.destroyClientControls(),this.rangeChanged(),this.render()},rangeChanged:function(){for(var t=this.min;this.max>=t;t++)this.createComponent({content:t,active:t===this.value?!0:!1})},valueChanged:function(){var t=this.getClientControls(),e=t.length;this.value=Math.min(this.max,Math.max(this.value,this.min));for(var i=0;e>i;i++)if(this.value===parseInt(t[i].content,10)){this.setSelected(t[i]);break}},selectedChanged:function(t){t&&t.removeClass("selected"),this.selected&&(this.selected.addClass("selected"),this.doChange({selected:this.selected,content:this.selected.content})),this.value=parseInt(this.selected.content,10)}});

// ContextualPopup.js
enyo.kind({name:"onyx.ContextualPopup",kind:"enyo.Popup",modal:!0,autoDismiss:!0,floating:!1,classes:"onyx-contextual-popup enyo-unselectable",published:{maxHeight:100,scrolling:!0,title:void 0,actionButtons:[]},vertFlushMargin:60,horizFlushMargin:50,widePopup:200,longPopup:200,horizBuffer:16,events:{onTap:""},handlers:{onRequestShowMenu:"requestShow",onRequestHideMenu:"requestHide"},components:[{name:"title",classes:"onyx-contextual-popup-title"},{classes:"onyx-contextual-popup-scroller",components:[{name:"client",kind:"enyo.Scroller",vertical:"auto",classes:"enyo-unselectable",thumb:!1,strategyKind:"TouchScrollStrategy"}]},{name:"actionButtons",classes:"onyx-contextual-popup-action-buttons"}],scrollerName:"client",create:function(){this.inherited(arguments),this.maxHeightChanged(),this.titleChanged(),this.actionButtonsChanged()},getScroller:function(){return this.$[this.scrollerName]},titleChanged:function(){this.$.title.setContent(this.title)},actionButtonsChanged:function(){for(var t=0;this.actionButtons.length>t;t++)this.$.actionButtons.createComponent({kind:"onyx.Button",content:this.actionButtons[t].content,classes:this.actionButtons[t].classes+" onyx-contextual-popup-action-button",name:this.actionButtons[t].name?this.actionButtons[t].name:"ActionButton"+t,index:t,tap:this.actionButtons[t].ontap?this.owner.bindSafely(this.actionButtons[t].ontap):this.bindSafely(this.tapHandler)})},tapHandler:function(t,e){return e.actionButton=!0,e.popup=this,this.bubble("ontap",e),!0},maxHeightChanged:function(){this.scrolling&&this.getScroller().setMaxHeight(this.maxHeight+"px")},showingChanged:function(){this.inherited(arguments),this.scrolling&&this.getScroller().setShowing(this.showing),this.adjustPosition()},requestShow:function(t,e){var i=e.activator.hasNode();return i&&(this.activatorOffset=this.getPageOffset(i)),this.show(),!0},applyPosition:function(t){var e="";for(var i in t)e+=i+":"+t[i]+(isNaN(t[i])?"; ":"px; ");this.addStyles(e)},getPageOffset:function(t){var e=this.getBoundingRect(t),i=void 0===window.pageYOffset?document.documentElement.scrollTop:window.pageYOffset,n=void 0===window.pageXOffset?document.documentElement.scrollLeft:window.pageXOffset,o=void 0===e.height?e.bottom-e.top:e.height,s=void 0===e.width?e.right-e.left:e.width;return{top:e.top+i,left:e.left+n,height:o,width:s}},adjustPosition:function(){if(this.showing&&this.hasNode()){this.resetPositioning();var t=this.getViewWidth(),e=this.getViewHeight(),i=this.vertFlushMargin,n=e-this.vertFlushMargin,o=this.horizFlushMargin,s=t-this.horizFlushMargin;if(i>this.activatorOffset.top+this.activatorOffset.height||this.activatorOffset.top>n){if(this.applyVerticalFlushPositioning(o,s))return;if(this.applyHorizontalFlushPositioning(o,s))return;if(this.applyVerticalPositioning())return}else if((o>this.activatorOffset.left+this.activatorOffset.width||this.activatorOffset.left>s)&&this.applyHorizontalPositioning())return;var a=this.getBoundingRect(this.node);if(a.width>this.widePopup){if(this.applyVerticalPositioning())return}else if(a.height>this.longPopup&&this.applyHorizontalPositioning())return;if(this.applyVerticalPositioning())return;if(this.applyHorizontalPositioning())return}},initVerticalPositioning:function(){this.resetPositioning(),this.addClass("vertical");var t=this.getBoundingRect(this.node),e=this.getViewHeight();return this.floating?e/2>this.activatorOffset.top?(this.applyPosition({top:this.activatorOffset.top+this.activatorOffset.height,bottom:"auto"}),this.addClass("below")):(this.applyPosition({top:this.activatorOffset.top-t.height,bottom:"auto"}),this.addClass("above")):t.top+t.height>e&&e-t.bottom<t.top-t.height?this.addClass("above"):this.addClass("below"),t=this.getBoundingRect(this.node),t.top+t.height>e||0>t.top?!1:!0},applyVerticalPositioning:function(){if(!this.initVerticalPositioning())return!1;var t=this.getBoundingRect(this.node),e=this.getViewWidth();if(this.floating){var i=this.activatorOffset.left+this.activatorOffset.width/2-t.width/2;i+t.width>e?(this.applyPosition({left:this.activatorOffset.left+this.activatorOffset.width-t.width}),this.addClass("left")):0>i?(this.applyPosition({left:this.activatorOffset.left}),this.addClass("right")):this.applyPosition({left:i})}else{var n=this.activatorOffset.left+this.activatorOffset.width/2-t.left-t.width/2;t.right+n>e?(this.applyPosition({left:this.activatorOffset.left+this.activatorOffset.width-t.right}),this.addRemoveClass("left",!0)):0>t.left+n?this.addRemoveClass("right",!0):this.applyPosition({left:n})}return!0},applyVerticalFlushPositioning:function(t,e){if(!this.initVerticalPositioning())return!1;var i=this.getBoundingRect(this.node),n=this.getViewWidth();return t>this.activatorOffset.left+this.activatorOffset.width/2?(this.activatorOffset.left+this.activatorOffset.width/2<this.horizBuffer?this.applyPosition({left:this.horizBuffer+(this.floating?0:-i.left)}):this.applyPosition({left:this.activatorOffset.width/2+(this.floating?this.activatorOffset.left:0)}),this.addClass("right"),this.addClass("corner"),!0):this.activatorOffset.left+this.activatorOffset.width/2>e?(this.activatorOffset.left+this.activatorOffset.width/2>n-this.horizBuffer?this.applyPosition({left:n-this.horizBuffer-i.right}):this.applyPosition({left:this.activatorOffset.left+this.activatorOffset.width/2-i.right}),this.addClass("left"),this.addClass("corner"),!0):!1},initHorizontalPositioning:function(){this.resetPositioning();var t=this.getBoundingRect(this.node),e=this.getViewWidth();return this.floating?e/2>this.activatorOffset.left+this.activatorOffset.width?(this.applyPosition({left:this.activatorOffset.left+this.activatorOffset.width}),this.addRemoveClass("left",!0)):(this.applyPosition({left:this.activatorOffset.left-t.width}),this.addRemoveClass("right",!0)):this.activatorOffset.left-t.width>0?(this.applyPosition({left:this.activatorOffset.left-t.left-t.width}),this.addRemoveClass("right",!0)):(this.applyPosition({left:this.activatorOffset.width}),this.addRemoveClass("left",!0)),this.addRemoveClass("horizontal",!0),t=this.getBoundingRect(this.node),0>t.left||t.left+t.width>e?!1:!0},applyHorizontalPositioning:function(){if(!this.initHorizontalPositioning())return!1;var t=this.getBoundingRect(this.node),e=this.getViewHeight(),i=this.activatorOffset.top+this.activatorOffset.height/2;return this.floating?i>=e/2-.05*e&&e/2+.05*e>=i?this.applyPosition({top:this.activatorOffset.top+this.activatorOffset.height/2-t.height/2,bottom:"auto"}):e/2>this.activatorOffset.top+this.activatorOffset.height?(this.applyPosition({top:this.activatorOffset.top-this.activatorOffset.height,bottom:"auto"}),this.addRemoveClass("high",!0)):(this.applyPosition({top:this.activatorOffset.top-t.height+2*this.activatorOffset.height,bottom:"auto"}),this.addRemoveClass("low",!0)):i>=e/2-.05*e&&e/2+.05*e>=i?this.applyPosition({top:(this.activatorOffset.height-t.height)/2}):e/2>this.activatorOffset.top+this.activatorOffset.height?(this.applyPosition({top:-this.activatorOffset.height}),this.addRemoveClass("high",!0)):(this.applyPosition({top:t.top-t.height-this.activatorOffset.top+this.activatorOffset.height}),this.addRemoveClass("low",!0)),!0},applyHorizontalFlushPositioning:function(t,e){if(!this.initHorizontalPositioning())return!1;var i=this.getBoundingRect(this.node),n=this.getViewHeight();return this.floating?n/2>this.activatorOffset.top?(this.applyPosition({top:this.activatorOffset.top+this.activatorOffset.height/2}),this.addRemoveClass("high",!0)):(this.applyPosition({top:this.activatorOffset.top+this.activatorOffset.height/2-i.height}),this.addRemoveClass("low",!0)):i.top+i.height>n&&n-i.bottom<i.top-i.height?(this.applyPosition({top:i.top-i.height-this.activatorOffset.top-this.activatorOffset.height/2}),this.addRemoveClass("low",!0)):(this.applyPosition({top:this.activatorOffset.height/2}),this.addRemoveClass("high",!0)),t>this.activatorOffset.left+this.activatorOffset.width?(this.addClass("left"),this.addClass("corner"),!0):this.activatorOffset.left>e?(this.addClass("right"),this.addClass("corner"),!0):!1},getBoundingRect:function(t){var e=t.getBoundingClientRect();return e.width&&e.height?e:{left:e.left,right:e.right,top:e.top,bottom:e.bottom,width:e.right-e.left,height:e.bottom-e.top}},getViewHeight:function(){return void 0===window.innerHeight?document.documentElement.clientHeight:window.innerHeight},getViewWidth:function(){return void 0===window.innerWidth?document.documentElement.clientWidth:window.innerWidth},resetPositioning:function(){this.removeClass("right"),this.removeClass("left"),this.removeClass("high"),this.removeClass("low"),this.removeClass("corner"),this.removeClass("below"),this.removeClass("above"),this.removeClass("vertical"),this.removeClass("horizontal"),this.applyPosition({left:"auto"}),this.applyPosition({top:"auto"})},resizeHandler:function(){this.inherited(arguments),this.adjustPosition()},requestHide:function(){this.setShowing(!1)}});

// $lib/SQLitePlugin.android.js
(function(){var t,e,i,n,o,s,a,r,h,l;return r=this,e=function(t,e,i){var n;if(enyo.log("SQLitePlugin"),!t||!t.name)throw Error("Cannot create a SQLitePlugin instance without a db name");n=t.name,this.openargs=t,this.dbname=n,this.openSuccess=e,this.openError=i,this.openSuccess||(this.openSuccess=function(){return enyo.log("DB opened: "+n)}),this.openError||(this.openError=function(t){return enyo.log(t.message)}),this.open(this.openSuccess,this.openError)},e.prototype.openDBs={},e.prototype.transaction=function(t,e,i){enyo.log("SQLitePlugin.prototype.transaction");var o;o=new n(this.dbname),t(o),o.complete(i,e)},e.prototype.open=function(t,e){enyo.log("SQLitePlugin.prototype.open"),this.dbname in this.openDBs||(this.openDBs[this.dbname]=!0,cordova.exec(t,e,"SQLitePlugin","open",[this.openargs]))},e.prototype.close=function(){enyo.log("SQLitePlugin.prototype.close"),this.dbname in this.openDBs&&(delete this.openDBs[this.dbname],cordova.exec(null,null,"SQLitePlugin","close",[this.dbname]))},a=function(){return 1},e.prototype.executePragmaStatement=function(t,e,i){enyo.log("SQLitePlugin::executePragmaStatement"),a=e,cordova.exec(function(){return 1},i,"SQLitePlugin","executePragmaStatement",[this.dbname,t])},i={p1:function(t,e){var i;enyo.log("PRAGMA CB"),i=a,a=function(){return 1},i(e)}},s=function(){var t,e;for(t=(new Date).getTime(),e=(new Date).getTime();t===e;)e=(new Date).getTime();return e+"000"},l=[],h={},n=function(t){this.dbname=t,this.executes=[],this.trans_id=s(),this.__completed=!1,this.__submitted=!1,this.optimization_no_nested_callbacks=!1,enyo.log("SQLitePluginTransaction - this.trans_id:"+this.trans_id),l[this.trans_id]=[],h[this.trans_id]={}},o={},o.queryCompleteCallback=function(t,e,i){enyo.log("SQLitePluginTransaction.queryCompleteCallback");var n,o;n=null;for(o in l[t])if(l[t][o].query_id===e){n=l[t][o],1===l[t].length?l[t]=[]:l[t].splice(o,1);break}return n&&n.callback?n.callback(i):void 0},o.queryErrorCallback=function(t,e,i){enyo.log("SQLitePluginTransaction.queryErrorCallback");var n,o;n=null;for(o in l[t])if(l[t][o].query_id===e){n=l[t][o],1===l[t].length?l[t]=[]:l[t].splice(o,1);break}return n&&n.err_callback?n.err_callback(i):void 0},o.txCompleteCallback=function(t){return void 0===t?enyo.log("SQLitePluginTransaction.txCompleteCallback---transId = NULL"):t&&h[t]&&h[t].success?h[t].success():void 0},o.txErrorCallback=function(t,e){return t!==void 0?(enyo.log("SQLitePluginTransaction.txErrorCallback---transId:"+t),t&&h[t].error&&h[t].error(e),delete l[t],delete h[t]):enyo.log("SQLitePluginTransaction.txErrorCallback---transId = NULL")},n.prototype.add_to_transaction=function(t,e,i,n,o){var a;a={},a.trans_id=t,n||!this.optimization_no_nested_callbacks?a.query_id=s():this.optimization_no_nested_callbacks&&(a.query_id=""),a.query=e,a.params=i?i:[],a.callback=n,a.err_callback=o,l[t]||(l[t]=[]),l[t].push(a)},n.prototype.executeSql=function(t,e,i,n){enyo.log("SQLitePluginTransaction.prototype.executeSql");var o,s,a;o=void 0,s=void 0,a=void 0,a=this,s=null,i&&(s=function(t){var e,n;return enyo.log("executeSql callback: "+t.length+" items"),e=void 0,n=void 0,n=t,e={rows:{item:function(t){return n[t]},length:n.length},rowsAffected:n.rowsAffected,insertId:n.insertId||null},i(a,e)}),o=null,n?o=function(t){return n(a,t)}:enyo.log("error NULL: "+t),enyo.log("executeSql - add_to_transaction: "+t),this.add_to_transaction(this.trans_id,t,e,s,o)},n.prototype.complete=function(t,e){var i,n,o;if(enyo.log("SQLitePluginTransaction.prototype.complete"),this.__completed)throw Error("Transaction already run");if(this.__submitted)throw Error("Transaction already submitted");this.__submitted=!0,o=this,n=function(){return l[o.trans_id].length>0&&!o.optimization_no_nested_callbacks?(o.__submitted=!1,o.complete(t,e)):(this.__completed=!0,t?t(o):void 0)},i=function(){return null},e&&(i=function(t){return e(o,t)}),h[this.trans_id].success=n,h[this.trans_id].error=i,cordova.exec(null,null,"SQLitePlugin","executeSqlBatch",[this.dbname,l[this.trans_id]])},t={opendb:function(){var t,i,n,o;return 1>arguments.length?null:(i=arguments[0],o=null,n=null,t=null,i.constructor===String?(o={name:i},arguments.length>=5&&(n=arguments[4],arguments.length>5&&(t=arguments[5]))):(o=i,arguments.length>=2&&(n=arguments[1],arguments.length>2&&(t=arguments[2]))),new e(o,n,t))}},r.SQLitePluginCallback=i,r.SQLitePluginTransactionCB=o,r.sqlitePlugin={openDatabase:t.opendb}})();

// $lib/database.js
enyo.kind({name:"gts.database",kind:enyo.Component,published:{database:"",version:"1",estimatedSize:null,debug:!1},db:void 0,dbVersion:null,lastInsertRowId:0,constructor:function(){this.inherited(arguments),this.bound={setSchema:enyo.bind(this,this.setSchema),insertData:enyo.bind(this,this.insertData),_errorHandler:enyo.bind(this,this._errorHandler)}},create:function(){return this.inherited(arguments),""===this.database?(enyo.error("Database: you must define a name for your database when instantiating the kind using the `database` property."),null):(0!==this.database.indexOf("ext:")&&enyo.warn("Database: you are working with an internal database, which will limit its size to 1 MB. Prepend `ext:` to your database name to remove this restriction."),this.db=window.openDatabase(this.database,this.version,this.name,this.estimatedSize),this.db?(this.dbVersion=this.db.version,void 0):(enyo.error("Database: failed to open database named "+this.database),null))},getVersion:function(){return this.dbVersion},lastInsertId:function(){return this.lastInsertRowId},close:function(){this.db.close()},query:function(t,e){if(!this.db)return this._db_lost(),void 0;e=e!==void 0?e:{},enyo.isString(t)||(e.values=t.values,t=t.sql),e=this._getOptions(e,{values:[]}),t=t.replace(/^\s+|\s+$/g,""),t.lastIndexOf(";")!==t.length-1&&(t+=";");var i=this;this.db.transaction(function(n){i.debug&&enyo.log(t," ==> ",e.values),n.executeSql(t,e.values,function(t,n){try{i.lastInsertRowId=n.insertId}catch(o){}e.onSuccess&&e.onSuccess(i._convertResultSet(n))},e.onError)})},queries:function(t,e){if(!this.db)return this._db_lost(),void 0;e=this._getOptions(e);var i=this.debug;this.db.transaction(function(n){for(var o=t.length,s=null,a="",r=[],h=0;o>h;h++)s=t[h],enyo.isString(s)?(a=s,r=[]):(a=s.sql,r=s.values),i&&enyo.log(a," ==> ",r),h===o-1?n.executeSql(a,r,e.onSuccess):n.executeSql(a,r)},e.onError)},setSchema:function(t,e){enyo.isArray(t)||(t=[t]),e=e!==void 0?e:{},e=this._getOptions(e);for(var i=[],n=[],o=t.length,s=null,a=0;o>a;a++)s=t[a],enyo.isString(s)?i.push(s):(s.columns!==void 0&&i.push(this.getCreateTable(s.table,s.columns)),s.data!==void 0&&n.push({table:s.table,data:s.data}));if(n.length>0){var r=enyo.bind(this,this.insertData,n,e);this.queries(i,{onSuccess:r,onError:e.onError})}else this.queries(i,e)},insertData:function(t,e){enyo.isArray(t)||(t=[t]),e=e!==void 0?e:{},e=this._getOptions(e);var i,n,o=[],s=t.length,a=null,r=0,h=null;for(i=0;s>i;i++)if(a=t[i],a.data!==void 0){var l=a.table,d=null;for(d=enyo.isArray(a.data)?a.data:[a.data],r=d.length,n=0;r>n;n++)h=d[n],o.push(this.getInsert(l,h))}this.queries(o,e)},getInsert:function(t,e){var i="INSERT INTO "+t+" ( ";return this._getInsertReplaceSub(i,e)},getReplace:function(t,e){var i="INSERT OR REPLACE INTO "+t+" ( ";return this._getInsertReplaceSub(i,e)},_getInsertReplaceSub:function(t,e){var i=" VALUES ( ",n=[];for(var o in e)enyo.isArray(e[o])&&e[o][1]===!0?(t+=o,i+=e[o][0]):(n.push(e[o]),t+=o,i+="?"),t+=", ",i+=", ";return t=t.substr(0,t.length-2)+" )",i=i.substr(0,i.length-2)+" )",t+=i,new gts.databaseQuery({sql:t,values:n})},getSelect:function(t,e,i,n,o,s){var a="SELECT ",r=[],h="";if(enyo.isString(e))h=e;else if(enyo.isArray(e)){var l=e.length;h=[];for(var d=0;l>d;d++)h.push(e[d]);h=h.join(", ")}a+=(h.length>0?h:"*")+" FROM "+t;var c=[];for(var u in i)c.push(u+" = ?"),r.push(i[u]);return c.length>0&&(a+=" WHERE "+c.join(" AND ")),enyo.isArray(n)&&n.length>0?a+=" ORDER BY "+n.join(", "):enyo.isString(n)&&n.length>0&&(a+=" ORDER BY "+n),o=parseInt(o),isNaN(o)||(a+=" LIMIT ?",r.push(o)),o=parseInt(s),isNaN(s)||(a+=" OFFSET ?",r.push(s)),new gts.databaseQuery({sql:a,values:r})},getUpdate:function(t,e,i){var n="UPDATE "+t+" SET ",o=[],s=[];for(var a in e)s.push(a+" = ?"),o.push(e[a]);n+=s.join(", ");var r=[];for(var a in i)r.push(a+" = ?"),o.push(i[a]);return r.length>0&&(n+=" WHERE "+r.join(" AND ")),new gts.databaseQuery({sql:n,values:o})},getDelete:function(t,e){var i="DELETE FROM "+t+" WHERE ",n=[],o=[];for(var s in e)o.push(s+" = ?"),n.push(e[s]);return i+=o.join(" AND "),new gts.databaseQuery({sql:i,values:n})},getCreateTable:function(t,e,i){i=i!==void 0?i:!0;var n="CREATE TABLE ";i&&(n+="IF NOT EXISTS "),n+=t+" ( ";for(var o=e.length,s=null,a=[],r="",h=0;o>h;h++)s=e[h],r=s.column+" "+s.type,s.constraints&&(r+=" "+s.constraints.join(" ")),a.push(r);return n+=a.join(", ")+" )"},getDropTable:function(t){return"DROP TABLE IF EXISTS "+t},_versionChanged:function(t,e){this.dbVersion=t,e()},_getOptions:function(t,e){var i={onSuccess:this._emptyFunction,onError:this.bound._errorHandler};return e!==void 0&&(i=enyo.mixin(i,e)),t===void 0&&(t={}),enyo.mixin(i,t),enyo.isFunction(t.onError)&&(i.onError=enyo.bind(this,this._errorMixed,t.onError)),i},_emptyFunction:function(){},_convertResultSet:function(t){var e=[];if(t.rows)for(var i=0;t.rows.length>i;i++)e.push(t.rows.item(i));return e},_errorMixed:function(t){return this.bound._errorHandler.apply(this,arguments),t.apply(null,arguments),!1},_errorHandler:function(t,e){e===void 0&&(e=t);var i="Database error ( "+e.code+" ): "+e.message+"<hr />"+enyo.json.stringify(e);enyo.error(i),Checkbook.globals.criticalError&&(enyo.isString(e.message)&&e.message.toLowerCase().match("read only database")?Checkbook.globals.criticalError.load(null,"Warning! Your database has become read only. "+enyo.fetchAppInfo().title+" is unable to modify it in any way. Consult your operating system user's manual on how to remove the read only status from a file. For additional help, please <a href='mailto:"+enyo.fetchAppInfo().vendoremail+"?subject="+enyo.fetchAppInfo().title+" - read only issue'>contact "+enyo.fetchAppInfo().vendor+"</a>.",null):enyo.isString(e.message)&&e.message.toLowerCase().match("disk i/o error")?Checkbook.globals.criticalError.load(null,"Warning! Your database has become locked. Please restart "+enyo.fetchAppInfo().title+". This usually occurs if "+enyo.fetchAppInfo().title+" is running while your device was put in USB mode. For additional help, please <a href='mailto:"+enyo.fetchAppInfo().vendoremail+"?subject="+enyo.fetchAppInfo().title+" - disk i/o issue'>contact "+enyo.fetchAppInfo().vendor+"</a>.",null):Checkbook.globals.criticalError.load(null,i,null))},_db_lost:function(){enyo.error("Database: connection has been closed or lost; cannot execute SQL")}}),gts.databaseQuery=function(t){this.sql=t.sql!==void 0?t.sql:"",this.values=t.values!==void 0?t.values:[]};

// $lib/gdata.js
enyo.kind({name:"gts.gdata",published:{authKey:"",acctType:"HOSTED_OR_GOOGLE",appName:"",version:"3.0"},xmlToJson:function(t){var e={};if(1==t.nodeType){if(t.attributes.length>0){e["@attributes"]={};for(var i=0;t.attributes.length>i;i++){var n=t.attributes.item(i);e["@attributes"][n.nodeName]=n.nodeValue}}}else 3==t.nodeType&&(e=t.nodeValue);if(t.hasChildNodes())for(var o=0;t.childNodes.length>o;o++){var s=t.childNodes.item(o),a=s.nodeName;if(e[a]===void 0)e[a]=this.xmlToJson(s);else{if(e[a].length===void 0){var r=e[a];e[a]=[],e[a].push(r)}e[a].push(this.xmlToJson(s))}}return e},getSheetSummary:function(t,e){t===void 0&&e.onError("No sheet key defined.");var i=this;new enyo.Ajax({url:"https://spreadsheets.google.com/feeds/worksheets/"+t+"/private/full",method:"GET",handleAs:"xml",headers:{"GData-Version":this.version,Authorization:this.authKey}}).go().response(function(t,n){var o=i.xmlToJson(n);e.onSuccess(t,o)}).error(enyo.bind(this,this.generalFailure,e.onError))},getSheetData:function(t,e,i,n,o){var s=this;new enyo.Ajax({url:"https://spreadsheets.google.com/feeds/list/"+t+"/"+e+"/private/full?start-index="+i+"&max-results="+n,method:"GET",handleAs:"xml",headers:{"GData-Version":this.version,Authorization:this.authKey}}).go().response(function(t,e){var i=s.xmlToJson(e);o.onSuccess(t,i)}).error(enyo.bind(this,this.generalFailure,o.onError))},generalFailure:function(t,e,i){var n="";n=i&&"timeout"===i?"The request timed out. Please check your network connection and try again.":e.responseText!==void 0?e.responseText.match("Error=BadAuthentication")?"Did you enter your username and password correctly?":e.responseText.match("Error=CaptchaRequired")?"Google is requesting that you complete a CAPTCHA Challenge. Please go to <a href='https://www.google.com/accounts/DisplayUnlockCaptcha'>https://www.google.com/accounts/DisplayUnlockCaptcha</a> to complete it.":e.responseText.match("Error=NotVerified")?"The account email address has not been verified. You will need to access your Google account directly to resolve the issue before logging in using a non-Google application.":e.responseText.match("Error=TermsNotAgreed")?"You have not agreed to Google's terms. You will need to access your Google account directly to resolve the issue before logging in using a non-Google application.":e.responseText.match("Error=AccountDeleted")?"The user account has been deleted and is therefore unable to log in.":e.responseText.match("Error=AccountDisabled")?"The user account has been disabled. Please contact Google.":e.responseText.match("Error=ServiceDisabled")?"Your access to the specified service has been disabled. (Your account may still be valid.)":e.responseText.match("Error=ServiceUnavailable")?"The service is not available; try again later.":e.responseText.match("Error=Unknown")?"Unknown Error. Did you enter your username and password correctly?":"There has been an error: "+e.responseText:"An unknown error occurred.",t&&"function"==typeof t&&t(n)}});

// $lib/utils.js
function prepAmount(t){return Math.round(100*t)/100}function formatAmount(t){return t=parseFloat(t),(!t||isNaN(t))&&(t=0),t.formatCurrency(2,"$",".",",")}function deformatAmount(t){if(t=gts.String.trim(t),!t)return 0;if(isNaN(t)){var e="("===t[0]&&")"===t[t.length-1];t=gts.String.trim(t.replace(/[^0-9\s,'".-]*/g,""));var i=t.length;if(0>=i)return 0;for(var n=3,o=t.length-1;n--;)if(t[o-n]&&"-"!==t[o-n]&&isNaN(t[o-n])){i=o-n;break}var s=t.slice(0,i),a=t.slice(i);t=(e||"-"==s[0]?"-":"")+s.replace(/[^0-9]*/g,"")+"."+a.replace(/[^0-9]*/g,"")}return""==t||isNaN(t)?0:parseFloat(t)}function createImageObject(t){var e=document.createElement("img");return e.setAttribute("src",t),e}function imgToGrey(t){var e=createImageObject(t),i=document.createElement("canvas"),n=i.getContext("2d");i.width=e.width,i.height=e.height,n.drawImage(e,0,0);for(var o=n.getImageData(0,0,e.width,e.height),s=0;o.height>s;s++)for(var a=0;o.width>a;a++){var r=4*s*o.width+4*a,h=(o.data[r]+o.data[r+1]+o.data[r+2])/3;o.data[r]=h,o.data[r+1]=h,o.data[r+2]=h}return n.putImageData(o,0,0,0,0,o.width,o.height),i.toDataURL()}enyo.isFunction(enyo.fetchAppInfo)||(enyo.fetchAppInfo=enyo.isFunction(enyo.g11n.Utils._fetchAppRootPath)?function(){if(!enyo._applicationInformation)try{var t=enyo.g11n.Utils._fetchAppRootPath()+"appinfo.json";enyo._applicationInformation=JSON.parse(enyo.xhr.request({url:t,sync:!0}).responseText)}catch(e){enyo._applicationInformation={title:"App Name",error:"Error in fetching application information."},enyo.error("enyo.fetchAppInfo(): couldn't fetch app info",e)}return enyo._applicationInformation}:function(){return{title:"App Name",error:"enyo.g11n.Utils._fetchAppRootPath does not exist. Please make sure you are using the enyo.g11n library in this application."}});

// $lib/aes.js
var CryptoJS=CryptoJS||function(t,e){var i={},n=i.lib={},o=n.Base=function(){function t(){}return{extend:function(e){t.prototype=this;var i=new t;return e&&i.mixIn(e),i.$super=this,i},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.$super.extend(this)}}}(),s=n.WordArray=o.extend({init:function(t,i){t=this.words=t||[],this.sigBytes=i!=e?i:4*t.length},toString:function(t){return(t||r).stringify(this)},concat:function(t){var e=this.words,i=t.words,n=this.sigBytes,t=t.sigBytes;if(this.clamp(),n%4)for(var o=0;t>o;o++)e[n+o>>>2]|=(255&i[o>>>2]>>>24-8*(o%4))<<24-8*((n+o)%4);else if(i.length>65535)for(o=0;t>o;o+=4)e[n+o>>>2]=i[o>>>2];else e.push.apply(e,i);return this.sigBytes+=t,this},clamp:function(){var e=this.words,i=this.sigBytes;e[i>>>2]&=4294967295<<32-8*(i%4),e.length=t.ceil(i/4)},clone:function(){var t=o.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var i=[],n=0;e>n;n+=4)i.push(0|4294967296*t.random());return s.create(i,e)}}),a=i.enc={},r=a.Hex={stringify:function(t){for(var e=t.words,t=t.sigBytes,i=[],n=0;t>n;n++){var o=255&e[n>>>2]>>>24-8*(n%4);i.push((o>>>4).toString(16)),i.push((15&o).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,i=[],n=0;e>n;n+=2)i[n>>>3]|=parseInt(t.substr(n,2),16)<<24-4*(n%8);return s.create(i,e/2)}},h=a.Latin1={stringify:function(t){for(var e=t.words,t=t.sigBytes,i=[],n=0;t>n;n++)i.push(String.fromCharCode(255&e[n>>>2]>>>24-8*(n%4)));return i.join("")},parse:function(t){for(var e=t.length,i=[],n=0;e>n;n++)i[n>>>2]|=(255&t.charCodeAt(n))<<24-8*(n%4);return s.create(i,e)}},l=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(h.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(t){return h.parse(unescape(encodeURIComponent(t)))}},d=n.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=s.create(),this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=l.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var i=this._data,n=i.words,o=i.sigBytes,a=this.blockSize,r=o/(4*a),r=e?t.ceil(r):t.max((0|r)-this._minBufferSize,0),e=r*a,o=t.min(4*e,o);if(e){for(var h=0;e>h;h+=a)this._doProcessBlock(n,h);h=n.splice(0,e),i.sigBytes-=o}return s.create(h,o)},clone:function(){var t=o.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});n.Hasher=d.extend({init:function(){this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize(),this._hash},clone:function(){var t=d.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:16,_createHelper:function(t){return function(e,i){return t.create(i).finalize(e)}},_createHmacHelper:function(t){return function(e,i){return c.HMAC.create(t,i).finalize(e)}}});var c=i.algo={};return i}(Math);(function(){var t=CryptoJS,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,i=t.sigBytes,n=this._map;t.clamp();for(var t=[],o=0;i>o;o+=3)for(var s=(255&e[o>>>2]>>>24-8*(o%4))<<16|(255&e[o+1>>>2]>>>24-8*((o+1)%4))<<8|255&e[o+2>>>2]>>>24-8*((o+2)%4),a=0;4>a&&i>o+.75*a;a++)t.push(n.charAt(63&s>>>6*(3-a)));if(e=n.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var t=t.replace(/\s/g,""),i=t.length,n=this._map,o=n.charAt(64);o&&(o=t.indexOf(o),-1!=o&&(i=o));for(var o=[],s=0,a=0;i>a;a++)if(a%4){var r=n.indexOf(t.charAt(a-1))<<2*(a%4),h=n.indexOf(t.charAt(a))>>>6-2*(a%4);o[s>>>2]|=(r|h)<<24-8*(s%4),s++}return e.create(o,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})(),function(t){function e(t,e,i,n,o,s,a){return t=t+(e&i|~e&n)+o+a,(t<<s|t>>>32-s)+e}function i(t,e,i,n,o,s,a){return t=t+(e&n|i&~n)+o+a,(t<<s|t>>>32-s)+e}function n(t,e,i,n,o,s,a){return t=t+(e^i^n)+o+a,(t<<s|t>>>32-s)+e}function o(t,e,i,n,o,s,a){return t=t+(i^(e|~n))+o+a,(t<<s|t>>>32-s)+e}var s=CryptoJS,a=s.lib,r=a.WordArray,a=a.Hasher,h=s.algo,l=[];(function(){for(var e=0;64>e;e++)l[e]=0|4294967296*t.abs(t.sin(e+1))})(),h=h.MD5=a.extend({_doReset:function(){this._hash=r.create([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,s){for(var a=0;16>a;a++){var r=s+a,h=t[r];t[r]=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8)}for(var r=this._hash.words,h=r[0],d=r[1],c=r[2],u=r[3],a=0;64>a;a+=4)16>a?(h=e(h,d,c,u,t[s+a],7,l[a]),u=e(u,h,d,c,t[s+a+1],12,l[a+1]),c=e(c,u,h,d,t[s+a+2],17,l[a+2]),d=e(d,c,u,h,t[s+a+3],22,l[a+3])):32>a?(h=i(h,d,c,u,t[s+(a+1)%16],5,l[a]),u=i(u,h,d,c,t[s+(a+6)%16],9,l[a+1]),c=i(c,u,h,d,t[s+(a+11)%16],14,l[a+2]),d=i(d,c,u,h,t[s+a%16],20,l[a+3])):48>a?(h=n(h,d,c,u,t[s+(3*a+5)%16],4,l[a]),u=n(u,h,d,c,t[s+(3*a+8)%16],11,l[a+1]),c=n(c,u,h,d,t[s+(3*a+11)%16],16,l[a+2]),d=n(d,c,u,h,t[s+(3*a+14)%16],23,l[a+3])):(h=o(h,d,c,u,t[s+3*a%16],6,l[a]),u=o(u,h,d,c,t[s+(3*a+7)%16],10,l[a+1]),c=o(c,u,h,d,t[s+(3*a+14)%16],15,l[a+2]),d=o(d,c,u,h,t[s+(3*a+5)%16],21,l[a+3]));r[0]=0|r[0]+h,r[1]=0|r[1]+d,r[2]=0|r[2]+c,r[3]=0|r[3]+u},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;for(e[n>>>5]|=128<<24-n%32,e[(n+64>>>9<<4)+14]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),t.sigBytes=4*(e.length+1),this._process(),t=this._hash.words,e=0;4>e;e++)i=t[e],t[e]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}}),s.MD5=a._createHelper(h),s.HmacMD5=a._createHmacHelper(h)}(Math),function(){var t=CryptoJS,e=t.lib,i=e.Base,n=e.WordArray,e=t.algo,o=e.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var i=this.cfg,o=i.hasher.create(),s=n.create(),a=s.words,r=i.keySize,i=i.iterations;r>a.length;){h&&o.update(h);var h=o.update(t).finalize(e);o.reset();for(var l=1;i>l;l++)h=o.finalize(h),o.reset();s.concat(h)}return s.sigBytes=4*r,s}});t.EvpKDF=function(t,e,i){return o.create(i).compute(t,e)}}(),CryptoJS.lib.Cipher||function(t){var e=CryptoJS,i=e.lib,n=i.Base,o=i.WordArray,s=i.BufferedBlockAlgorithm,a=e.enc.Base64,r=e.algo.EvpKDF,h=i.Cipher=s.extend({cfg:n.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,i){this.cfg=this.cfg.extend(i),this._xformMode=t,this._key=e,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){return function(t){return{encrypt:function(e,i,n){return("string"==typeof i?f:g).encrypt(t,e,i,n)},decrypt:function(e,i,n){return("string"==typeof i?f:g).decrypt(t,e,i,n)}}}}()});i.StreamCipher=h.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var l=e.mode={},d=i.BlockCipherMode=n.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}}),l=l.CBC=function(){function e(e,i,n){var o=this._iv;o?this._iv=t:o=this._prevBlock;for(var s=0;n>s;s++)e[i+s]^=o[s]}var i=d.extend();return i.Encryptor=i.extend({processBlock:function(t,i){var n=this._cipher,o=n.blockSize;e.call(this,t,i,o),n.encryptBlock(t,i),this._prevBlock=t.slice(i,i+o)}}),i.Decryptor=i.extend({processBlock:function(t,i){var n=this._cipher,o=n.blockSize,s=t.slice(i,i+o);n.decryptBlock(t,i),e.call(this,t,i,o),this._prevBlock=s}}),i}(),c=(e.pad={}).Pkcs7={pad:function(t,e){for(var i=4*e,i=i-t.sigBytes%i,n=i<<24|i<<16|i<<8|i,s=[],a=0;i>a;a+=4)s.push(n);i=o.create(s,i),t.concat(i)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}};i.BlockCipher=h.extend({cfg:h.cfg.extend({mode:l,padding:c}),reset:function(){h.reset.call(this);var t=this.cfg,e=t.iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var i=t.createEncryptor;else i=t.createDecryptor,this._minBufferSize=1;this._mode=i.call(t,this,e&&e.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var u=i.CipherParams=n.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),l=(e.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext,t=t.salt,e=(t?o.create([1398893684,1701076831]).concat(t).concat(e):e).toString(a);return e=e.replace(/(.{64})/g,"$1\n")},parse:function(t){var t=a.parse(t),e=t.words;if(1398893684==e[0]&&1701076831==e[1]){var i=o.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return u.create({ciphertext:t,salt:i})}},g=i.SerializableCipher=n.extend({cfg:n.extend({format:l}),encrypt:function(t,e,i,n){var n=this.cfg.extend(n),o=t.createEncryptor(i,n),e=o.finalize(e),o=o.cfg;return u.create({ciphertext:e,key:i,iv:o.iv,algorithm:t,mode:o.mode,padding:o.padding,blockSize:t.blockSize,formatter:n.format})},decrypt:function(t,e,i,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),t.createDecryptor(i,n).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t):t}}),e=(e.kdf={}).OpenSSL={compute:function(t,e,i,n){return n||(n=o.random(8)),t=r.create({keySize:e+i}).compute(t,n),i=o.create(t.words.slice(e),4*i),t.sigBytes=4*e,u.create({key:t,iv:i,salt:n})}},f=i.PasswordBasedCipher=g.extend({cfg:g.cfg.extend({kdf:e}),encrypt:function(t,e,i,n){return n=this.cfg.extend(n),i=n.kdf.compute(i,t.keySize,t.ivSize),n.iv=i.iv,t=g.encrypt.call(this,t,e,i.key,n),t.mixIn(i),t},decrypt:function(t,e,i,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),i=n.kdf.compute(i,t.keySize,t.ivSize,e.salt),n.iv=i.iv,g.decrypt.call(this,t,e,i.key,n)}})}(),function(){var t=CryptoJS,e=t.lib.BlockCipher,i=t.algo,n=[],o=[],s=[],a=[],r=[],h=[],l=[],d=[],c=[],u=[];(function(){for(var t=[],e=0;256>e;e++)t[e]=128>e?e<<1:283^e<<1;for(var i=0,g=0,e=0;256>e;e++){var f=g^g<<1^g<<2^g<<3^g<<4,f=99^(f>>>8^255&f);n[i]=f,o[f]=i;var p=t[i],m=t[p],y=t[m],v=257*t[f]^16843008*f;s[i]=v<<24|v>>>8,a[i]=v<<16|v>>>16,r[i]=v<<8|v>>>24,h[i]=v,v=16843009*y^65537*m^257*p^16843008*i,l[f]=v<<24|v>>>8,d[f]=v<<16|v>>>16,c[f]=v<<8|v>>>24,u[f]=v,i?(i=p^t[t[t[y^p]]],g^=t[t[g]]):i=g=1}})();var g=[0,1,2,4,8,16,32,64,128,27,54],i=i.AES=e.extend({_doReset:function(){for(var t=this._key,e=t.words,i=t.sigBytes/4,t=4*((this._nRounds=i+6)+1),o=this._keySchedule=[],s=0;t>s;s++)if(i>s)o[s]=e[s];else{var a=o[s-1];s%i?i>6&&4==s%i&&(a=n[a>>>24]<<24|n[255&a>>>16]<<16|n[255&a>>>8]<<8|n[255&a]):(a=a<<8|a>>>24,a=n[a>>>24]<<24|n[255&a>>>16]<<16|n[255&a>>>8]<<8|n[255&a],a^=g[0|s/i]<<24),o[s]=o[s-i]^a}for(e=this._invKeySchedule=[],i=0;t>i;i++)s=t-i,a=i%4?o[s]:o[s-4],e[i]=4>i||4>=s?a:l[n[a>>>24]]^d[n[255&a>>>16]]^c[n[255&a>>>8]]^u[n[255&a]]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,s,a,r,h,n)},decryptBlock:function(t,e){var i=t[e+1];t[e+1]=t[e+3],t[e+3]=i,this._doCryptBlock(t,e,this._invKeySchedule,l,d,c,u,o),i=t[e+1],t[e+1]=t[e+3],t[e+3]=i},_doCryptBlock:function(t,e,i,n,o,s,a,r){for(var h=this._nRounds,l=t[e]^i[0],d=t[e+1]^i[1],c=t[e+2]^i[2],u=t[e+3]^i[3],g=4,f=1;h>f;f++)var p=n[l>>>24]^o[255&d>>>16]^s[255&c>>>8]^a[255&u]^i[g++],m=n[d>>>24]^o[255&c>>>16]^s[255&u>>>8]^a[255&l]^i[g++],y=n[c>>>24]^o[255&u>>>16]^s[255&l>>>8]^a[255&d]^i[g++],u=n[u>>>24]^o[255&l>>>16]^s[255&d>>>8]^a[255&c]^i[g++],l=p,d=m,c=y;p=(r[l>>>24]<<24|r[255&d>>>16]<<16|r[255&c>>>8]<<8|r[255&u])^i[g++],m=(r[d>>>24]<<24|r[255&c>>>16]<<16|r[255&u>>>8]<<8|r[255&l])^i[g++],y=(r[c>>>24]<<24|r[255&u>>>16]<<16|r[255&l>>>8]<<8|r[255&d])^i[g++],u=(r[u>>>24]<<24|r[255&l>>>16]<<16|r[255&d>>>8]<<8|r[255&c])^i[g++],t[e]=p,t[e+1]=m,t[e+2]=y,t[e+3]=u},keySize:8});t.AES=e._createHelper(i)}();

// Array.js
Array.prototype.swap=function(t,e){var i=this[t];return this[t]=this[e],this[e]=i,this};

// Date.js
Date.prototype.format=function(t){if(enyo.g11n){"special"==t?t={date:"yyyy-MM-dd",time:"HH:mm:ss"}:t===void 0?t={date:"medium",time:"short"}:enyo.isString(t)||(t.date===void 0?t.date="medium":t.time===void 0&&(t.time="short"));try{var e=new enyo.g11n.DateFmt(t);return e.format(this)}catch(i){return enyo.error("Date.prototype.format error: ",i),""+this}}return""},Date.format=function(t){return(new Date).format(t)},Date.prototype.setStartOfMonth=function(){return this.setDate(1),this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),Date.parse(this)},Date.prototype.setEndOfMonth=function(){return this.setDate(this.daysInMonth()),this.setHours(23),this.setMinutes(59),this.setSeconds(59),this.setMilliseconds(999),Date.parse(this)},Date.prototype.daysInMonth=function(){return 32-new Date(this.getFullYear(),this.getMonth(),32).getDate()},Date.deformat=function(t){var e=Date.parse(t);return isNaN(e)&&(e=Date.deformat(t.replace(/A\.M\./i,"am").replace(/P\.M\./i,"pm"))),e},Date.validDate=function(t){return gts.Object.isDate(t)&&!isNaN(t.getTime())};

// Math.js
Math.sum=function(t){for(var e=0,i=0;t.length>i;i++)e+=t[i];return e},Math.mean=function(t){return t.length>0?this.sum(t)/t.length:!1},Math.median=function(t){return 0>=t.length?!1:(t=this.sort(t),t.length.isEven()?this.mean([t[t.length/2-1],t[t.length/2]]):t[(t.length/2).floor()])},Math.variance=function(t){if(0>=t.length)return!1;for(var e=this.mean(t),i=[],n=0;t.length>n;n++)i.push(this.pow(t[n]-e,2));return this.mean(i)},Math.stdDev=function(t){return this.sqrt(this.variance(t))},Math.sinh=function(t){return(this.exp(t)-this.exp(-t))/2},Math.cosh=function(t){return(this.exp(t)+this.exp(-t))/2},Math.tanh=function(t){return this.sinh(t)/this.cosh(t)},Math.coth=function(t){return this.cosh(t)/this.sinh(t)},Math.sech=function(t){return 2/(this.exp(t)+this.exp(-t))},Math.csch=function(t){return 2/(this.exp(t)-this.exp(-t))},Math.sort=function(t,e){return t.clone().sort(function(t,i){return e?i-t:t-i})};

// Number.js
Number.prototype.isNaN=function(){return isNaN(this)},Number.prototype.isNull=function(){return 0==this},Number.prototype.isEven=function(){return this.isInteger()?0===this%2?!1:!0:!1},Number.prototype.isOdd=function(){return this.isInteger()?0===this%2?!0:!1:!1},Number.prototype.isInteger=function(t){return this.isNaN()?!1:t&&this.isNull()?!1:0===this-this.floor()?!1:!0},Number.prototype.isNatural=function(t){return this.isInteger(t)&&this>=0},Number.prototype.formatCurrency=function(t,e,i,n){t=isNaN(t)?2:Math.abs(t),e=e||"$",i=i||".",n=n===void 0?",":n;var o=0>this?"-":"",s=Math.abs(this).toFixed(t),a=parseInt(s)+"",r=(r=a.length)>3?r%3:0;return o+e+(r?a.substr(0,r)+n:"")+a.substr(r).replace(/(\d{3})(?=\d)/g,"$1"+n)+(t?i+Math.abs(s-a).toFixed(t).slice(2):"")};

// Object.js
enyo.singleton({name:"gts.Object",kind:"enyo.Component",numericValues:function(t){return Object.values(t).select(this.isNumber)},validNumber:function(t){return this.isNumber(t)&&!isNaN(parseFloat(t))&&isFinite(t)},swap:function(t,e,i){var n=t[e];return t[e]=t[i],t[i]=n,t},size:function(t){var e,i=0;for(e in t)t.hasOwnProperty(e)&&i++;return i},isFunction:function(t){return enyo.isFunction?enyo.isFunction(t):"[object Function]"===Object.prototype.toString.call(t)},isString:function(t){return enyo.isString?enyo.isString(t):"[object String]"===Object.prototype.toString.call(t)},isNumber:function(t){return"[object Number]"===Object.prototype.toString.call(t)},isDate:function(t){return"[object Date]"===Object.prototype.toString.call(t)},isUndefined:function(t){return t===void 0}});

// String.js
enyo.singleton({name:"gts.String",kind:"enyo.Component",published:{dirtyItem:["&","<",">",'"',"`","'","\n"],cleanItem:["&amp;","$lt;","&gt;","&quot;","'","'","&crarr;"]},stripHTML:function(t){return t?t.replace(/<\S[^><]*>/g,""):""},cleanString:function(t){if(t){for(var e=0;this.dirtyItem.length>e;e++)t=t.replace(RegExp(this.dirtyItem[e],"g"),this.cleanItem[e]);return t}return""},dirtyString:function(t){if(t){for(var e=0;this.dirtyItem.length>e;e++)t=t.replace(RegExp(this.cleanItem[e],"g"),this.dirtyItem[e]);return t}return""},trim:function(t){return t?t.replace(/^\s\s*/,"").replace(/\s\s*$/,""):""},ucfirst:function(t){if(t){var e=t.charAt(0).toUpperCase();return e+t.substr(1)}return""},isBlank:function(t){return t?/^\s*$/.test(t):!0},isJSON:function(t){return t&&!this.isBlank(t)?(t=t.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@"),t=t.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]"),t=t.replace(/(?:^|:|,)(?:\s*\[)+/g,""),/^[\],:{}\s]*$/.test(t)):!1}});

// gapi.js
enyo.kind({name:"gts.Gapi",nextSteps:{},phonegapInAppBrowser:!1,published:{apiKey:"",clientId:"",clientSecret:"",scope:[],gapiConfig:{endpoint:"https://accounts.google.com/o/oauth2/auth",endtoken:"https://accounts.google.com/o/oauth2/token",response_type:"code",redirect_uri:"http://localhost",accessTokenExpireLimit:348e4,grantTypes:{AUTHORIZE:"authorization_code",REFRESH:"refresh_token"},access_type:"offline",state:"lligtaskinit"}},events:{onReady:""},constructor:function(){this.inherited(arguments),this._binds={_cbUrlChanged:enyo.bind(this,this.cbUrlChanged),_exitIAB:enyo.bind(this,this.exitIAB),_handleAuthResult:enyo.bind(this,this.handleAuthResult)}},create:function(){this.inherited(arguments),this.isGapiReady()?(this.doReady(),this.apiKeyChanged()):this.loadGapi()},isGapiReady:function(){return!("undefined"==typeof gapi)},loadGapi:function(){new enyo.JsonpRequest({url:"https://apis.google.com/js/client.js",callbackName:"onload"}).go().response(this,"gapiLoaded")},gapiLoaded:function(){""!=this.apiKey&&this.apiKeyChanged(),this.doReady()},apiKeyChanged:function(){gapi.client.setApiKey(this.apiKey)},getAuthToken:function(){return gapi.auth.getToken()},setAuthToken:function(t){return gapi.auth.setToken(t)},auth:function(t){if(this.nextSteps=t,window.device&&(enyo.platform.android||enyo.platform.androidChrome)){{this.getAuthToken()}this.log("Phonegap-InAppBrowser Auth");var e={client_id:encodeURIComponent(this.clientId),scope:encodeURIComponent(this.scope.join(" ")),redirect_uri:encodeURIComponent(this.gapiConfig.redirect_uri),response_type:encodeURIComponent(this.gapiConfig.response_type),state:encodeURIComponent(this.gapiConfig.state),access_type:encodeURIComponent(this.gapiConfig.access_type),approval_prompt:"force"},i=this.gapiConfig.endpoint+"?"+Object.keys(e).map(function(t){return t+"="+e[t]}).join("&");this.openIAB(i,"_blank","location=no")}else gapi.auth.authorize({client_id:this.clientId,scope:this.scope.join(" "),immediate:!0},this._binds._handleAuthResult)},openIAB:function(t,e,i){this.closeIAB(),this.phonegapInAppBrowser=window.open(t,e,i),this.bindIABEvents()},closeIAB:function(){this.phonegapInAppBrowser&&this.phonegapInAppBrowser.close()},exitIAB:function(){this.unbindIABvents(),this.phonegapInAppBrowser=!1},bindIABEvents:function(){this.phonegapInAppBrowser&&(this.phonegapInAppBrowser.addEventListener("exit",this._binds._exitIAB),this.phonegapInAppBrowser.addEventListener("loadstart",this._binds._cbUrlChanged))},unbindIABEvents:function(){this.phonegapInAppBrowser&&(this.phonegapInAppBrowser.removeEventListener("exit",this._binds._exitIAB),this.phonegapInAppBrowser.removeEventListener("loadstart",this._binds._cbUrlChanged))},cbUrlChanged:function(t){if(this.log(arguments),-1!=t.url.indexOf("code=")){this.log("Authenticated"),this.closeIAB();var e=this.getParameterByName("code",t.url);enyo.job("refreshFromUrlChange",enyo.bind(this,this.getRefreshToken,e,this.nextSteps),1e3)}else-1!=t.url.indexOf("error=")?(this.closeIAB(),enyo.isFunction(this.nextSteps.onError)&&this.nextSteps.onError(this.getParameterByName("error",t.url))):this.log("Status unknown: "+t.url)},getParameterByName:function(t,e){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=RegExp("[\\?&]"+t+"=([^&#]*)"),n=i.exec(e);return null==n?!1:decodeURIComponent(n[1].replace(/\+/g," "))},getAccessToken:function(t){this.log("Update token"),this.nextSteps={};var e=(new Date).getTime(),i=this.getAuthToken();if(i&&i.access_token&&i.expires_in+this.gapiConfig.accessTokenExpireLimit>e)return enyo.isFunction(t.onSuccess)&&t.onSuccess(),void 0;this.log("Fetching fresh token");var n=new enyo.Ajax({url:this.gapiConfig.endtoken,method:"POST",postBody:{client_id:this.clientId,client_secret:this.clientSecret,refresh_token:i.access_token,redirect_uri:this.gapiConfig.redirect_uri,grant_type:this.gapiConfig.grantTypes.AUTHORIZE}});n.go(),n.response(this,function(e,i){this.log("Access complete");var n={access_token:i.access_token};return this.setAuthToken(n),i.error=!1,enyo.isFunction(t.onSuccess)&&t.onSuccess(i),!0}),n.error(this,function(e,i){return this.log("Access error"),enyo.isFunction(t.onError)&&(i.error=!0,t.onError(i)),!0})},getRefreshToken:function(t,e){this.log("Refresh token");var i=new enyo.Ajax({url:this.gapiConfig.endtoken,method:"POST",postBody:{code:t,client_id:this.clientId,client_secret:this.clientSecret,redirect_uri:this.gapiConfig.redirect_uri,grant_type:this.gapiConfig.grantTypes.AUTHORIZE}});i.go(),i.response(this,function(t,i){return this.log("Refresh complete",enyo.json.stringify(i)),this.setAuthToken(i),enyo.isFunction(e.onSuccess)&&e.onSuccess(i),!0}),i.error(this,function(t,i){return this.log("Refresh error",enyo.json.stringify(i)),enyo.isFunction(e.onError)&&(i.error=!0,e.onError(i)),!0})},handleAuthResult:function(t){if(this.$.authPop&&(this.$.authPop.hide(),this.$.authPop.destroy()),t&&!t.error)enyo.isFunction(this.nextSteps.onSuccess)&&this.nextSteps.onSuccess();else{var e={name:"authPop",kind:"onyx.Popup",centered:!0,floating:!0,modal:!0,scrim:!0,components:[{content:"Authenticate with Google",classes:"margin-half-bottom bigger text-center"},{classes:"text-center",components:[{kind:"onyx.Button",content:"Cancel",ontap:"handleAuthAbort",classes:"onyx-negative",style:"margin-right: 15px;"},{kind:"onyx.Button",content:"Authenticate",onclick:"handleAuthClick",classes:"onyx-affirmative"}]}]};this.createComponent(e),this.render(),this.$.authPop.show();var i=this.$.authPop.getComputedStyleValue("zIndex");if(!i)for(var n=this.$.authPop.domCssText.split(";"),o=0;n.length>o;o++)if(n[o].match("z-index")){n=n[o].split(":"),i=n[1];break}this.$.authPop.applyStyle("z-index",i-5+10),this.$.authPop.reflow()}},handleAuthAbort:function(){this.$.authPop.hide(),enyo.isFunction(this.nextSteps.onError)&&this.nextSteps.onError()},handleAuthClick:function(){gapi.auth.authorize({client_id:this.clientId,scope:this.scope.join(" "),immediate:!1},this._binds._handleAuthResult)},loadModule:function(t,e,i){return this.isGapiReady()?(gapi.client[t]===void 0?gapi.client.load(t,"v"+e,i.onSuccess):enyo.isFunction(i.onSuccess)&&i.onSuccess(),void 0):(i.onError({message:"Google API not ready yet."}),void 0)}});

// LazyList.js
enyo.kind({name:"gts.LazyList",kind:"enyo.AroundList",lastLazyLoad:0,published:{pageSize:50},events:{onAcquirePage:""},constructor:function(){this.inherited(arguments),this.binds={_requestData:enyo.bind(this,this._requestData)}},lazyLoad:function(){this.lastLazyLoad=0,this._requestData()},scroll:function(){var t=this.getStrategy().$.scrollMath,e=this.$.belowClient.hasNode()?this.$.belowClient.getBounds():{left:0,top:0,width:0,height:0};return(t.isInOverScroll()&&0>t.y||t.y<t.bottomBoundary+e.height)&&this.lastLazyLoad<this.pageCount&&(this.lastLazyLoad=this.pageCount,enyo.job("gts.LazyList#_requestData",this.binds._requestData,250)),this.inherited(arguments)},_requestData:function(){this.doAcquirePage({page:this.lastLazyLoad,pageSize:this.pageSize})},reset:function(){this.inherited(arguments)}});

// SelectorBar.js
enyo.kind({name:"gts.SelectorBar",kind:"onyx.Item",classes:"gts-selectorBar",published:{label:"Select One",sublabel:"",choices:[],value:"",disabled:!1,maxHeight:200,labelWidth:null,menuClasses:""},events:{onChange:""},components:[{name:"base",kind:"enyo.FittableColumns",components:[{name:"valueIcon",kind:"enyo.Image",style:"margin-right: 1em;"},{name:"valueDisplay",fit:!0},{kind:"onyx.MenuDecorator",components:[{name:"labelButton",kind:"onyx.Button",classes:"label arrow"},{name:"menu",kind:"onyx.Picker",classes:"gts-selectorBar",onChange:"selectionChanged",components:[]}]}]},{name:"sublabel",classes:"sub-label"}],rendered:function(){this.inherited(arguments),this.labelChanged(),this.sublabelChanged(),this.choicesChanged(),this.valueChanged(),this.disabledChanged(),this.labelWidthChanged(),this.maxHeightChanged(),this.menuClassesChanged(),enyo.asyncMethod(this,this.reflow)},reflow:function(){enyo.asyncMethod(this,this.waterfallDown,"onresize","onresize",this)},labelChanged:function(){this.$.labelButton.setContent(this.label)},sublabelChanged:function(){this.$.sublabel.setContent(this.sublabel),""===this.sublabel?this.$.sublabel.hide():this.$.sublabel.show()},choicesChanged:function(){this.$.menu.destroyClientControls(),this.$.menu.createComponents(this.choices),this.valueChanged()},disabledChanged:function(){this.$.labelButton.setDisabled(this.disabled)},maxHeightChanged:function(){this.$.menu.setMaxHeight(this.maxHeight)},labelWidthChanged:function(){this.$.labelButton.applyStyle("width",this.labelWidth)},menuClassesChanged:function(t){this.$.menu.removeClass(t),this.$.menu.addClass(this.menuClasses)},setValue:function(t){this.value=t,this.valueChanged()},valueChanged:function(){if(0!==this.choices.length){null===this.value&&(this.value=this._getValue(this.choices[0]));for(var t=0;this.choices.length>t;t++)if(this.value===this._getValue(this.choices[t])){this.$.valueDisplay.setContent(this.choices[t].content),this.choices[t].icon||this.choices[t].src?(this.$.valueIcon.setSrc(this.choices[t].icon||this.choices[t].src),this.$.valueIcon.show()):this.$.valueIcon.hide();break}this.reflow()}},_getValue:function(t){return t.hasOwnProperty("value")?t.value:t.content},selectionChanged:function(t,e){return this.value=e.selected.hasOwnProperty("value")?e.selected.value:e.content,this.valueChanged(),this.doChange(e),this.reflow(),!0}});

// ToggleBar.js
enyo.kind({name:"gts.ToggleBar",kind:"onyx.Item",classes:"gts-ToggleBar",published:{label:"Toggle Button",sublabel:"",onContent:"On",offContent:"Off",value:!1},events:{onChange:""},components:[{name:"base",kind:"enyo.FittableColumns",components:[{fit:!0,components:[{name:"label"},{name:"sublabel",style:"font-size: 75%;"}]},{name:"switch",kind:"onyx.ToggleButton",ontap:"switchToggled",onChange:"switchChanged"}]}],handlers:{ontap:"barTapped"},rendered:function(){this.inherited(arguments),this.labelChanged(),this.sublabelChanged(),this.onContentChanged(),this.offContentChanged(),this.valueChanged()},reflow:function(){this.$.base.reflow()},barTapped:function(){this.$["switch"].setValue(!this.getValue()),this.doChange(this.$["switch"])},switchToggled:function(){return this.doChange(this.$["switch"]),!0},switchChanged:function(){return!0},labelChanged:function(){this.$.label.setContent(this.label)},sublabelChanged:function(){this.$.sublabel.setContent(this.sublabel)},onContentChanged:function(){this.$["switch"].setOnContent(this.onContent)},offContentChanged:function(){this.$["switch"].setOffContent(this.offContent)},valueChanged:function(){this.$["switch"].setValue(this.value),this.reflow()},getValue:function(){return this.$["switch"].getValue()}});

// Divider.js
enyo.kind({name:"gts.Divider",classes:"gts-Divider",published:{content:"",useFittable:!0},create:function(){this.inherited(arguments),this.useFittableChanged(),this.contentChanged()},reflow:function(){this.$.base.reflow()},useFittableChanged:function(){this.destroyComponents(),this.createComponents([{name:"base",kind:this.useFittable?"enyo.FittableColumns":"enyo.Control",noStretch:!0,classes:"base-bar",components:[{classes:"end-cap bar"},{name:"caption",classes:"caption"},{classes:"bar full",fit:!0}]}],{owner:this})},contentChanged:function(){this.$.caption.setContent(this.content),this.$.caption.applyStyle("display",this.content?"":"none"),this.reflow()}});

// DividerDrawer.js
enyo.kind({name:"gts.DividerDrawer",classes:"gts-DividerDrawer",published:{caption:"",open:!0},events:{onChange:""},components:[{name:"base",kind:"enyo.FittableColumns",noStretch:!0,classes:"base-bar",ontap:"toggleOpen",components:[{classes:"end-cap"},{name:"caption",classes:"caption"},{classes:"bar",fit:!0},{name:"switch",classes:"toggle",value:!1},{classes:"end-cap bar"}]},{name:"client",kind:"onyx.Drawer"}],rendered:function(){this.inherited(arguments),this.captionChanged(),this.openChanged()},reflow:function(){this.$.base.reflow()},openChanged:function(){this.$["switch"].value=this.open,this.$.client.setOpen(this.$["switch"].value),this.$["switch"].addRemoveClass("checked",this.$["switch"].value),this.reflow()},captionChanged:function(){this.$.caption.setContent(this.caption),this.$.caption.applyStyle("display",this.caption?"":"none"),this.reflow()},toggleOpen:function(){return this.open=!this.$["switch"].value,this.$["switch"].value=this.open,this.openChanged(),this.doChange(this,{caption:this.getCaption(),open:this.getOpen()}),!0}});

// SelectedMenu.js
enyo.kind({name:"gts.SelectedMenu",kind:"onyx.Menu",classes:"gts-selectedMenu",published:{choices:[],value:""},events:{onChange:""},components:[],handlers:{onSelect:"selectionChanged"},choicesChanged:function(){this.destroyClientControls(),enyo.isArray(this.choices)&&this.createComponents(this.choices),this.valueChanged(),this.render(),this.reflow()},valueChanged:function(){for(var t,e=this.getClientControls(),i=0;e.length>i;i++)t=e[i].value===this.value,e[i].addRemoveClass("selected",t),e[i].addRemoveClass("normal",!t)},selectionChanged:function(t,e){this.setValue(e.selected.value),this.doChange(e.selected)}});

// InlineNotification.js
enyo.kind({name:"gts.InlineNotification",classes:"inline-notification",content:"",allowHtml:!0,typeOptions:["add","error","info","search","success","success-blue","warning"],published:{type:"error",icon:!0},rendered:function(){this.inherited(arguments),this.typeChanged(),this.iconChanged()},typeChanged:function(){for(var t=0;this.typeOptions.length>t;t++)this.addRemoveClass(this.typeOptions[t],this.typeOptions[t]===this.type)},iconChanged:function(){this.addRemoveClass("no-image",!this.icon)}});

// IntegerPicker.js
enyo.kind({name:"gts.IntegerPicker",kind:"onyx.Picker",classes:"gts-integer-picker",published:{min:1,max:10,step:1,value:null},events:{onChange:""},handlers:{onChange:"selectionChanged"},create:function(){this.inherited(arguments),this.generateValues()},minChanged:function(){this.generateValues()},maxChanged:function(){this.generateValues()},stepChanged:function(){this.generateValues()},generateValues:function(){this.destroyClientControls(),(null==this.value||isNaN(this.value))&&(this.value=this.min);for(var t=[],e=this.min;this.max>=e;)t.push({content:e,active:e==this.value}),e+=this.step;this.createComponents(t,{owner:this}),this.render()},selectionChanged:function(t,e){this.setValue(e.selected.content)}});

// IntegerPickerBar.js
enyo.kind({name:"gts.IntegerPickerBar",kind:"onyx.Item",classes:"gts-integerPickerBar",published:{label:"Pick a value",sublabel:"",min:1,max:10,step:1,value:"",disabled:!1,maxHeight:200,pickerWidth:null},events:{onChange:""},components:[{name:"base",kind:"enyo.FittableColumns",components:[{name:"label",fit:!0},{kind:"onyx.PickerDecorator",components:[{name:"pickerButton",classes:"arrow"},{name:"integer",kind:"gts.IntegerPicker",min:1,max:25,classes:"gts-IntegerPickerBar",onChange:"selectionChanged"}]}]},{name:"sublabel",classes:"sub-label"}],rendered:function(){this.inherited(arguments),this.labelChanged(),this.sublabelChanged(),this.minChanged(),this.maxChanged(),this.stepChanged(),this.valueChanged(),this.disabledChanged(),this.pickerWidthChanged(),this.maxHeightChanged(),enyo.asyncMethod(this,this.reflow)},reflow:function(){enyo.asyncMethod(this,this.waterfallDown,"onresize","onresize",this)},labelChanged:function(){this.$.label.setContent(this.label)},sublabelChanged:function(){this.$.sublabel.setContent(this.sublabel),""===this.sublabel?this.$.sublabel.hide():this.$.sublabel.show()},disabledChanged:function(){this.$.pickerButton.setDisabled(this.disabled)},maxHeightChanged:function(){this.$.integer.setMaxHeight(this.maxHeight)},pickerWidthChanged:function(){this.$.pickerButton.applyStyle("width",this.pickerWidth)},minChanged:function(){this.$.integer.setMin(this.getMin())},maxChanged:function(){this.$.integer.setMax(this.getMax())},stepChanged:function(){this.$.integer.setStep(this.getStep())},valueChanged:function(){this.$.integer.setValue(this.getValue()),this.$.pickerButton.setContent(this.getValue()),this.reflow()},selectionChanged:function(t,e){return this.value=this.$.integer.getValue(),this.$.pickerButton.setContent(this.getValue()),this.reflow(),this.doChange(enyo.mixin(e,{value:this.getValue()})),!0}});

// DatePicker.js
enyo.kind({name:"gts.DatePicker",kind:"enyo.Control",classes:"gts-calendar",published:{value:null,locale:"",disabled:!1,viewDate:null,dowFormat:"medium",monthFormat:"MMMM yyyy"},events:{onSelect:""},components:[{kind:"FittableColumns",components:[{kind:"onyx.Button",content:"<<",ontap:"monthBack"},{name:"monthLabel",tag:"strong",classes:"month-label",fit:!0},{kind:"onyx.Button",content:">>",ontap:"monthForward"}]},{classes:"date-row day-of-week",components:[{name:"sunday",content:"Sun",classes:"week-label"},{name:"monday",content:"Mon",classes:"week-label"},{name:"tuesday",content:"Tue",classes:"week-label"},{name:"wednesday",content:"Wed",classes:"week-label"},{name:"thursday",content:"Thu",classes:"week-label"},{name:"friday",content:"Fri",classes:"week-label"},{name:"saturday",content:"Sat",classes:"week-label"}]},{classes:"date-row",components:[{name:"row0col0",kind:"onyx.Button",ontap:"dateHandler"},{name:"row0col1",kind:"onyx.Button",ontap:"dateHandler"},{name:"row0col2",kind:"onyx.Button",ontap:"dateHandler"},{name:"row0col3",kind:"onyx.Button",ontap:"dateHandler"},{name:"row0col4",kind:"onyx.Button",ontap:"dateHandler"},{name:"row0col5",kind:"onyx.Button",ontap:"dateHandler"},{name:"row0col6",kind:"onyx.Button",ontap:"dateHandler"}]},{classes:"date-row",components:[{name:"row1col0",kind:"onyx.Button",ontap:"dateHandler"},{name:"row1col1",kind:"onyx.Button",ontap:"dateHandler"},{name:"row1col2",kind:"onyx.Button",ontap:"dateHandler"},{name:"row1col3",kind:"onyx.Button",ontap:"dateHandler"},{name:"row1col4",kind:"onyx.Button",ontap:"dateHandler"},{name:"row1col5",kind:"onyx.Button",ontap:"dateHandler"},{name:"row1col6",kind:"onyx.Button",ontap:"dateHandler"}]},{classes:"date-row",components:[{name:"row2col0",kind:"onyx.Button",ontap:"dateHandler"},{name:"row2col1",kind:"onyx.Button",ontap:"dateHandler"},{name:"row2col2",kind:"onyx.Button",ontap:"dateHandler"},{name:"row2col3",kind:"onyx.Button",ontap:"dateHandler"},{name:"row2col4",kind:"onyx.Button",ontap:"dateHandler"},{name:"row2col5",kind:"onyx.Button",ontap:"dateHandler"},{name:"row2col6",kind:"onyx.Button",ontap:"dateHandler"}]},{classes:"date-row",components:[{name:"row3col0",kind:"onyx.Button",ontap:"dateHandler"},{name:"row3col1",kind:"onyx.Button",ontap:"dateHandler"},{name:"row3col2",kind:"onyx.Button",ontap:"dateHandler"},{name:"row3col3",kind:"onyx.Button",ontap:"dateHandler"},{name:"row3col4",kind:"onyx.Button",ontap:"dateHandler"},{name:"row3col5",kind:"onyx.Button",ontap:"dateHandler"},{name:"row3col6",kind:"onyx.Button",ontap:"dateHandler"}]},{classes:"date-row",components:[{name:"row4col0",kind:"onyx.Button",ontap:"dateHandler"},{name:"row4col1",kind:"onyx.Button",ontap:"dateHandler"},{name:"row4col2",kind:"onyx.Button",ontap:"dateHandler"},{name:"row4col3",kind:"onyx.Button",ontap:"dateHandler"},{name:"row4col4",kind:"onyx.Button",ontap:"dateHandler"},{name:"row4col5",kind:"onyx.Button",ontap:"dateHandler"},{name:"row4col6",kind:"onyx.Button",ontap:"dateHandler"}]},{classes:"date-row",components:[{name:"row5col0",kind:"onyx.Button",ontap:"dateHandler"},{name:"row5col1",kind:"onyx.Button",ontap:"dateHandler"},{name:"row5col2",kind:"onyx.Button",ontap:"dateHandler"},{name:"row5col3",kind:"onyx.Button",ontap:"dateHandler"},{name:"row5col4",kind:"onyx.Button",ontap:"dateHandler"},{name:"row5col5",kind:"onyx.Button",ontap:"dateHandler"},{name:"row5col6",kind:"onyx.Button",ontap:"dateHandler"}]},{kind:"FittableColumns",style:"margin-top: 1em;",components:[{name:"client",fit:!0},{kind:"onyx.Button",content:"Today",ontap:"resetDate"}]}],create:function(){this.inherited(arguments),enyo.g11n&&""==this.locale&&(this.locale=enyo.g11n.currentLocale().getLocale()),this.value=this.value||new Date,this.viewDate=this.viewDate||new Date,this.localeChanged()},localeChanged:function(){if(this.days={weekstart:0,"short":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],full:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},enyo.g11n){var t=new enyo.g11n.Fmts({locale:new enyo.g11n.Locale(this.locale)});this.days={weekstart:t.getFirstDayOfWeek(),medium:t.dateTimeHash.medium.day,"long":t.dateTimeHash.long.day}}this.$.sunday.setContent(this.days[this.dowFormat][0]),this.$.monday.setContent(this.days[this.dowFormat][1]),this.$.tuesday.setContent(this.days[this.dowFormat][2]),this.$.wednesday.setContent(this.days[this.dowFormat][3]),this.$.thursday.setContent(this.days[this.dowFormat][4]),this.$.friday.setContent(this.days[this.dowFormat][5]),this.$.saturday.setContent(this.days[this.dowFormat][6])},rendered:function(){this.inherited(arguments),this.renderDoW(),this.valueChanged()},setValue:function(t){enyo.isString(t)&&(t=new Date(t)),this.value=t,this.valueChanged()},valueChanged:function(){("[object Date]"!==Object.prototype.toString.call(this.value)||isNaN(this.value.getTime()))&&(this.value=new Date),this.setViewDate(this.value)},setViewDate:function(t){enyo.isString(t)&&(t=new Date(t)),this.viewDate=t,this.viewDateChanged()},viewDateChanged:function(){this.renderCalendar()},renderDoW:function(){this._renderDoW()},_renderDoW:function(){var t=Math.round(10*this.getBounds().width/7)/10;this.$.sunday.applyStyle("width",t+"px"),this.$.monday.applyStyle("width",t+"px"),this.$.tuesday.applyStyle("width",t+"px"),this.$.wednesday.applyStyle("width",t+"px"),this.$.thursday.applyStyle("width",t+"px"),this.$.friday.applyStyle("width",t+"px"),this.$.saturday.applyStyle("width",t+"px")},renderCalendar:function(){this._renderCalendar()},_renderCalendar:function(){var t=Math.round(10*this.getBounds().width/7)/10,e=new Date;this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth(),1);var i=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth(),0),n=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth(),1);i.setDate(i.getDate()-n.getDay()+1),i.getTime()===n.getTime()&&i.setDate(i.getDate()-7);for(var o,s=0;6>s;)o=i.getDate()===this.value.getDate()&&i.getMonth()===this.value.getMonth()&&i.getFullYear()===this.value.getFullYear()?"onyx-blue":i.getDate()===e.getDate()&&i.getMonth()===e.getMonth()&&i.getFullYear()===e.getFullYear()?"onyx-affirmative":i.getMonth()!==n.getMonth()?"onyx-dark":"",this.$["row"+s+"col"+i.getDay()].applyStyle("width",t+"px"),this.$["row"+s+"col"+i.getDay()].removeClass("onyx-affirmative"),this.$["row"+s+"col"+i.getDay()].removeClass("onyx-blue"),this.$["row"+s+"col"+i.getDay()].removeClass("onyx-dark"),this.$["row"+s+"col"+i.getDay()].addClass(o),this.$["row"+s+"col"+i.getDay()].setContent(i.getDate()),this.$["row"+s+"col"+i.getDay()].ts=i.getTime(),i.setDate(i.getDate()+1),0===i.getDay()&&6>s&&s++;if(enyo.g11n){var a=new enyo.g11n.DateFmt(this.monthFormat);this.$.monthLabel.setContent(a.format(n))}else this.$.monthLabel.setContent(n.getMonth()+" - "+n.getFullYear())},monthBack:function(){this.viewDate.setMonth(this.viewDate.getMonth()-1),this.renderCalendar()},monthForward:function(){this.viewDate.setMonth(this.viewDate.getMonth()+1),this.renderCalendar()},resetDate:function(){this.viewDate=new Date,this.value=new Date,this.renderCalendar(),this.doSelect({date:this.value})},dateHandler:function(t){var e=new Date;e.setTime(t.ts),this.value.setDate(e.getDate()),this.value.setMonth(e.getMonth()),this.value.setFullYear(e.getFullYear()),this.value.getMonth()!=this.viewDate.getMonth()&&(this.viewDate=new Date(this.value.getFullYear(),this.value.getMonth(),1)),this.doSelect({date:this.value}),this.renderCalendar()}});

// TimePicker.js
enyo.kind({name:"gts.TimePicker",kind:"onyx.TimePicker",classes:"gts-timepicker",published:{minuteInterval:5,label:""},initDefaults:function(){this.createComponent({name:"label",classes:"label"},{owner:this}),this.inherited(arguments),this.minuteIntervalChanged(),this.labelChanged()},minuteIntervalChanged:function(){this.$.minutePicker.destroyClientControls();for(var t=Math.floor(this.value.getMinutes()/this.minuteInterval)*this.minuteInterval,e=0;59>=e;e+=this.minuteInterval)this.$.minutePicker.createComponent({content:10>e?"0"+e:e,value:e,active:e==t})},labelChanged:function(){this.$.label.setContent(this.label)}});

// DecimalInput.js
enyo.kind({name:"gts.DecimalInput",kind:"Input",classes:"gts-decimal-input",deleteAction:!1,oldType:"",published:{type:"number",placeholder:"0.00",min:0,max:!1,step:!0,precision:2,atm:!1},handlers:{onkeypress:"filterInput",oninput:"input",onchange:"inputValueChanged",onfocus:"focused",onblur:"blurred"},rendered:function(){this.inherited(arguments),this.minChanged(),this.maxChanged(),this.precisionChanged(),this.blurred()},minChanged:function(){this.setAttribute("min",this.min)},maxChanged:function(){this.max!==!1&&this.setAttribute("max",this.max)},stepChanged:function(){this.precisionChanged()},precisionChanged:function(){if(!this.step)return this.setAttribute("step",null),void 0;var t="0.";if(0>=this.precision)t="1";else{for(var e=0;this.precision-1>e;e++)t+="0";t+="1"}this.setAttribute("step",t)},filterInput:function(t,e){e.keyCode>=48&&57>=e.keyCode||!(46!==e.keyCode||46===e.keyCode&&this.atm)||e.preventDefault()},input:function(){if(this.inherited(arguments),this.atm){var t=this.getValue();t=t.replace(/[^0-9]/g,""),t=t.replace(/^0*/,""),t=parseInt(t)/Math.pow(10,this.precision),isNaN(t)&&(t=0),t=t.toFixed(this.precision),this.setValue(t);var e=this.hasNode();if(e){var i=t.length;enyo.asyncMethod(e,e.setSelectionRange,i,i)}}},inputValueChanged:function(){var t=this.getValueAsNumber();this.max!==!1&&t>this.max?t=this.max:this.min>t&&(t=this.min),this.setValue(t)},focused:function(){"number"===this.oldType&&this.setType(this.oldType),this.selectOnFocus&&!this.atm&&enyo.asyncMethod(this,"selectContents")},blurred:function(){this.oldType=this.type,"number"===this.oldType&&this.setType("text")},getValueAsNumber:function(){var t=this.getValue().replace(/^\s\s*/,"").replace(/\s\s*$/,"").replace(/[^0-9\.]/g,"");return t=parseFloat(t,10).toFixed(this.precision),isNaN(t)&&(t=0),t}});

// ConfirmDialog.js
enyo.kind({name:"gts.ConfirmDialog",kind:"onyx.Popup",classes:"gts-confirm-dialog",baseButtonClasses:"",published:{title:"",message:"",confirmText:"confirm",confirmClass:"onyx-affirmative",cancelText:"cancel",cancelClass:"onyx-negative",centered:!0,floating:!0,modal:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",autoDismiss:!1},events:{onCancel:"",onConfirm:""},components:[{name:"title",classes:"title-wrapper"},{name:"message",classes:"message-wrapper"},{classes:"button-wrapper",components:[{name:"cancelButton",kind:"onyx.Button",ontap:"cancel",showing:!1},{name:"confirmButton",kind:"onyx.Button",ontap:"confirm"}]}],rendered:function(){this.inherited(arguments),this.baseButtonClasses=this.$.confirmButton.getClassAttribute(),this.titleChanged(),this.messageChanged(),this.confirmTextChanged(),this.cancelTextChanged(),this.confirmClassChanged(),this.cancelClassChanged()},titleChanged:function(){this.$.title.setContent(this.title)},messageChanged:function(){this.$.message.setContent(this.message)},confirmTextChanged:function(){this.$.confirmButton.setContent(this.confirmText)},confirmClassChanged:function(){this.$.confirmButton.setClassAttribute(this.baseButtonClasses+" "+this.confirmClass)},cancelTextChanged:function(){this.$.cancelButton.setContent(this.cancelText),0===this.cancelText.length?this.$.cancelButton.hide():this.$.cancelButton.show()},cancelClassChanged:function(){this.$.cancelButton.setClassAttribute(this.baseButtonClasses+" "+this.cancelClass)},cancel:function(t,e){this.doCancel(e),this.hide()},confirm:function(t,e){this.doConfirm(e),this.hide()}});

// ProgressDialog.js
enyo.kind({name:"gts.ProgressDialog",kind:"onyx.Popup",classes:"gts-progress-dialog",published:{title:"",message:"",progress:"",progressBarClasses:"",min:0,max:100,showStripes:!1,animateStripes:!1,animateProgress:!1,cancelText:"",cancelClass:"onyx-negative",centered:!0,floating:!0,modal:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",autoDismiss:!1},events:{onCancel:""},components:[{name:"title",classes:"title-wrapper"},{name:"message",classes:"message-wrapper",allowHtml:!0},{name:"progressBar",kind:"onyx.ProgressBar"},{classes:"button-wrapper",components:[{name:"cancelButton",kind:"onyx.Button",ontap:"cancel",showing:!1}]}],rendered:function(){this.inherited(arguments),this.baseButtonClasses=this.$.cancelButton.getClassAttribute(),this.titleChanged(),this.messageChanged(),this.progressChanged(),this.progressBarClassesChanged(),this.minChanged(),this.maxChanged(),this.showStripesChanged(),this.animateStripesChanged(),this.cancelTextChanged(),this.cancelClassChanged()},show:function(t){this.inherited(arguments);for(property in t){property=property.replace(/\W/g,"");var e="set"+property.charAt(0).toUpperCase()+property.slice(1);enyo.isFunction(this[e])&&this[e](t[property])}},titleChanged:function(){this.$.title.setContent(this.title)},messageChanged:function(){this.$.message.setContent(this.message),0===this.message.length?this.$.message.hide():this.$.message.show()},progressChanged:function(){this.animateProgress?this.$.progressBar.animateProgressTo(this.progress):this.$.progressBar.setProgress(this.progress)},progressBarClassesChanged:function(){this.$.progressBar.setBarClasses(this.progressBarClasses)},minChanged:function(){this.$.progressBar.setMin(this.min)},maxChanged:function(){this.$.progressBar.setMax(this.max)},showStripesChanged:function(){this.$.progressBar.setShowStripes(this.showStripes)},animateStripesChanged:function(){this.$.progressBar.setAnimateStripes(this.animateStripes)},cancelTextChanged:function(){this.$.cancelButton.setContent(this.cancelText),0===this.cancelText.length?this.$.cancelButton.hide():this.$.cancelButton.show()},cancelClassChanged:function(){this.$.cancelButton.setClassAttribute(this.baseButtonClasses+" "+this.cancelClass)},cancel:function(t,e){this.doCancel(e),this.hide()}});

// AutoComplete.js
enyo.kind({name:"gts.AutoComplete",kind:"onyx.InputDecorator",classes:"gts-autocomplete",active:!1,searchValues:[],published:{enabled:!0,values:"",limit:50,delay:200,icon:"assets/search.png",zIndex:!1,allowDirty:!0},events:{onDataRequested:"",onInputChanged:"",onValueSelected:""},components:[{name:"options",kind:"onyx.Menu",floating:!0},{name:"icon",classes:"search-icon"}],handlers:{oninput:"inputChanged",onSelect:"itemSelected"},rendered:function(){this.inherited(arguments),this.enabledChanged(),this.iconChanged(),this.zIndexChanged()},enabledChanged:function(){this.iconChanged()},iconChanged:function(){this.$.icon.applyStyle("background-image",this.icon),this.$.icon.setShowing(this.enabled&&""!=this.icon)},zIndexChanged:function(){this.zIndex!==!1?this.$.options.applyStyle("z-index",this.zIndex):this.$.options.applyStyle("z-index",null)},inputChanged:function(t,e){this.enabled&&(this.inputField=this.inputField||e.originator,enyo.job(null,enyo.bind(this,"fireInputChanged"),this.delay))},fireInputChanged:function(){var t=this.inputField.getValue();return this.doInputChanged({value:this.inputField.getValue()}),0>=t.length?(this.waterfall("onRequestHideMenu",{activator:this}),this.searchValues.slice(0,0),void 0):(this.searchValues.push(t),this.doDataRequested({value:this.inputField.getValue(),limit:this.limit}),void 0)},valuesChanged:function(){var t=this.inputField.getValue(),e=this.searchValues.length;if(!(0>=e||this.searchValues.indexOf(t)!=e-1)){if(this.searchValues.slice(0,0),this.values=this.values.slice(0,this.limit),!this.values||0===this.values.length)return this.waterfall("onRequestHideMenu",{activator:this}),void 0;this.$.options.destroyClientControls();for(var i=[],n=0;this.values.length>n;n++)i.push({content:this.values[n],index:n,allowHtml:!0});this.$.options.createComponents(i),this.$.options.render(),this.waterfall("onRequestShowMenu",{activator:this})}},itemSelected:function(t,e){e.content&&e.content.length>0&&(e.content=this.dirtyString(e.content),this.inputField.setValue(e.content)),this.doValueSelected(enyo.mixin(e,{value:this.inputField.getValue()}))},dirtyString:function(t){if(!this.allowDirty)return t;for(var e=[/&amp;/g,/&quot;/g,/$lt;/g,/&gt;/g,/&rsquo;/g,/&nbsp;/g],i=["&",'"',"<",">","'"," "],n=0;i.length>n;n++)t=t.replace(e[n],i[n]);return t}});

// Item.js
enyo.kind({name:"gts.Item",kind:"onyx.Item",classes:"gts-item",published:{holdHighlight:!1,tapHighlight:!0,tapClass:"gts-pulse",highlightClass:"onyx-highlight"},preventTapDisplayTimer:0,handlers:{ontap:"startTap",onhold:"hold",onrelease:"release"},startTap:function(t,e){return this.preventTapDisplayTimer>=(new Date).getTime()-50?!0:(this.tapHighlight&&(onyx.Item.addRemoveFlyweightClass(this.controlParent||this,this.tapClass,!0,e),enyo.job("endTap",enyo.bind(this,this.endTap,t,e),250)),void 0)},endTap:function(t,e){this.tapHighlight&&onyx.Item.addRemoveFlyweightClass(this.controlParent||this,this.tapClass,!1,e)},hold:function(t,e){this.holdHighlight&&onyx.Item.addRemoveFlyweightClass(this.controlParent||this,this.highlightClass,!0,e)},release:function(t,e){this.preventTapDisplayTimer=(new Date).getTime(),this.holdHighlight&&onyx.Item.addRemoveFlyweightClass(this.controlParent||this,this.highlightClass,!1,e)}});

// EventMenu.js
enyo.kind({name:"gts.EventMenu",kind:"onyx.Menu",adjustPosition:function(){},showingChanged:function(){this.inherited(arguments),this.updatePosition()},resizeHandler:function(){this.inherited(arguments),this.updatePosition()}});

// MenuImageItem.js
enyo.kind({name:"gts.MenuImageItem",kind:"onyx.MenuItem",classes:"gts-menuimageitem",published:{content:"",src:""},components:[{name:"icon",kind:"onyx.IconButton",src:"",classes:"gts-mii-icon"},{name:"text",content:"",classes:"gts-mii-text"}],create:function(){this.inherited(arguments),this.contentChanged(),this.srcChanged()},contentChanged:function(){this.$.text.setContent(this.content)},srcChanged:function(){this.$.icon.setSrc(this.src);var t=this.src.length>0;this.$.icon.setShowing(t),this.addRemoveClass("has-icon",t)}});

// private.js
enyo.kind({name:"private.gapi",kind:"enyo.Component",apiKey:"AIzaSyBOKT9NrmlBVx4RFPk2p3c5ee5cHMvs8Lc",installedClientId:"933238428058.apps.googleusercontent.com",installedClientSecret:"AmttUjVelS_L4X46GCltvF94",clientId:"933238428058-smvr0gsdpbpiuo2q59gcll54rau9ivus.apps.googleusercontent.com",clientSecret:"mqgBXW7pTj1kUvpGswmD7miK",getApiKey:function(){return this.apiKey},getClientId:function(){return window.device&&(enyo.platform.android||enyo.platform.androidChrome)?this.installedClientId:this.clientId},getClientSecret:function(){return window.device&&(enyo.platform.android||enyo.platform.androidChrome)?this.installedClientSecret:this.clientSecret}});

// checkbook.js
enyo.kind({name:"Checkbook.app",kind:"enyo.Control",appReady:!1,paneStack:[],components:[{name:"mainViews",kind:"Panels",classes:"enyo-fit app-panels",showing:!1,fit:!0,animate:!1,draggable:!1,arrangerKind:"CollapsingArranger",components:[{name:"destroyChild",content:"I am a dummy component so the panel structure doesn't crash on load."}]},{name:"splash",kind:"Checkbook.splash",onFinish:"splashFinisher"},{name:"about",kind:"Checkbook.about",onFinish:"closePopup"},{name:"criticalError",kind:"Checkbook.systemError",errTitle:"~|p2t|~",errMessage:"",errMessage2:"~|mt|~",onFinish:"closePopup"},{name:"security",kind:"Checkbook.login"},{name:"appMenu",kind:"Checkbook.appmenu"},{kind:"Signals",ondeviceready:"deviceReady",webworksready:"deviceReady",onbackbutton:"backHandler",onmenubutton:"menuHandler",onsearchbutton:"searchHandler",onkeydown:"keyboardHandler",viewAccount:"viewAccount",resetSystem:"resetSystem",showBudget:"openBudget",showSearch:"openSearch",showReport:"openReport",showPanePopup:"showPanePopup",showPopup:"showPopup"}],rendered:function(){this.inherited(arguments),this.$.splash.getStartupContainer()&&this.$.splash.show()},keyboardHandler:function(t,e){return this.appReady?18===e.which?(enyo.Signals.send("onmenubutton"),!0):27===e.which?(enyo.Signals.send("onbackbutton"),!0):void 0:void 0},menuHandler:function(t,e){return this.appReady?(e=enyo.mixin({pageX:10,pageY:10},e),0>=this.paneStack.length&&(this.$.appMenu.getShowing()?this.hideAppMenu():this.showAppMenu(t,e)),!0):void 0},showAppMenu:function(t,e){this.$.appMenu.showAtEvent(e)},hideAppMenu:function(){this.$.appMenu.hide()},backHandler:function(){return this.appReady?(this.$.appMenu.getShowing()?this.hideAppMenu():this.paneStack.length>0?this.$[this.paneStack[this.paneStack.length-1]].doFinish():this.$.mainViews.getIndex()>0?this.$.mainViews.previous():enyo.platform.android||enyo.platform.androidChrome?this.$.exitConfirmation?this.exitConfirmationHandler():(this.createComponent({name:"exitConfirmation",kind:"gts.ConfirmDialog",title:"Exit Checkbook",message:"Are you sure you want to close Checkbook?",confirmText:"Yes",cancelText:"No",modal:!1,onConfirm:"exitConfirmationHandler",onCancel:"exitConfirmationClose"}),this.$.exitConfirmation.show()):this.log("backHandler: no action possible"),!0):void 0},exitConfirmationClose:function(){this.$.exitConfirmation.hide(),this.$.exitConfirmation.destroy()},exitConfirmationHandler:function(){this.exitConfirmationClose(),navigator.app.exitApp()},searchHandler:function(){return this.appReady?(this.log("NYI"),!0):void 0},splashFinisher:function(){this.$.splash.getStartupContainer()&&(this.$.splash.onFinish=""),this.notificationType=!this.$.splash.getFirstRun(),Checkbook.globals.security=this.$.security,0!=Checkbook.globals.prefs.useCode?Checkbook.globals.security.authUser("Main Program PIN Code",Checkbook.globals.prefs.code,{onSuccess:enyo.bind(this,this.loadCheckbook),onFailure:enyo.bind(this,this.appAuthFailure)}):this.loadCheckbook()},appAuthFailure:function(){this.log("App Auth Failure"),window.close()},loadCheckbook:function(){this.$.destroyChild.destroy(),this.$.mainViews.createComponents([{name:"accounts",kind:"Checkbook.accounts.view"},{name:"transactions",kind:"Checkbook.transactions.view"}],{owner:this}),this.$.mainViews.show(),this.$.mainViews.render(),Checkbook.globals.criticalError=this.$.criticalError,Checkbook.transactions.recurrence.manager.updateSeriesTransactions(-1,{onSuccess:enyo.bind(this,this.loadCheckbookStage2)})},loadCheckbookStage2:function(){this.$.splash.getStartupContainer()&&this.$.splash.$.message.setContent("Loading account information..."),Checkbook.accounts.manager.fetchDefaultAccount({onSuccess:enyo.bind(this,this.loadCheckbookStage3)})},loadCheckbookStage3:function(t){if(t&&(1===t.acctLocked?Checkbook.globals.security.authUser(t.acctName+" "+"PIN Code",t.lockedCode,{onSuccess:function(){enyo.Signals.send("viewAccount",{account:t})}}):enyo.Signals.send("viewAccount",{account:t})),enyo.Signals.send("accountChanged"),this.notificationType===!0&&1==Checkbook.globals.prefs.updateCheckNotification);else if(this.notificationType===!1){var e=enyo.fetchAppInfo();Checkbook.globals.criticalError.load("Welcome to "+e.title,"If you have any questions, email <a href='mailto:"+e.vendoremail+"?subject="+e.title+" Support'>"+e.vendoremail+"</a>.","","assets/icon_1_32x32.png"),enyo.asyncMethod(Checkbook.globals.criticalError,Checkbook.globals.criticalError.set,"~|p2t|~","","~|mt|~","assets/status_icons/warning.png")}this.appReady=!0,this.$.splash.getStartupContainer()&&(this.$.splash.setStartupContainer(!1),this.$.splash.hide())},resetSystem:function(){this.$.transactions.unloadSystem(),Checkbook.accounts.manager.updateAccountModTime(),this.notificationType=null,enyo.asyncMethod(this,this.loadCheckbookStage2)},showPopup:function(t,e){this.$[t.popup]?this.$[t.popup].show():this.$[e.popup]&&this.$[e.popup].show()},closePopup:function(t){t.hide()},errorReport:function(){console.log("ERROR REPORT SYSTEM GO")},showPanePopup:function(t,e){this.$.splash.show(),enyo.asyncMethod(this,this._showPanePopup,e)},_showPanePopup:function(t){var e=enyo.mixin(t,{name:enyo.isString(t.name)?t.name:"panePopup",flex:1,onFinish:"hidePanePopup",onFinishFollower:enyo.isFunction(t.onFinish)?t.onFinish:null});this.createComponent(e),this.$[e.name].render(),this.$.mainViews.hide();for(var i=0;this.paneStack.length>i;i++)this.$[this.paneStack[i]].hide();return this.$[e.name].show(),this.paneStack.push(e.name),enyo.asyncMethod(this.$.splash,this.$.splash.hide),!0},hidePanePopup:function(t){this.$.splash.show(),enyo.isFunction(t.onFinishFollower)&&t.onFinishFollower.apply(null,arguments),enyo.asyncMethod(this,this._hidePanePopup,t)},_hidePanePopup:function(t){this.paneStack.splice(this.paneStack.indexOf(t.name),1),t.destroy();var e=this.paneStack.length;e>0?this.$[this.paneStack[e-1]].show():this.$.mainViews.show(),this.resized(),enyo.asyncMethod(this.$.splash,this.$.splash.hide)},viewAccount:function(){this.$.splash.show(),enyo.Panels.isScreenNarrow()&&this.$.mainViews.setIndex(1),enyo.asyncMethod(this.$.splash,this.$.splash.hide)},openSearch:function(t,e){this.showPanePopup(null,enyo.mixin(e,{name:"search",kind:"Checkbook.search.pane",onFinish:enyo.bind(this,this.closeSearch)}))},closeSearch:function(t,e){e.changes&&this.resetSystem()},openBudget:function(t,e){this.showPanePopup(null,enyo.mixin({name:"budget",kind:"Checkbook.budget.view"},e))},openReport:function(t,e){this.log("Report",arguments)}});

// menu.js
enyo.kind({name:"Checkbook.appmenu",kind:"gts.EventMenu",openOnTop:!0,floating:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",components:[{content:"Preferences",ontap:"openPreferences"},{classes:"onyx-menu-divider"},{showing:!1,content:"Sync",ontap:"openSync"},{content:"Import",ontap:"openImport"},{content:"Export",ontap:"openExport"},{classes:"onyx-menu-divider"},{showing:!1,content:"Search",ontap:"openSearch"},{content:"Budget",ontap:"openBudget"},{showing:!1,content:"Reports (NYI)",ontap:"openReport"},{showing:!1,classes:"onyx-menu-divider"},{showing:!1,content:"Report Bug (NYI)",ontap:"errorReport"},{classes:"onyx-menu-divider"},{content:"About",ontap:"openAbout"}],openAbout:function(){enyo.Signals.send("showPopup",{popup:"about"})},errorReport:function(){console.log("ERROR REPORT SYSTEM GO")},openPreferences:function(){enyo.Signals.send("showPanePopup",{name:"preferences",kind:"Checkbook.preferences"})},openSync:function(){enyo.Signals.send("showPanePopup",{name:"sync",kind:"Checkbook.sync.main",onFinish:enyo.bind(this,this.syncComplete)})},syncComplete:function(t,e){e.success===!0&&enyo.Signals.send("resetSystem",{})},openImport:function(){enyo.Signals.send("showPanePopup",{name:"import",kind:"Checkbook.sync.import",onFinish:enyo.bind(this,this.importComplete)})},importComplete:function(t,e){e.success===!0&&enyo.Signals.send("resetSystem",{})},openExport:function(){enyo.Signals.send("showPanePopup",{name:"export",kind:"Checkbook.sync.export"})},openSearch:function(){enyo.Signals.send("showSearch",{})},openBudget:function(){enyo.Signals.send("showBudget",{})},openReport:function(){enyo.Signals.send("showReport",{})}});

// splash.js
enyo.kind({name:"Checkbook.splash",kind:"onyx.Popup",centered:!0,floating:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",autoDismiss:!1,published:{firstRun:!1,startupContainer:!0},events:{onFinish:""},components:[{name:"headerWrapper",kind:"onyx.Toolbar",noStretch:!0,classes:"transparent",components:[{name:"spinner",kind:"onyx.Spinner",classes:"size-half",style:"margin: 0 5px 0 0;"},{name:"icon",kind:"Image",src:"assets/status_icons/warning.png",style:"margin-right: 5px;",showing:!1},{name:"title",classes:"bold"}]},{name:"startupContainer",classes:"padding-std light",components:[{name:"message",classes:"smaller margin-half-bottom margin-half-top",allowHtml:!0},{name:"splashProgress",kind:"onyx.ProgressBar",minimum:0,maximum:100,position:0}]}],handlers:{onShow:"buildHeader"},constructor:function(){this.inherited(arguments),this._binds={splashCrash:enyo.bind(this,this.splashCrash),checkDB:enyo.bind(this,this.checkDB)},this.firstRun=!1},startupContainerChanged:function(){this.startupContainer?(this.$.startupContainer.show(),this.$.title.setContent("Loading Checkbook")):(this.$.startupContainer.hide(),this.$.title.setContent("Loading")),this.reflow()},buildHeader:function(){this.startupContainer&&(this.$.spinner.show(),this.checkSystem(),this.reflow())},checkSystem:function(){this.$.title.setContent("Loading Checkbook"),this.$.message.setContent("Preparing application."),this.$.splashProgress.animateProgressTo(5),Checkbook.globals||(Checkbook.globals={}),Checkbook.globals.prefs||(Checkbook.globals.prefs={},this.log("creating prefs")),Checkbook.globals.gts_db||(Checkbook.globals.gts_db=new gts.database(getDBArgs()),this.log("Checkbook.globals.gts_db v"+Checkbook.globals.gts_db.getVersion()+" created.")),this.checkDB()},checkDB:function(){this.log(),this.$.message.setContent("Checking database version..."),this.$.splashProgress.animateProgressTo(10),Checkbook.globals.gts_db.query("SELECT * FROM prefs LIMIT 1;",{onSuccess:enyo.bind(this,this.checkDBSuccess),onError:enyo.bind(this,this.buildInitialDB)})},checkDBSuccess:function(t){var e=-1;t.length>0&&t[0].dbVer&&"undefined"!==t[0].dbVer&&(e=t[0].dbVer);var n=31;e==n?(this.$.splashProgress.animateProgressTo(75),this.log("DB up to date, preparing to return"),Checkbook.globals.prefs.version=e,Checkbook.globals.prefs.useCode=t[0].useCode,Checkbook.globals.prefs.code=t[0].code,Checkbook.globals.prefs.transPreview=t[0].previewTransaction,Checkbook.globals.prefs.updateCheck=t[0].updateCheck,Checkbook.globals.prefs.updateCheckNotification=t[0].updateCheckNotification,Checkbook.globals.prefs.errorReporting=t[0].errorReporting,Checkbook.globals.prefs.dispColor=t[0].dispColor,Checkbook.globals.prefs.bsSave=t[0].bsSave,Checkbook.globals.prefs.alwaysFullCalendar=t[0].alwaysFullCalendar,Checkbook.globals.prefs.seriesCountLimit=t[0].seriesCountLimit,Checkbook.globals.prefs.seriesDayLimit=t[0].seriesDayLimit,Checkbook.globals.prefs.custom_sort=t[0].custom_sort,this.$.message.setContent("Updating transaction data..."),this.$.splashProgress.animateProgressTo(85),enyo.asyncMethod(this,this.doFinish)):e>=1?(n>=26&&30>=n&&(gts.Object.isUndefined(t[0].alwaysFullCalendar)||gts.Object.isUndefined(t[0].seriesCountLimit))&&(e=26),this.log("DB out of date, preparing to update: "+e+" to "+n),this.updateDBStructure(e)):(this.log("DB does not exist, preparing to create"),this.buildInitialDB())},buildInitialDB:function(){this.log(),this.firstRun=!0,this.$.message.setContent("Creating application database..."),this.$.splashProgress.animateProgressTo(50);for(var t=("0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz"+(new Date).getTime()).split(""),e=Math.floor(Math.random()*t.length)+5,n="",i=0;e>i;i++)n+=t[Math.floor(Math.random()*t.length)];var o=[Checkbook.globals.gts_db.getDropTable("accounts"),Checkbook.globals.gts_db.getDropTable("accountCategories"),Checkbook.globals.gts_db.getDropTable("acctTrsnSortOptn"),Checkbook.globals.gts_db.getDropTable("budgets"),Checkbook.globals.gts_db.getDropTable("transactions"),Checkbook.globals.gts_db.getDropTable("expenseCategories"),Checkbook.globals.gts_db.getDropTable("transactionSplit"),Checkbook.globals.gts_db.getDropTable("repeats"),Checkbook.globals.gts_db.getDropTable("prefs"),{table:"accounts",columns:[{column:"acctId",type:"INTEGER",constraints:["UNIQUE","PRIMARY KEY ASC"]},{column:"acctName",type:"TEXT"},{column:"acctNotes",type:"TEXT"},{column:"acctCategory",type:"TEXT"},{column:"sort",type:"INTEGER NOT NULL DEFAULT 1"},{column:"defaultAccount",type:"INTEGER NOT NULL DEFAULT 0"},{column:"frozen",type:"INTEGER NOT NULL DEFAULT 0"},{column:"hidden",type:"INTEGER NOT NULL DEFAULT 0"},{column:"acctLocked",type:"INTEGER NOT NULL DEFAULT 0"},{column:"lockedCode",type:"TEXT"},{column:"transDescMultiLine",type:"INTEGER NOT NULL DEFAULT 1"},{column:"showTransTime",type:"INTEGER NOT NULL DEFAULT 1"},{column:"useAutoComplete",type:"INTEGER NOT NULL DEFAULT 1"},{column:"atmEntry",type:"INTEGER NOT NULL DEFAULT 1"},{column:"bal_view",type:"INTEGER NOT NULL DEFAULT 0"},{column:"runningBalance",type:"INTEGER NOT NULL DEFAULT 0"},{column:"checkField",type:"INTEGER NOT NULL DEFAULT 0"},{column:"hideNotes",type:"INTEGER NOT NULL DEFAULT 0"},{column:"enableCategories",type:"INTEGER NOT NULL DEFAULT 1"},{column:"sect_order",type:"INTEGER NOT NULL DEFAULT 0"},{column:"hide_cleared",type:"INTEGER NOT NULL DEFAULT 0"},{column:"last_sync",type:"TEXT"},{column:"auto_savings",type:"INTEGER NOT NULL DEFAULT 0"},{column:"auto_savings_link",type:"INTEGER NOT NULL DEFAULT -1"}],data:[]},{table:"accountCategories",columns:[{column:"name",type:"TEXT"},{column:"catOrder",type:"INTEGER NOT NULL DEFAULT 0"},{column:"icon",type:"TEXT"},{column:"color",type:' NOT NULL DEFAULT "green"'},{column:"view_status",type:"INTEGER NOT NULL DEFAULT 1"},{column:"last_sync",type:"TEXT"}],data:defaultAccountCategories},{table:"acctTrsnSortOptn",columns:[{column:"sortId",type:"INTEGER",constraints:["UNIQUE","PRIMARY KEY ASC"]},{column:"label",type:"TEXT"},{column:"sortGroup",type:"TEXT"},{column:"groupOrder",type:"INTEGER NOT NULL DEFAULT 0"},{column:"desc",type:"TEXT"},{column:"qry",type:"TEXT"}],data:defaultAcctTrsnSortOptn},{table:"transactions",columns:[{column:"itemId",type:"INTEGER",constraints:["UNIQUE","PRIMARY KEY ASC"]},{column:"account",type:"INTEGER",constraints:["REFERENCES accounts( acctId )","ON UPDATE CASCADE","ON DELETE CASCADE"]},{column:"linkedRecord",type:"INTEGER"},{column:"linkedAccount",type:"INTEGER",constraints:["REFERENCES accounts( acctId )","ON UPDATE CASCADE","ON DELETE SET NULL"]},{column:"desc",type:"TEXT"},{column:"amount",type:"NUMERIC"},{column:"note",type:"TEXT"},{column:"date",type:"TEXT"},{column:"category",type:"TEXT"},{column:"category2",type:"TEXT"},{column:"cleared",type:"INTEGER NOT NULL DEFAULT 0"},{column:"checkNum",type:"TEXT"},{column:"atSource",type:"INTEGER"},{column:"last_sync",type:"TEXT"},{column:"repeatId",type:"INTEGER",constraints:["REFERENCES repeats( repeatId )","ON UPDATE CASCADE","ON DELETE SET NULL","DEFERRABLE INITIALLY DEFERRED"]},{column:"repeatUnlinked",type:"INTEGER NOT NULL DEFAULT 0"}],data:[]},{table:"transactionCategories",columns:[{column:"catId",type:"INTEGER",constraints:["UNIQUE","PRIMARY KEY ASC"]},{column:"genCat",type:"TEXT"},{column:"specCat",type:"TEXT"},{column:"last_sync",type:"TEXT"}],data:defaultExpenseCategories},{table:"transactionSplit",columns:[{column:"tsId",type:"INTEGER",constraints:["UNIQUE","PRIMARY KEY ASC"]},{column:"transId",type:"INTEGER",constraints:["REFERENCES transactions( itemId )","ON UPDATE CASCADE","ON DELETE CASCADE","DEFERRABLE INITIALLY DEFERRED"]},{column:"genCat",type:"TEXT"},{column:"specCat",type:"TEXT"},{column:"amount",type:"NUMERIC"},{column:"last_sync",type:"TEXT"}],data:[]},{table:"repeats",columns:[{column:"repeatId",type:"INTEGER PRIMARY KEY ASC"},{column:"frequency",type:"TEXT"},{column:"daysOfWeek",type:"TEXT"},{column:"itemSpan",type:"INTEGER"},{column:"endingCondition",type:"TEXT"},{column:"endDate",type:"TEXT"},{column:"endCount",type:"INTEGER"},{column:"currCout",type:"INTEGER"},{column:"origDate",type:"TEXT"},{column:"lastOccurance",type:"TEXT"},{column:"last_sync",type:"TEXT"},{column:"desc",type:"TEXT"},{column:"amount",type:"NUMERIC"},{column:"note",type:"TEXT"},{column:"category",type:"TEXT"},{column:"acctId",type:"INTEGER",constraints:["REFERENCES accounts( acctId )","ON UPDATE CASCADE","ON DELETE CASCADE"]},{column:"linkedAcctId",type:"INTEGER",constraints:["REFERENCES accounts( acctId )","ON UPDATE CASCADE","ON DELETE SET NULL"]},{column:"autoTrsnLink",type:"INTEGER"}],data:[]},{table:"budgets",columns:[{column:"budgetId",type:"INTEGER",constraints:["UNIQUE","PRIMARY KEY ASC"]},{column:"category",type:"TEXT"},{column:"spending_limit",type:"NUMERIC"},{column:"span",type:"INTEGER"},{column:"rollOver",type:"INTEGER"},{column:"budgetOrder",type:"INTEGER"}],data:[]},{table:"prefs",columns:[{column:"dbVer",type:"INTEGER"},{column:"useCode",type:"INTEGER"},{column:"code",type:"TEXT"},{column:"saveGSheetsData",type:"INTEGER"},{column:"gSheetUser",type:"TEXT"},{column:"gSheetPass",type:"TEXT"},{column:"repeatUpdate",type:"TEXT"},{column:"updateCheck",type:"TEXT"},{column:"synergyAcctId",type:"TEXT"},{column:"synergyCalId",type:"TEXT"},{column:"updateCheckNotification",type:"INTEGER NOT NULL DEFAULT 1"},{column:"dispColor",type:"INTEGER NOT NULL DEFAULT 1"},{column:"bsSave",type:"INTEGER NOT NULL DEFAULT 1"},{column:"custom_sort",type:"INTEGER NOT NULL DEFAULT 0"},{column:"gts_name",type:"TEXT"},{column:"gts_pass",type:"TEXT"},{column:"gts_last_connection",type:"TEXT"},{column:"spike",type:"TEXT"},{column:"errorReporting",type:"INTEGER NOT NULL DEFAULT 1"}],data:[{dbVer:19,useCode:0,saveGSheetsData:0,spike:n}]}];Checkbook.globals.gts_db.setSchema(o,{onSuccess:this._binds.checkDB,onError:this._binds.splashCrash})},updateDBStructure:function(t){this.log(t),this.$.message.setContent("Updating database..."),this.$.splashProgress.animateProgressTo(50),t=parseInt(t);var e=t,n=[],i={onSuccess:this._binds.checkDB,onError:this._binds.splashCrash};switch(t){case 15:n.push("ALTER TABLE accounts ADD COLUMN auto_savings INTEGER NOT NULL DEFAULT 0;"),n.push("ALTER TABLE accounts ADD COLUMN auto_savings_link INTEGER NOT NULL DEFAULT 0;"),n.push("DROP TABLE IF EXISTS repeats;"),n.push("CREATE TABLE repeats( repeatId INTEGER PRIMARY KEY ASC, frequency TEXT, daysOfWeek TEXT, itemSpan INTEGER, endingCondition TEXT, endDate TEXT, endCount INTEGER, currCout INTEGER, origDate TEXT, lastOccurance TEXT, desc TEXT, amount REAL, note TEXT, category TEXT, acctId INTEGER, linkedAcctId INTEGER );");case 16:n.push("ALTER TABLE expenses ADD COLUMN repeatUnlinked INTEGER NOT NULL DEFAULT 0;"),e=17;case 17:n.push("ALTER TABLE prefs ADD COLUMN errorReporting INTEGER NOT NULL DEFAULT 1;"),n.push("ALTER TABLE expenses ADD COLUMN atSource INTEGER;"),n.push("UPDATE accounts SET auto_savings_link = -1;"),e=18;case 18:n.push("ALTER TABLE expenses RENAME TO transactions;"),n.push("ALTER TABLE expenseCategories RENAME TO transactionCategories;"),n.push("DROP TABLE IF EXISTS transactionSplit;"),n.push("CREATE TABLE transactionSplit( transId INTEGER, genCat TEXT, specCat TEXT, amount REAL, last_sync TEXT );"),n.push("ALTER TABLE transactions ADD COLUMN category2 TEXT;"),e=19;case 19:n.push("ALTER TABLE prefs ADD COLUMN previewTransaction INTEGER NOT NULL DEFAULT 1;"),e=20;case 20:n.push("ALTER TABLE budgets ADD COLUMN category2 TEXT;"),e=21;case 21:n.push(Checkbook.globals.gts_db.getUpdate("acctTrsnSortOptn",{qry:"IFNULL( NULLIF( checkNum, '' ), ( SELECT IFNULL( MAX( checkNum ), 0 ) FROM transactions LIMIT 1 ) ) ASC, itemId ASC"},{sortId:9})),e=22;case 22:n.push("DROP TABLE IF EXISTS repeats;"),n.push("CREATE TABLE repeats( repeatId INTEGER PRIMARY KEY ASC, frequency TEXT, daysOfWeek TEXT, itemSpan INTEGER, endingCondition TEXT, endDate TEXT, endCount INTEGER, currCount INTEGER, origDate TEXT, lastOccurrence TEXT, rep_desc TEXT, rep_amount REAL, rep_note TEXT, rep_category TEXT, rep_acctId INTEGER, rep_linkedAcctId INTEGER, rep_autoTrsnLink INTEGER, lastUpdated TEXT, last_sync TEXT );"),e=23;case 23:n.push(Checkbook.globals.gts_db.getUpdate("accounts",{acctLocked:0,lockedCode:""},{})),n.push(Checkbook.globals.gts_db.getUpdate("prefs",{useCode:0,code:"",saveGSheetsData:0,gSheetUser:"depreciated",gSheetPass:""},{})),e=24;case 24:n.push("ALTER TABLE accounts ADD COLUMN payeeField INTEGER NOT NULL DEFAULT 0;"),n.push("ALTER TABLE transactions ADD COLUMN payee TEXT;"),e=25;case 25:n.push("ALTER TABLE transactions RENAME TO expenses;"),n.push("ALTER TABLE transactionCategories RENAME TO expenseCategories;"),e=26;case 26:n.push("ALTER TABLE expenses RENAME TO transactions;"),n.push("ALTER TABLE expenseCategories RENAME TO transactionCategories;"),e=27;case 27:n.push("ALTER TABLE prefs ADD COLUMN alwaysFullCalendar INTEGER NOT NULL DEFAULT 0;"),e=28;case 28:n.push("ALTER TABLE repeats ADD COLUMN terminated INTEGER NOT NULL DEFAULT 0;"),n.push("ALTER TABLE repeats ADD COLUMN rep_autoTrsnLinkAcct INTEGER;"),e=29;case 29:n.push("ALTER TABLE prefs ADD COLUMN seriesCountLimit INTEGER NOT NULL DEFAULT 3;"),n.push("ALTER TABLE prefs ADD COLUMN seriesDayLimit INTEGER NOT NULL DEFAULT 45;"),e=30;case 30:e=31;case 31:}n.push(Checkbook.globals.gts_db.getUpdate("prefs",{dbVer:e},{})),Checkbook.globals.gts_db.queries(n,i)},splashCrash:function(t){this.error(arguments),this.$.splashProgress.hide(),this.$.spinner.hide(),this.$.icon.show(),this.$.title.setContent("Checkbook Load Error"),this.$.message.setContent("Checkbook has failed to load.<br />Please contact <a href='mailto:glitchtechscience@gmail.com'>GlitchTech Science</a> for assistant with the following error:<br /><br />Code: "+t.code+"<br />"+"Message: "+t.message)}});

// preferences.js
enyo.kind({name:"Checkbook.preferences",kind:"FittableRows",classes:"enyo-fit",style:"height: 100%;",systemReady:!1,events:{onFinish:""},components:[{name:"header",kind:"onyx.Toolbar",classes:"text-center text-middle",style:"position: relative;",components:[{kind:"enyo.Image",src:"assets/dollar_sign_1.png",classes:"img-icon margin-half-right"},{content:"Preferences",classes:"bigger"},{kind:"onyx.Button",ontap:"doFinish",content:"x",classes:"onyx-negative",style:"position: absolute; right: 15px;"}]},{kind:"enyo.Scroller",horizontal:"hidden",classes:"tardis-blue-gradient",fit:!0,components:[{classes:"light narrow-column padding-half-top padding-half-bottom",style:"min-height: 100%;",components:[{kind:"onyx.Groupbox",components:[{kind:"onyx.GroupboxHeader",content:"Program Security"},{name:"pinLock",kind:"gts.ToggleBar",label:"PIN Lock",onContent:"Yes",offContent:"No",onChange:"togglePINStatus"},{name:"pinLockDrawer",kind:"onyx.Drawer",open:!1,components:[{kind:"onyx.Groupbox",classes:"padding-half-top",ontap:"changeAppPin",components:[{kind:"onyx.InputDecorator",layoutKind:"FittableColumnsLayout",components:[{name:"pinCode",kind:"onyx.Input",type:"password",placeholder:"Tap to set...",disabled:!0,fit:!0},{content:"Code",classes:"label"}]}]}]}]},{kind:"onyx.Groupbox",classes:"margin-top",components:[{kind:"onyx.GroupboxHeader",content:"General Options"},{name:"transPreview",kind:"gts.ToggleBar",label:"Transaction Preview",sublabel:"Show preview of a tapped transaction.",onContent:"Yes",offContent:"No",onChange:"updateTransPreview"},{name:"dispColor",kind:"gts.ToggleBar",label:"Account Colors",sublabel:"Add color in some areas based on account categories.",onContent:"Yes",offContent:"No",onChange:"updateDispColor"},{name:"alwaysFullCalendar",kind:"gts.ToggleBar",label:"Full Calendar",sublabel:"Set modify transaction system to always use a full calendar instead of a date picker for small screens.",onContent:"Yes",offContent:"No",onChange:"updateAlwaysFullCalendar"},{name:"updateNotice",kind:"gts.ToggleBar",label:"System Notifications",sublabel:"Recieve in-app notices of updates and other important news.",onContent:"Yes",offContent:"No",onChange:"updateUpdateNotice"},{name:"errorReporting",kind:"gts.ToggleBar",label:"Error Reporting",sublabel:"Report errors to GlitchTech Science",onContent:"Yes",offContent:"No",onChange:"updateErrorReporting"},{showing:!1,content:"backswipe save (function cannot not used on touchpad)"}]},{kind:"onyx.Groupbox",classes:"margin-top",components:[{kind:"onyx.GroupboxHeader",content:"Accounts"},{name:"defaultAccount",kind:"gts.SelectorBar",disabled:!0,label:"Default Account",onChange:"updateDefaultAccount",value:0,choices:[]},{kind:"onyx.Item",components:[{name:"addAccountButton",kind:"onyx.Button",toggling:!0,content:"Add Account",classes:"full-width",ontap:"addAccount"}]}]},{kind:"onyx.Groupbox",classes:"margin-top",components:[{kind:"onyx.GroupboxHeader",content:"Recurrence Options"},{name:"seriesCountLimit",kind:"gts.IntegerPickerBar",min:1,max:15,label:"Series Occurrence Limit",sublabel:"Maximum number of times an event will be created within the date limit.",onChange:"updateSeriesCountLimit"},{name:"seriesDayLimit",kind:"gts.IntegerPickerBar",min:5,max:150,step:5,label:"Series Day Limit",sublabel:"Maximum number of days from today a recurrence event will be created..",onChange:"updateSeriesDayLimit"}]},{kind:"onyx.Groupbox",classes:"margin-top",components:[{kind:"onyx.GroupboxHeader",content:"Categories & Suggestions"},{kind:"onyx.Item",components:[{name:"editAccountCategories",kind:"onyx.Button",content:"Edit Account Categories",classes:"full-width",ontap:"modifyAccountCategories"}]},{kind:"onyx.Item",components:[{name:"editTransactionCategories",kind:"onyx.Button",content:"Edit Transaction Categories",classes:"full-width",ontap:"modifyTransactionCategories"}]},{showing:!1,kind:"onyx.Item",components:[{name:"editAutoCompleteSettings",kind:"onyx.Button",content:"Auto-Complete Settings",classes:"full-width",ontap:"modifyAutoCompleteSettings"}]}]},{kind:"onyx.Button",content:"Full Wipe",classes:"onyx-negative margin-top full-width",ontap:"fullwipe"}]}]},{showing:!1,kind:"onyx.Toolbar",classes:"text-center",components:[{kind:"onyx.Button",content:"Done",ontap:"doFinish"}]},{name:"cryptoSystem",kind:"Checkbook.encryption"}],rendered:function(){this.$.pinLock.setValue(1===Checkbook.globals.prefs.useCode),this.$.pinCode.setValue(Checkbook.globals.prefs.code),this.$.pinLockDrawer.setOpen(this.$.pinLock.getValue()),this.$.transPreview.setValue(1===Checkbook.globals.prefs.transPreview),this.$.dispColor.setValue(1===Checkbook.globals.prefs.dispColor),this.$.alwaysFullCalendar.setValue(1===Checkbook.globals.prefs.alwaysFullCalendar),this.$.updateNotice.setValue(1===Checkbook.globals.prefs.updateCheckNotification),this.$.errorReporting.setValue(1===Checkbook.globals.prefs.errorReporting),Checkbook.accounts.manager.fetchAccountsList({onSuccess:enyo.bind(this,this.buildDefaultAccountList)}),this.$.seriesDayLimit.setValue(Checkbook.globals.prefs.seriesDayLimit),this.$.seriesCountLimit.setValue(Checkbook.globals.prefs.seriesCountLimit),this.inherited(arguments),this.$.header.addRemoveClass("text-left",enyo.Panels.isScreenNarrow()),this.$.header.addRemoveClass("text-center",!enyo.Panels.isScreenNarrow()),this.systemReady=!0},togglePINStatus:function(){Checkbook.globals.prefs.useCode=this.$.pinLock.getValue()?1:0,this.$.pinLockDrawer.setOpen(this.$.pinLock.getValue()),this.saveAppPin()},changeAppPin:function(){this.createComponent({name:"pinPopup",kind:"Checkbook.pinChangePopup",onFinish:"changeAppPinHandler"}),this.$.pinPopup.show()},changeAppPinHandler:function(t,e){this.$.cryptoSystem.encryptString(e.value,enyo.bind(this,this.cryptoPinHandler)),this.$.pinPopup.hide(),this.$.pinPopup.destroy()},cryptoPinHandler:function(t){t.length>0&&(Checkbook.globals.prefs.useCode=1,Checkbook.globals.prefs.code=t),this.saveAppPin()},saveAppPin:function(){(0===Checkbook.globals.prefs.useCode||!enyo.isString(Checkbook.globals.prefs.code)||0>=Checkbook.globals.prefs.code.length)&&(Checkbook.globals.prefs.useCode=0,Checkbook.globals.prefs.code=""),this.$.pinCode.setValue(Checkbook.globals.prefs.code),Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getUpdate("prefs",{useCode:Checkbook.globals.prefs.useCode,code:Checkbook.globals.prefs.code},{}))},updateTransPreview:function(t,e){return this.systemReady?(Checkbook.globals.prefs.transPreview=e.value?1:0,Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getUpdate("prefs",{previewTransaction:Checkbook.globals.prefs.transPreview},{})),void 0):!0},updateUpdateNotice:function(t,e){return this.systemReady?(Checkbook.globals.prefs.updateCheckNotification=e.value?1:0,Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getUpdate("prefs",{updateCheckNotification:Checkbook.globals.prefs.updateCheckNotification},{})),void 0):!0},updateErrorReporting:function(t,e){return this.systemReady?(Checkbook.globals.prefs.errorReporting=e.value?1:0,Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getUpdate("prefs",{errorReporting:Checkbook.globals.prefs.errorReporting},{})),void 0):!0},updateDispColor:function(t,e){return this.systemReady?(Checkbook.globals.prefs.dispColor=e.value?1:0,Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getUpdate("prefs",{dispColor:Checkbook.globals.prefs.dispColor},{})),void 0):!0},updateAlwaysFullCalendar:function(t,e){return this.systemReady?(Checkbook.globals.prefs.alwaysFullCalendar=e.value?1:0,Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getUpdate("prefs",{alwaysFullCalendar:Checkbook.globals.prefs.alwaysFullCalendar},{})),void 0):!0},updateSeriesCountLimit:function(t,e){return this.systemReady?(Checkbook.globals.prefs.seriesCountLimit=e.value,Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getUpdate("prefs",{seriesCountLimit:Checkbook.globals.prefs.seriesCountLimit},{})),void 0):!0},updateSeriesDayLimit:function(t,e){return this.systemReady?(Checkbook.globals.prefs.seriesDayLimit=e.value,Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getUpdate("prefs",{seriesDayLimit:Checkbook.globals.prefs.seriesDayLimit},{})),void 0):!0},setupRow:function(t,e){var n=e.index,i=e.item,o=t.accounts[n];return o?(i.$.catDivider.hide(),o.index=n,i.$.accountItem.addRemoveClass("maskedAccount",1===o.hidden),2===o.hidden?i.$.icon.setSrc(imgToGrey("assets/"+o.acctCategoryIcon)):i.$.icon.setSrc("assets/"+o.acctCategoryIcon),i.$.iconLock.addRemoveClass("unlocked",1!==o.acctLocked),i.$.name.setContent(o.acctName),!0):void 0},buildDefaultAccountList:function(t){t.unshift({content:"No Default Account",color:null,icon:null,value:-1}),this.$.defaultAccount.setChoices(t),this.$.defaultAccount.setDisabled(!1),this.$.defaultAccount.render(),Checkbook.accounts.manager.fetchDefaultAccount({onSuccess:enyo.bind(this,this.setDefaultAccount)})},setDefaultAccount:function(t){t?this.$.defaultAccount.setValue(t.acctId):this.$.defaultAccount.setValue(-1)},updateDefaultAccount:function(){Checkbook.accounts.manager.updateDefaultAccount(this.$.defaultAccount.getValue())},addAccount:function(){this.$.addAccountButton.getDisabled()||(this.$.addAccountButton.setDisabled(!0),enyo.Signals.send("showPanePopup",{name:"addAccount",kind:"Checkbook.accounts.modify",acctId:-1,onFinish:enyo.bind(this,this.addAccountComplete)}))},addAccountComplete:function(t,e){this.$.addAccountButton.setDisabled(!1),1===e.action&&e.actionStatus===!0&&enyo.Signals.send("accountChanged")},modifyAccountCategories:function(){this.$.editAccountCategories.getDisabled()||(this.$.editAccountCategories.setDisabled(!0),enyo.Signals.send("showPanePopup",{name:"accountCategoryView",kind:"Checkbook.accountCategory.view",onFinish:enyo.bind(this,this.modifyAccountCategoriesComplete)}))},modifyAccountCategoriesComplete:function(){enyo.Signals.send("accountChanged"),this.$.editAccountCategories.setDisabled(!1)},modifyTransactionCategories:function(){this.$.editTransactionCategories.getDisabled()||(this.$.editTransactionCategories.setDisabled(!0),enyo.Signals.send("showPanePopup",{name:"transactionCategoryView",kind:"Checkbook.transactionCategory.view",onFinish:enyo.bind(this,this.modifyTransactionCategoriesComplete)}))},modifyTransactionCategoriesComplete:function(){this.$.editTransactionCategories.setDisabled(!1)},modifyAutoCompleteSettings:function(){},fullwipe:function(){this.createComponent({name:"fullwipeConfirm",kind:"gts.ConfirmDialog",title:"Purge All Data",message:"Are you sure? Remember this cannot be undone. This app will try to exit when process is complete.",confirmText:"Delete Everything",confirmClass:"onyx-negative",cancelText:"Cancel",cancelClass:"",onConfirm:"fullwipeRun",onCancel:"fullwipeConfirmClose"}),this.$.fullwipeConfirm.show()},fullwipeConfirmClose:function(){this.$.fullwipeConfirm.hide(),this.$.fullwipeConfirm.destroy()},fullwipeRun:function(){this.fullwipeConfirmClose(),this.createComponent({name:"wipeProgress",kind:"gts.ProgressDialog",animateProgress:!0}),this.$.wipeProgress.show({title:"Purging All Data",message:"Please wait...",progress:50}),this.$.wipeProgress.reflow(),Checkbook.globals.gts_db.queries(["DROP TABLE IF EXISTS budget;","DROP TABLE IF EXISTS rules;","DROP TABLE IF EXISTS accounts;","DROP TABLE IF EXISTS accountCategories;","DROP TABLE IF EXISTS transactions;","DROP TABLE IF EXISTS transactionCategories;","DROP TABLE IF EXISTS transactionSplit;","DROP TABLE IF EXISTS repeats;","DROP TABLE IF EXISTS prefs;"],{onSuccess:enyo.bind(this,this.deleteEverythingDone)})},deleteEverythingDone:function(){window.close()}});

// about.js
enyo.kind({name:"Checkbook.about",kind:"onyx.Popup",classes:"small-popup",modal:!0,centered:!0,floating:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",autoDismiss:!0,events:{onFinish:""},components:[{classes:"h-box box-align-center margin-half-bottom",components:[{kind:"enyo.Image",src:enyo.fetchAppInfo().icon},{content:enyo.fetchAppInfo().title+" v"+enyo.fetchAppInfo().version,allowHtml:!0,classes:"box-flex-1 padding-left biggest"},{kind:"onyx.Button",content:"X",ontap:"doFinish",classes:"onyx-blue"}]},{classes:"text-center margin-half-top margin-half-bottom",components:[{content:"Thank you for using "+enyo.fetchAppInfo().title+" powered by"},{kind:"enyo.Image",src:"assets/enyo-logo.png",style:"height: 32px; width: 87px;"}]},{showing:!1,classes:"h-box box-align-center margin-half-top margin-half-bottom",components:[{kind:"enyo.Image",src:"assets/application-web.png"},{content:"<a href='http://forums.precentral.net/glitchtech-science/' target='_blank'>Discussion Forums</a>",classes:"padding-left dark-link",allowHtml:!0}]},{showing:!1,classes:"h-box box-align-center margin-half-top margin-half-bottom",components:[{kind:"enyo.Image",src:"assets/application-web.png"},{content:enyo.fetchAppInfo().vendorurl,classes:"padding-left dark-link",allowHtml:!0}]},{classes:"h-box box-align-center margin-half-top margin-half-bottom",components:[{kind:"enyo.Image",src:"assets/twitter-icon.png"},{content:"@GlitchTech",classes:"padding-left dark-link",allowHtml:!0}]},{classes:"h-box box-align-center margin-half-top margin-half-bottom",components:[{kind:"enyo.Image",src:"assets/application-email.png"},{content:enyo.fetchAppInfo().vendoremail,classes:"padding-left dark-link",allowHtml:!0}]},{content:enyo.fetchAppInfo().copyright,allowHtml:!0,classes:"smaller margin-top"},{kind:"Signals",onbackbutton:"test",onmenubutton:"test",onsearchbutton:"test",onkeydown:"test"}],test:function(){this.showing&&this.log(arguments)}});

// balanceMenu.js
enyo.kind({name:"Checkbook.balanceMenu",kind:"onyx.MenuDecorator",published:{choices:[],value:""},events:{onChange:""},components:[{name:"display"},{name:"menu",kind:"gts.SelectedMenu",classes:"onyx-menu-wider",floating:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",onChange:"balanceSelectionChanged"}],handlers:{onSelect:"preventEvent"},choicesChanged:function(){if(enyo.isArray(this.choices)){for(var t=[],e=0;this.choices.length>e;e++){var n="neutralBalance";Math.round(100*this.choices[e].balance)/100>0?n="positiveBalance":0>Math.round(100*this.choices[e].balance)/100&&(n="negativeBalance"),t.push({value:this.choices[e].value,classes:"h-box",components:[{content:this.choices[e].content,classes:"margin-right box-flex-1"},{content:formatAmount(this.choices[e].balance),classes:n}]})}this.$.menu.setChoices(t),this.valueChanged()}},valueChanged:function(){this.$.menu.setValue(this.value);for(var t=0,e=0;this.choices.length>e;e++)this.choices[e].value===this.value&&(t=this.choices[e].balance);this.$.display.setContent(formatAmount(t)),this.$.display.addRemoveClass("positiveBalanceLight",t>0),this.$.display.addRemoveClass("negativeBalanceLight",0>t),this.$.display.addRemoveClass("neutralBalanceLight",0==t)},balanceSelectionChanged:function(t,e){return this.value=e.value,this.valueChanged(),this.doChange(e),!0},preventEvent:function(){return!0}});

// defaultData.js
function getDBArgs(){var e={database:"ext:checkbook-database",version:"1",name:"Checkbook DB",estimatedSize:5242880,debug:enyo.fetchAppInfo().id.match("beta")};return(enyo.platform.android||enyo.platform.androidChrome)&&(window.openDatabase=window.sqlitePlugin.openDatabase),e}function getLocale(){if(enyo.platform.android||enyo.platform.androidChrome);else var e=enyo.g11n.currentLocale().getLocale();return e}var defaultAccountCategories=[{name:"Checking",catOrder:1,icon:"checkbook_1.png",color:"green"},{name:"Savings",catOrder:2,icon:"safe_1.png",color:"yellow"},{name:"Credit Card",catOrder:3,icon:"credit_card_3.png",color:"red"},{name:"Other",catOrder:4,icon:"coins_3.png",color:"black"}],appIcons=[{icon:"assets/cash_1.png",value:"cash_1.png",components:[{kind:"enyo.Image",src:"assets/cash_1.png"}]},{icon:"assets/cash_2.png",value:"cash_2.png",components:[{kind:"enyo.Image",src:"assets/cash_2.png"}]},{icon:"assets/cash_3.png",value:"cash_3.png",components:[{kind:"enyo.Image",src:"assets/cash_3.png"}]},{icon:"assets/cash_4.png",value:"cash_4.png",components:[{kind:"enyo.Image",src:"assets/cash_4.png"}]},{icon:"assets/cash_5.png",value:"cash_5.png",components:[{kind:"enyo.Image",src:"assets/cash_5.png"}]},{icon:"assets/checkbook_1.png",value:"checkbook_1.png",components:[{kind:"enyo.Image",src:"assets/checkbook_1.png"}]},{icon:"assets/checkbook_2.png",value:"checkbook_2.png",components:[{kind:"enyo.Image",src:"assets/checkbook_2.png"}]},{icon:"assets/coins_1.png",value:"coins_1.png",components:[{kind:"enyo.Image",src:"assets/coins_1.png"}]},{icon:"assets/coins_2.png",value:"coins_2.png",components:[{kind:"enyo.Image",src:"assets/coins_2.png"}]},{icon:"assets/coins_3.png",value:"coins_3.png",components:[{kind:"enyo.Image",src:"assets/coins_3.png"}]},{icon:"assets/coins_4.png",value:"coins_4.png",components:[{kind:"enyo.Image",src:"assets/coins_4.png"}]},{icon:"assets/credit_card_1.png",value:"credit_card_1.png",components:[{kind:"enyo.Image",src:"assets/credit_card_1.png"}]},{icon:"assets/credit_card_2.png",value:"credit_card_2.png",components:[{kind:"enyo.Image",src:"assets/credit_card_2.png"}]},{icon:"assets/credit_card_3.png",value:"credit_card_3.png",components:[{kind:"enyo.Image",src:"assets/credit_card_3.png"}]},{icon:"assets/dollar_sign_1.png",value:"dollar_sign_1.png",components:[{kind:"enyo.Image",src:"assets/dollar_sign_1.png"}]},{icon:"assets/dollar_sign_2.png",value:"dollar_sign_2.png",components:[{kind:"enyo.Image",src:"assets/dollar_sign_2.png"}]},{icon:"assets/dollar_sign_3.png",value:"dollar_sign_3.png",components:[{kind:"enyo.Image",src:"assets/dollar_sign_3.png"}]},{icon:"assets/echeck.png",value:"echeck.png",components:[{kind:"enyo.Image",src:"assets/echeck.png"}]},{icon:"assets/icon_1.png",value:"icon_1.png",components:[{kind:"enyo.Image",src:"assets/icon_1.png"}]},{icon:"assets/icon_2.png",value:"icon_2.png",components:[{kind:"enyo.Image",src:"assets/icon_2.png"}]},{icon:"assets/icon_3.png",value:"icon_3.png",components:[{kind:"enyo.Image",src:"assets/icon_3.png"}]},{icon:"assets/icon_4.png",value:"icon_4.png",components:[{kind:"enyo.Image",src:"assets/icon_4.png"}]},{icon:"assets/jewel_1.png",value:"jewel_1.png",components:[{kind:"enyo.Image",src:"assets/jewel_1.png"}]},{icon:"assets/jewel_2.png",value:"jewel_2.png",components:[{kind:"enyo.Image",src:"assets/jewel_2.png"}]},{icon:"assets/money_bag_1.png",value:"money_bag_1.png",components:[{kind:"enyo.Image",src:"assets/money_bag_1.png"}]},{icon:"assets/money_bag_2.png",value:"money_bag_2.png",components:[{kind:"enyo.Image",src:"assets/money_bag_2.png"}]},{icon:"assets/money_bag_3.png",value:"money_bag_3.png",components:[{kind:"enyo.Image",src:"assets/money_bag_3.png"}]},{icon:"assets/money_bag_4.png",value:"money_bag_4.png",components:[{kind:"enyo.Image",src:"assets/money_bag_4.png"}]},{icon:"assets/padlock_2.png",value:"padlock_2.png",components:[{kind:"enyo.Image",src:"assets/padlock_2.png"}]},{icon:"assets/safe_1.png",value:"safe_1.png",components:[{kind:"enyo.Image",src:"assets/safe_1.png"}]},{icon:"assets/safe_2.png",value:"safe_2.png",components:[{kind:"enyo.Image",src:"assets/safe_2.png"}]},{icon:"assets/transfer_1.png",value:"transfer_1.png",components:[{kind:"enyo.Image",src:"assets/transfer_1.png"}]},{icon:"assets/transfer_2.png",value:"transfer_2.png",components:[{kind:"enyo.Image",src:"assets/transfer_2.png"}]},{icon:"assets/transfer_4.png",value:"transfer_4.png",components:[{kind:"enyo.Image",src:"assets/transfer_4.png"}]}],appColors=[{content:"Black",classes:"custom-background black legend",name:"black"},{content:"Blue",classes:"custom-background blue legend",name:"blue"},{content:"Green",classes:"custom-background green legend",name:"green"},{content:"Orange",classes:"custom-background orange legend",name:"orange"},{content:"Pink",classes:"custom-background pink legend",name:"pink"},{content:"Purple",classes:"custom-background purple legend",name:"purple"},{content:"Red",classes:"custom-background red legend",name:"red"},{content:"Teal",classes:"custom-background teal legend",name:"teal"},{content:"Yellow",classes:"custom-background yellow legend",name:"yellow"}],defaultExpenseCategories=[{genCat:"Auto & Transport",specCat:"Auto Insurance"},{genCat:"Auto & Transport",specCat:"Auto Payment"},{genCat:"Auto & Transport",specCat:"Gas & Fuel"},{genCat:"Auto & Transport",specCat:"Parking"},{genCat:"Auto & Transport",specCat:"Public Transportation"},{genCat:"Auto & Transport",specCat:"Service & Parts"},{genCat:"Auto & Transport",specCat:"Car Wash"},{genCat:"Bills & Utilities",specCat:"Home Phone"},{genCat:"Bills & Utilities",specCat:"Internet"},{genCat:"Bills & Utilities",specCat:"Mobile Phone"},{genCat:"Bills & Utilities",specCat:"Television"},{genCat:"Bills & Utilities",specCat:"Utilities"},{genCat:"Business Services",specCat:"Advertising"},{genCat:"Business Services",specCat:"Legal"},{genCat:"Business Services",specCat:"Office Supplies"},{genCat:"Business Services",specCat:"Printing"},{genCat:"Business Services",specCat:"Shipping"},{genCat:"Education",specCat:"Books & Supplies"},{genCat:"Education",specCat:"Student Loan"},{genCat:"Education",specCat:"Tuition"},{genCat:"Entertainment",specCat:"Amusement"},{genCat:"Entertainment",specCat:"Arts"},{genCat:"Entertainment",specCat:"Movies & DVDs"},{genCat:"Entertainment",specCat:"Music"},{genCat:"Entertainment",specCat:"Newspapers & Magazines"},{genCat:"Fees & Charges",specCat:"ATM Fee"},{genCat:"Fees & Charges",specCat:"Bank Fee"},{genCat:"Fees & Charges",specCat:"Finance Charge"},{genCat:"Fees & Charges",specCat:"Late Fee"},{genCat:"Fees & Charges",specCat:"Service Fee"},{genCat:"Financial",specCat:"Financial Advisor"},{genCat:"Financial",specCat:"Life Insurance"},{genCat:"Food & Dining",specCat:"Alcohol & Bars"},{genCat:"Food & Dining",specCat:"Coffee Shops"},{genCat:"Food & Dining",specCat:"Fast Food"},{genCat:"Food & Dining",specCat:"Groceries"},{genCat:"Food & Dining",specCat:"Restaurants"},{genCat:"Gifts & Donations",specCat:"Charity"},{genCat:"Gifts & Donations",specCat:"Gift"},{genCat:"Health & Fitness",specCat:"Dentist"},{genCat:"Health & Fitness",specCat:"Doctor"},{genCat:"Health & Fitness",specCat:"Eyecare"},{genCat:"Health & Fitness",specCat:"Gym"},{genCat:"Health & Fitness",specCat:"Health Insurance"},{genCat:"Health & Fitness",specCat:"Pharmacy"},{genCat:"Health & Fitness",specCat:"Sports"},{genCat:"Home",specCat:"Furnishings"},{genCat:"Home",specCat:"Home Improvement"},{genCat:"Home",specCat:"Home Insurance"},{genCat:"Home",specCat:"Home Services"},{genCat:"Home",specCat:"Home Supplies"},{genCat:"Home",specCat:"Lawn & Garden"},{genCat:"Home",specCat:"Mortgage & Rent"},{genCat:"Income",specCat:"Bonus"},{genCat:"Income",specCat:"Paycheck"},{genCat:"Income",specCat:"Reimbursement"},{genCat:"Income",specCat:"Rental Income"},{genCat:"Income",specCat:"Returned Purchase"},{genCat:"Kids",specCat:"Allowance"},{genCat:"Kids",specCat:"Baby Supplies"},{genCat:"Kids",specCat:"Babysitter & Daycare"},{genCat:"Kids",specCat:"Child Support"},{genCat:"Kids",specCat:"Kids Activities"},{genCat:"Kids",specCat:"Toys"},{genCat:"Personal Care",specCat:"Hair"},{genCat:"Personal Care",specCat:"Laundry"},{genCat:"Personal Care",specCat:"Spa & Massage"},{genCat:"Pets",specCat:"Pet Food & Supplies"},{genCat:"Pets",specCat:"Pet Grooming"},{genCat:"Pets",specCat:"Veterinary"},{genCat:"Shopping",specCat:"Books"},{genCat:"Shopping",specCat:"Clothing"},{genCat:"Shopping",specCat:"Electronics & Software"},{genCat:"Shopping",specCat:"Hobbies"},{genCat:"Shopping",specCat:"Sporting Goods"},{genCat:"Taxes",specCat:"Federal Tax"},{genCat:"Taxes",specCat:"Local Tax"},{genCat:"Taxes",specCat:"Property Tax"},{genCat:"Taxes",specCat:"Sales Tax"},{genCat:"Taxes",specCat:"State Tax"},{genCat:"Transfer",specCat:"Credit Card Payment"},{genCat:"Travel",specCat:"Air Travel"},{genCat:"Travel",specCat:"Hotel"},{genCat:"Travel",specCat:"Rental Car & Taxi"},{genCat:"Travel",specCat:"Vacation"},{genCat:"Uncategorized",specCat:"Cash & ATM"},{genCat:"Uncategorized",specCat:"Check"},{genCat:"Uncategorized",specCat:"Other"}];

// encryption.js
enyo.kind({name:"Checkbook.encryption",kind:enyo.Component,encryptString:function(e,t){Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getSelect("prefs",["spike"],null),{onSuccess:enyo.bind(this,this.encryptStringSuccess,e,t),onError:enyo.bind(this,this.encryptStringFailure,e,t)})},encryptStringSuccess:function(e,t,n){enyo.isFunction(t)&&(n.length>0&&enyo.isString(e)&&e.length>0?t(CryptoJS.AES.encrypt(e,n[0].spike)+""):t(""))},encryptStringFailure:function(e,t){enyo.isFunction(t)&&t("")},decryptString:function(e,t){Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getSelect("prefs",["spike"],null),{onSuccess:enyo.bind(this,this.decryptStringSuccess,e,t),onError:enyo.bind(this,this.decryptStringFailure,e,t)})},decryptStringSuccess:function(e,t,n){enyo.isFunction(t)&&(n.length>0&&enyo.isString(e)&&e.length>0?t(CryptoJS.AES.decrypt(e,n[0].spike).toString(CryptoJS.enc.Utf8)):t(""))},decryptStringFailure:function(e,t){enyo.isFunction(t)&&t("")}});

// login.js
enyo.kind({name:"Checkbook.login",kind:"onyx.Popup",classes:"login-system small-popup",centered:!0,floating:!0,modal:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",autoDismiss:!1,pin:"",errorCount:0,options:{},components:[{kind:"enyo.FittableColumns",classes:"text-middle margin-bottom",noStretch:!0,components:[{name:"title",content:"",classes:"bigger text-left margin-half-right",fit:!0},{kind:"onyx.Button",content:"X",ontap:"badPin",classes:"onyx-blue small-padding"}]},{kind:"onyx.Groupbox",components:[{kind:"onyx.InputDecorator",layoutKind:"FittableColumnsLayout",classes:"onyx-focused margin-bottom",alwaysLooksFocused:!0,components:[{name:"pin",kind:"onyx.Input",type:"password",placeholder:"Enter PIN using key pad.",fit:!0,disabled:!0},{content:"pin code",classes:"small label"}]}]},{name:"errorMessage",kind:"gts.InlineNotification",type:"error",content:"",showing:!1},{classes:"margin-bottom pin-pad",components:[{classes:"margin-half-bottom",components:[{kind:"onyx.Button",content:"1",classes:"margin-half-right",ontap:"padPressed"},{kind:"onyx.Button",content:"2",classes:"margin-half-right",ontap:"padPressed"},{kind:"onyx.Button",content:"3",classes:"margin-half-right",ontap:"padPressed"}]},{classes:"margin-half-bottom",components:[{kind:"onyx.Button",content:"4",classes:"margin-half-right",ontap:"padPressed"},{kind:"onyx.Button",content:"5",classes:"margin-half-right",ontap:"padPressed"},{kind:"onyx.Button",content:"6",classes:"margin-half-right",ontap:"padPressed"}]},{classes:"margin-half-bottom",components:[{kind:"onyx.Button",content:"7",classes:"margin-half-right",ontap:"padPressed"},{kind:"onyx.Button",content:"8",classes:"margin-half-right",ontap:"padPressed"},{kind:"onyx.Button",content:"9",classes:"margin-half-right",ontap:"padPressed"}]},{classes:"margin-bottom",components:[{content:" ",classes:"dummy-button margin-half-right"},{kind:"onyx.Button",content:"0",classes:"margin-half-right",ontap:"padPressed"},{name:"clear",kind:"onyx.Button",content:"Clear",ontap:"padPressed"}]},{classes:"text-center",components:[{kind:"onyx.Button",classes:"margin-right",content:"Cancel",ontap:"badPin"},{kind:"onyx.Button",classes:"onyx-affirmative",content:"Confirm",ontap:"checkPin"}]}]},{name:"encryption",kind:"Checkbook.encryption"}],authUser:function(e,t,n){this.show(),this.$.title.setContent(e),this.$.pin.setValue(""),this.pin=t,this.options=n,this.errorCount=0},padPressed:function(e){var t=this.$.pin.getValue();e.name&&"clear"===e.name?this.$.pin.setValue(""):10>t.length&&this.$.pin.setValue(t+e.content)},checkPin:function(){this.$.encryption.decryptString(this.pin,enyo.bind(this,this.checkPinHandler))},checkPinHandler:function(e){e!=this.$.pin.getValue()?(this.errorCount++,this.$.errorMessage.show(),this.$.errorMessage.setContent("Invalid PIN.")+"<br />"+this.errorCount+" out of 5 attempts used.",this.$.pin.setValue(""),this.errorCount>=5&&this.badPin()):(this.hide(),this.$.errorMessage.hide(),enyo.isFunction(this.options.onSuccess)&&this.options.onSuccess())},badPin:function(){this.hide(),enyo.isFunction(this.options.onFailure)&&this.options.onFailure()}});

// moreToolbar.js
enyo.kind({name:"Checkbook.MoreToolbar",kind:"onyx.MoreToolbar",tools:[{name:"client",noStretch:!0,fit:!0,classes:"onyx-toolbar-inline"},{name:"nard",kind:"onyx.MenuDecorator",showing:!1,onActivate:"activated",components:[{kind:"onyx.Button",classes:"padding-none margin-none transparent",style:"vertical-align: middle; margin: 4px 6px 5px; box-sizing: border-box;",components:[{kind:"onyx.Icon",classes:"onyx-more-button"}]},{name:"menu",kind:"onyx.Menu",scrolling:!1,classes:"onyx-more-menu"}]}],reflow:function(){this.inherited(arguments)}}),enyo.kind({name:"DUMMYCOMPONENTNAMETHATWONTEVERBEUSEDBECAUSEITISHEREFORREFERENCE",classes:"onyx-toolbar onyx-more-toolbar",menuClass:"",movedClass:"",layoutKind:"FittableColumnsLayout",noStretch:!0,handlers:{onHide:"reflow"},published:{clientLayoutKind:"FittableColumnsLayout"},tools:[{name:"client",noStretch:!0,fit:!0,classes:"onyx-toolbar-inline"},{name:"nard",kind:"onyx.MenuDecorator",showing:!1,onActivate:"activated",components:[{kind:"onyx.IconButton",classes:"onyx-more-button"},{name:"menu",kind:"onyx.Menu",scrolling:!1,classes:"onyx-more-menu"}]}],initComponents:function(){this.menuClass&&this.menuClass.length>0&&!this.$.menu.hasClass(this.menuClass)&&this.$.menu.addClass(this.menuClass),this.createChrome(this.tools),this.inherited(arguments),this.$.client.setLayoutKind(this.clientLayoutKind)},clientLayoutKindChanged:function(){this.$.client.setLayoutKind(this.clientLayoutKind)},reflow:function(){this.warn(this.$.menu.children.length,this.$.menu,this.$.menu.childComponents),this.inherited(arguments),this.isContentOverflowing()?(this.$.nard.show(),this.popItem()&&this.reflow()):this.tryPushItem()?this.reflow():this.$.menu.children.length||(this.$.nard.hide(),this.$.menu.hide())},activated:function(e,t){this.addRemoveClass("active",t.originator.active)},popItem:function(){var e=this.findCollapsibleItem();if(e){this.movedClass&&this.movedClass.length>0&&!e.hasClass(this.movedClass)&&e.addClass(this.movedClass),this.$.menu.addChild(e,null);var t=this.$.menu.hasNode();return t&&e.hasNode()&&e.insertNodeInParent(t),!0}},pushItem:function(){var e=this.$.menu.children,t=e[0];if(t){this.movedClass&&this.movedClass.length>0&&t.hasClass(this.movedClass)&&t.removeClass(this.movedClass),this.$.client.addChild(t);var n=this.$.client.hasNode();if(n&&t.hasNode()){for(var i,o,s=0;this.$.client.children.length>s;s++){var a=this.$.client.children[s];if(void 0!==a.toolbarIndex&&a.toolbarIndex!=s){i=a,o=s;break}}if(i&&i.hasNode()){t.insertNodeInParent(n,i.node);var r=this.$.client.children.pop();this.$.client.children.splice(o,0,r)}else t.appendNodeToParent(n)}return!0}},tryPushItem:function(){if(this.pushItem()){if(!this.isContentOverflowing())return!0;this.popItem()}},isContentOverflowing:function(){if(this.$.client.hasNode()){var e=this.$.client.children,t=e.length&&e[e.length-1].hasNode();if(t)return this.$.client.reflow(),t.offsetLeft+t.offsetWidth>this.$.client.node.clientWidth}},findCollapsibleItem:function(){for(var e,t=this.$.client.children,n=t.length-1;e=t[n];n--){if(!e.unmoveable)return e;void 0===e.toolbarIndex&&(e.toolbarIndex=n)}},findHiddenItem:function(){for(var e,t=this.$.client.children,n=t.length-1;e=t[n];n--){if(e.hidden)return e;void 0===e.toolbarIndex&&(e.toolbarIndex=n)}}});

// pinChangePopup.js
enyo.kind({name:"Checkbook.pinChangePopup",kind:"onyx.Popup",classes:"small-popup",centered:!0,floating:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",autoDismiss:!1,events:{onFinish:""},components:[{name:"title",content:"Change PIN Code",classes:"bigger"},{classes:"padding-std light",components:[{content:"Your pin may only contain numeric characters. (0-9)",classes:"small bold padding-half-bottom"},{kind:"onyx.Groupbox",components:[{kind:"onyx.InputDecorator",layoutKind:"FittableColumnsLayout",components:[{name:"pin1",kind:"onyx.Input",type:"password",placeholder:"10 characters max",fit:!0,oninput:"checkPin"},{content:"pin code",classes:"small label"}]},{kind:"onyx.InputDecorator",layoutKind:"FittableColumnsLayout",components:[{name:"pin2",kind:"onyx.Input",type:"password",placeholder:"10 characters max",fit:!0,oninput:"checkPin"},{content:"confirm",classes:"small label"}]}]},{name:"errorMessageContainer",layoutKind:"enyo.FittableColumnsLayout",noStretch:!0,showing:!1,classes:"padding-half-top text-middle",components:[{kind:"enyo.Image",src:"assets/status_icons/warning.png",style:"margin-right: 5px;"},{name:"errorMessage",style:"color: #d70000;",content:"The code entered is invalid."}]}]},{classes:"padding-std margin-half-top text-center",components:[{kind:"onyx.Button",classes:"margin-half-right",content:"Cancel",ontap:"doFinish"},{kind:"onyx.Button",classes:"onyx-affirmative margin-half-left",content:"Change",ontap:"updatePin"}]}],show:function(){this.inherited(arguments),this.$.pin1.focus()},checkPin:function(e){e.setValue(e.getValue().replace(/[^0-9]/,"").substr(0,10))},updatePin:function(){return""===this.$.pin1.getValue()||""===this.$.pin2.getValue()?(this.$.errorMessage.setContent("The code entered is invalid."),this.$.errorMessageContainer.show(),void 0):this.$.pin1.getValue()!==this.$.pin2.getValue()?(this.$.errorMessage.setContent("The codes entered do not match."),this.$.errorMessageContainer.show(),void 0):(this.$.errorMessageContainer.hide(),this.doFinish({value:this.$.pin1.getValue()}),void 0)}});

// sortOptionData.js
var accountSortOptions=[{content:"Custom Category",value:0,query:"acctCatOrder, acctCategory COLLATE NOCASE, sect_order, acctName COLLATE NOCASE"},{content:"Custom Account",value:1,query:"sect_order, acctName COLLATE NOCASE, acctCatOrder, acctCategory COLLATE NOCASE"},{content:"Alphabetical Name",value:2,query:"acctName COLLATE NOCASE, acctCategory COLLATE NOCASE"},{content:"Alphabetical Category",value:3,query:"acctCategory COLLATE NOCASE, acctName COLLATE NOCASE"}],budgetSortOptions=[{content:"Custom",value:0,query:"budgetOrder ASC, category COLLATE NOCASE ASC, category2 COLLATE NOCASE ASC, budgetId ASC"},{content:"Alphabetical",value:1,query:"category COLLATE NOCASE ASC, category2 COLLATE NOCASE ASC, budgetId ASC"},{content:"Percent Remaining",value:2,query:"( 100.0 * spent / spending_limit ) ASC, category COLLATE NOCASE ASC, category2 COLLATE NOCASE ASC, budgetId ASC"},{content:"Percent Spent",value:3,query:"( 100.0 * spent / spending_limit ) DESC, category COLLATE NOCASE ASC, category2 COLLATE NOCASE ASC, budgetId ASC"}],transactionSortOptions=[],defaultAcctTrsnSortOptn=[{sortGroup:"Date",groupOrder:0,label:"Newest to Oldest, Show Newest",desc:"Sorts transactions from newest to oldest. Displays the newest transactions.",qry:"date DESC, itemId DESC",sortId:1},{sortGroup:"Date",groupOrder:0,label:"Oldest to Newest, Show Oldest",desc:"Sorts transactions from oldest to newest. Displays the oldest transactions.",qry:"date ASC, itemId ASC",sortId:8},{sortGroup:"Description",groupOrder:1,label:"A-Z",desc:"Sorts transactions from A to Z. Displays the newest transactions.",qry:"desc COLLATE NOCASE ASC, itemId ASC",sortId:2},{sortGroup:"Description",groupOrder:1,label:"Z-A",desc:"Sorts transactions from A to Z. Displays the newest transactions.",qry:"desc COLLATE NOCASE DESC, itemId ASC",sortId:3},{sortGroup:"Amount",groupOrder:2,label:"Ascending",desc:"Sorts transactions by amount, ascending. Displays the greatest expense.",qry:"amount ASC, itemId ASC",sortId:4},{sortGroup:"Amount",groupOrder:2,label:"Descending",desc:"Sorts transactions by amount, descending. Displays the greatest income.",qry:"amount DESC, itemId ASC",sortId:5},{sortGroup:"Status",groupOrder:3,label:"Cleared first",desc:"Sorts transactions by cleared status with Cleared transactions first. Transactions are then sorted by date from newest to oldest.",qry:"cleared DESC, date ASC, itemId ASC",sortId:6},{sortGroup:"Status",groupOrder:3,label:"Pending first",desc:"Sorts transactions by cleared status with Uncleared transactions first. Transactions are then sorted by date from newest to oldest.",qry:"cleared ASC, date DESC, itemId ASC",sortId:7},{sortGroup:"Check Number",groupOrder:4,label:"Ascending Numbers",desc:"Sorts transactions by check number. Displays the lowest numbered check first. Transactions without check numbers are sorted last.",qry:"IFNULL( NULLIF( checkNum, '' ), ( SELECT IFNULL( MAX( checkNum ), 0 ) FROM transactions LIMIT 1 ) ) ASC, itemId ASC",sortId:9},{sortGroup:"Check Number",groupOrder:4,label:"Descending Numbers",desc:"Sorts transactions by check number. Displays the highest numbered check first. Transactions without check numbers are sorted last.",qry:"checkNum DESC, itemId ASC",sortId:10}];

// systemError.js
enyo.kind({name:"Checkbook.systemError",kind:"onyx.Popup",classes:"small-popup",centered:!0,floating:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",autoDismiss:!1,published:{errTitle:"System Error",mainMessage:"Something happend that should not have. Sorry about that.",secondaryMessage:"",errorIcon:"assets/status_icons/warning.png"},events:{onFinish:""},components:[{kind:"enyo.FittableColumns",classes:"text-middle margin-half-bottom",noStretch:!0,components:[{name:"icon",kind:"enyo.Image",classes:"img-icon margin-half-right"},{name:"title",fit:!0,classes:"bold"},{kind:"onyx.Button",content:"X",ontap:"closeMe",classes:"onyx-blue small-padding"}]},{classes:"light padding-std",components:[{name:"primaryMessage",classes:"margin-half-bottom",allowHtml:!0},{name:"secondaryMessage",classes:"smaller margin-half-bottom",allowHtml:!0}]},{classes:"text-right margin-half-top",components:[{kind:"onyx.Button",content:"Okay",ontap:"closeMe"}]}],set:function(e,t,n,i){enyo.isString(e)&&(this.errTitle=e),enyo.isString(t)&&(this.mainMessage=t),enyo.isString(n)&&(this.secondaryMessage=n),enyo.isString(i)&&(this.errorIcon=i)},load:function(e,t,n,i){this.set(e,t,n,i),this.show()},show:function(){this.inherited(arguments),this.setUpDisplay()},setUpDisplay:function(){this.titleChanged(),this.mainMessageChanged(),this.secondaryMessageChanged(),this.errorIconChanged(),this.reflow()},titleChanged:function(){if("~|p2t|~"===this.errTitle){var e="Critical error";switch(Math.floor(50*Math.random())){case 0:e="I don't hate you";break;case 1:e="Hey, hey, hey";break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:e="Malfunctioning";break;default:}this.$.title.setContent(e)}else this.$.title.setContent(this.errTitle)},mainMessageChanged:function(){this.$.primaryMessage.setContent(this.mainMessage)},secondaryMessageChanged:function(){"~|mt|~"===this.secondaryMessage?this.$.secondaryMessage.setContent("Checkbook will attempt to resume normal functions. If it does not, please restart the app.<br />If this error occurs again, please <a href='mailto:glitchtechscience@gmail.com?subject=Error: Checkbook&body=%0A%0AError Message: "+this.mainMessage+"'>contact us</a>."):this.$.secondaryMessage.setContent(this.secondaryMessage)},errorIconChanged:function(){this.$.icon.setSrc(this.errorIcon)},closeMe:function(){this.doFinish()}});

// manager.js
enyo.singleton({name:"Checkbook.accounts.manager",kind:enyo.Component,components:[{name:"cryptoSystem",kind:"Checkbook.encryption"}],accountObject:{lastModified:0,lastBuild:-1,defaultAccountIndex:-1,accounts:[],accountsList:[],idTable:[],processing:!1,processingQueue:[]},constructor:function(){this.inherited(arguments),this.bound={_errorHandler:enyo.bind(this,this._errorHandler)}},createAccount:function(t,e){enyo.mixin(t,{sect_order:["( SELECT IFNULL( MAX( sect_order ), 0 ) FROM accounts )",!0]}),this._prepareDataObject(t),this.$.cryptoSystem.encryptString(t.lockedCode,enyo.bind(this,this._createAccountFollower,t,e))},_createAccountFollower:function(t,e,n){(0==t.auto_savings||!gts.Object.isNumber(t.auto_savings_link)||0>t.auto_savings_link)&&(t.auto_savings=0,t.auto_savings_link=-1),0!=t.acctLocked&&""!=n&&n?(t.acctLocked=1,t.lockedCode=n):(t.acctLocked=0,t.lockedCode="");var i=[Checkbook.globals.gts_db.getInsert("accounts",t)];1===t.defaultAccount&&i.unshift(Checkbook.globals.gts_db.getUpdate("accounts",{defaultAccount:0},{0:"0"})),Checkbook.globals.gts_db.queries(i,this._prepareModOptions(e))},updateAccount:function(t,e,n,i){this._prepareDataObject(t),this.$.cryptoSystem.encryptString(t.lockedCode,enyo.bind(this,this._updateAccountFollower,t,e,n,i))},_updateAccountFollower:function(t,e,n,i,o){(0==t.auto_savings||!gts.Object.isNumber(t.auto_savings_link)||0>t.auto_savings_link)&&(t.auto_savings=0,t.auto_savings_link=-1),0!=t.acctLocked&&""!=o&&o?n&&(t.acctLocked=1,t.lockedCode=o):(t.acctLocked=0,t.lockedCode="");var s=[Checkbook.globals.gts_db.getUpdate("accounts",t,{acctId:e})];1===t.defaultAccount&&s.unshift(Checkbook.globals.gts_db.getUpdate("accounts",{defaultAccount:0})),Checkbook.globals.gts_db.queries(s,this._prepareModOptions(i))},updateAccountBalView:function(t,e,n){Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getUpdate("accounts",{bal_view:e},{acctId:t}),this._prepareModOptions(n))},updateAccountSorting:function(t,e,n){Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getUpdate("accounts",{sort:e},{acctId:t}),this._prepareModOptions(n))},deleteAccount:function(t,e){var n=[Checkbook.globals.gts_db.getDelete("transactions",{account:t}),Checkbook.globals.gts_db.getDelete("repeats",{rep_acctId:t}),Checkbook.globals.gts_db.getUpdate("transactions",{linkedAccount:"",linkedRecord:""},{linkedAccount:t}),Checkbook.globals.gts_db.getUpdate("repeats",{rep_linkedAcctId:""},{rep_linkedAcctId:t}),Checkbook.globals.gts_db.getDelete("accounts",{acctId:t})];Checkbook.globals.gts_db.queries(n,this._prepareModOptions(e))},updateDefaultAccount:function(t,e){var n=[Checkbook.globals.gts_db.getUpdate("accounts",{defaultAccount:0},null),Checkbook.globals.gts_db.getUpdate("accounts",{defaultAccount:1},{acctId:t})],i=this.fetchAccountIndex(t);i>=0?this.accountObject.defaultAccountIndex=i:this.updateAccountModTime(),Checkbook.globals.gts_db.queries(n,e)},fetchDefaultAccount:function(t){this.accountObject.lastModified<=this.accountObject.lastBuild?enyo.isFunction(t.onSuccess)&&(gts.Object.isNumber(this.accountObject.defaultAccountIndex)&&this.accountObject.defaultAccountIndex>=0?t.onSuccess(this.accountObject.accounts[this.accountObject.defaultAccountIndex]):t.onSuccess()):(t=this._getOptions(t),this.accountObject.processingQueue.push({source:"fetchDefaultAccount",func:enyo.bind(this,this.fetchDefaultAccount,t)}),this.accountObject.processing||(this.accountObject.processing=!0,this._buildAccountObjects(t.onError)))},fetchAccountIndex:function(t){return this.accountObject.lastModified<=this.accountObject.lastBuild?this.accountObject.idTable.indexOf(t):-1},fetchAccount:function(t,e){if(this.accountObject.lastModified<=this.accountObject.lastBuild){var n=this.fetchAccountIndex(t);n>=0&&enyo.isFunction(e.onSuccess)?e.onSuccess(this.accountObject.accounts[n]):enyo.isFunction(e.onError)&&e.onError()}else this.accountObject.processingQueue.push({source:"fetchAccount",func:enyo.bind(this,this.fetchAccount,t,e)}),this.accountObject.processing||(this.accountObject.processing=!0,this._buildAccountObjects(this._getOptions(e).onError))},fetchAccountBalance:function(t,e){var n=new Date,i=Date.parse(n);n.setHours(23,59,59,999),n=Date.parse(n);var o=new gts.databaseQuery({sql:"SELECT IFNULL( ( SELECT SUM( transactions.amount ) FROM transactions WHERE transactions.account = accounts.acctId AND ( ( CAST( transactions.date AS INTEGER ) <= ? AND showTransTime = 1 ) OR ( CAST( transactions.date AS INTEGER ) <= ? AND showTransTime = 0 ) ) ), 0 ) AS balance0, IFNULL( ( SELECT SUM( transactions.amount ) FROM transactions WHERE transactions.account = accounts.acctId AND ( ( CAST( transactions.date AS INTEGER ) <= ? AND showTransTime = 1 ) OR ( CAST( transactions.date AS INTEGER ) <= ? AND showTransTime = 0 ) ) AND transactions.cleared = 1 ), 0 ) AS balance1, IFNULL( ( SELECT SUM( transactions.amount ) FROM transactions WHERE transactions.account = accounts.acctId AND transactions.cleared = 0 ), 0 ) AS balance3, IFNULL( ( SELECT SUM( transactions.amount ) FROM transactions WHERE transactions.account = accounts.acctId ), 0 ) AS balance2 FROM accounts WHERE acctId = ?",values:[i,n,i,n,t]});Checkbook.globals.gts_db.query(o,{onSuccess:function(t){enyo.isFunction(e.onSuccess)&&(t=t[0],t.balance0=Math.round(100*t.balance0)/100,t.balance1=Math.round(100*t.balance1)/100,t.balance2=Math.round(100*t.balance2)/100,t.balance3=Math.round(100*t.balance3)/100,e.onSuccess(t))},onError:e.onError})},fetchAccounts:function(t,e,n){if(this.accountObject.lastModified<=this.accountObject.lastBuild){if(enyo.isFunction(t.onSuccess)){var i=[];if(t.showHidden)i=this.accountObject.accounts.slice(gts.Object.isNumber(n)?n:0,e);else{n=gts.Object.isNumber(n)?n:0,e=gts.Object.isNumber(e)?e:this.accountObject.accounts.length;for(var o=n;e>o;o++)2!==this.accountObject.accounts[o].hidden&&i.push(this.accountObject.accounts[o])}t.onSuccess(i)}}else t=this._getOptions(t),this.accountObject.processingQueue.push({source:"fetchAccounts",func:enyo.bind(this,this.fetchAccounts,t,e,n)}),this.accountObject.processing||(this.accountObject.processing=!0,this._buildAccountObjects(t.onError))},fetchAccountsList:function(t,e,n){this.accountObject.lastModified<=this.accountObject.lastBuild?enyo.isFunction(t.onSuccess)&&t.onSuccess(this.accountObject.accountsList.slice(gts.Object.isNumber(n)?n:0,e)):(this.accountObject.processingQueue.push({source:"fetchAccountsList",func:enyo.bind(this,this.fetchAccountsList,t,e,n)}),this.accountObject.processing||(this.accountObject.processing=!0,this._buildAccountObjects(t.onError)))},fetchOverallBalances:function(t){var e=new Date,n=Date.parse(e);e.setHours(23,59,59,999),e=Date.parse(e);var i=new gts.databaseQuery({sql:"SELECT SUM( IFNULL( ( SELECT SUM( transactions.amount ) FROM transactions WHERE transactions.account = accounts.acctId AND ( ( CAST( transactions.date AS INTEGER ) <= ? AND showTransTime = 1 ) OR ( CAST( transactions.date AS INTEGER ) <= ? AND showTransTime = 0 ) ) ), 0 ) ) AS balance0, SUM( IFNULL( ( SELECT SUM( transactions.amount ) FROM transactions WHERE transactions.account = accounts.acctId AND ( ( CAST( transactions.date AS INTEGER ) <= ? AND showTransTime = 1 ) OR ( CAST( transactions.date AS INTEGER ) <= ? AND showTransTime = 0 ) ) AND transactions.cleared = 1 ), 0 ) ) AS balance1, SUM( IFNULL( ( SELECT SUM( transactions.amount ) FROM transactions WHERE transactions.account = accounts.acctId ), 0 ) ) AS balance2, SUM( IFNULL( ( SELECT SUM( transactions.amount ) FROM transactions WHERE transactions.account = accounts.acctId AND transactions.cleared = 0 ), 0 ) ) AS balance3, SUM( CASE WHEN bal_view = 0 THEN IFNULL( ( SELECT SUM( transactions.amount ) FROM transactions WHERE transactions.account = accounts.acctId AND ( ( CAST( transactions.date AS INTEGER ) <= ? AND showTransTime = 1 ) OR ( CAST( transactions.date AS INTEGER ) <= ? AND showTransTime = 0 ) ) ), 0 ) WHEN bal_view = 1 THEN IFNULL( ( SELECT SUM( transactions.amount ) FROM transactions WHERE transactions.account = accounts.acctId AND ( ( CAST( transactions.date AS INTEGER ) <= ? AND showTransTime = 1 ) OR ( CAST( transactions.date AS INTEGER ) <= ? AND showTransTime = 0 ) ) AND transactions.cleared = 1 ), 0 ) WHEN bal_view = 2 THEN IFNULL( ( SELECT SUM( transactions.amount ) FROM transactions WHERE transactions.account = accounts.acctId ), 0 ) WHEN bal_view = 3 THEN IFNULL( ( SELECT SUM( transactions.amount ) FROM transactions WHERE transactions.account = accounts.acctId AND transactions.cleared = 0 ), 0 ) ELSE 0 END ) AS stdBal FROM accounts WHERE hidden = 0",values:[n,e,n,e,n,e,n,e]});Checkbook.globals.gts_db.query(i,{onSuccess:enyo.bind(this,this.fetchOverallBalancesHandler,t.onSuccess),onError:t.onError})},fetchOverallBalancesHandler:function(t,e){var n=[0,0,0,0,0];if(e.length>0){var i=e[0];n[0]=i.balance0,n[1]=i.balance1,n[2]=i.balance2,n[3]=i.balance3,n[4]=i.stdBal}enyo.isFunction(t)&&t(n)},_buildAccountObjects:function(t,e,n){e=gts.Object.isNumber(e)?e:100,n=gts.Object.isNumber(n)?n:0,0>=n&&(this.accountObject.defaultAccountIndex=-1,this.accountObject.idTable=[],this.accountObject.accounts=[],this.accountObject.accountsList=[]);var i=new Date,o=Date.parse(i);i.setHours(23,59,59,999),i=Date.parse(i);var s=new gts.databaseQuery({sql:"SELECT *, ( SELECT qry FROM acctTrsnSortOptn WHERE sortId = IFNULL( accounts.sort, 1 ) ) AS sortQry, IFNULL( ( SELECT COUNT( transactions.amount ) FROM transactions WHERE transactions.account = accounts.acctId ), 0 ) AS itemCount, IFNULL( ( SELECT accountCategories.icon FROM accountCategories WHERE accountCategories.name = accounts.acctCategory ), 'icon_2.png' ) AS acctCategoryIcon, ( SELECT accountCategories.color FROM accountCategories WHERE accountCategories.name = accounts.acctCategory ) AS acctCategoryColor, ( SELECT accountCategories.catOrder FROM accountCategories WHERE accountCategories.name = accounts.acctCategory ) AS acctCatOrder, ( SELECT accountCategories.rowid FROM accountCategories WHERE accountCategories.name = accounts.acctCategory ) AS acctCatId, IFNULL( ( SELECT SUM( transactions.amount ) FROM transactions WHERE transactions.account = accounts.acctId AND ( ( CAST( transactions.date AS INTEGER ) <= ? AND showTransTime = 1 ) OR ( CAST( transactions.date AS INTEGER ) <= ? AND showTransTime = 0 ) ) ), 0 ) AS balance0, IFNULL( ( SELECT SUM( transactions.amount ) FROM transactions WHERE transactions.account = accounts.acctId AND ( ( CAST( transactions.date AS INTEGER ) <= ? AND showTransTime = 1 ) OR ( CAST( transactions.date AS INTEGER ) <= ? AND showTransTime = 0 ) ) AND transactions.cleared = 1 ), 0 ) AS balance1, IFNULL( ( SELECT SUM( transactions.amount ) FROM transactions WHERE transactions.account = accounts.acctId AND transactions.cleared = 0 ), 0 ) AS balance3, IFNULL( ( SELECT SUM( transactions.amount ) FROM transactions WHERE transactions.account = accounts.acctId ), 0 ) AS balance2 FROM accounts ORDER BY "+accountSortOptions[Checkbook.globals.prefs.custom_sort].query+" LIMIT ? OFFSET ?",values:[o,i,o,i,e,n]});Checkbook.globals.gts_db.query(s,{onSuccess:enyo.bind(this,this._buildAccountObjectsHandler,t,e,n),onError:t})},_buildAccountObjectsHandler:function(t,e,n,i){this.log(e,n,i.length);for(var o=0;i.length>o;o++){var s=i[o];1==s.defaultAccount&&(this.accountObject.defaultAccountIndex=n+o),this.accountObject.idTable[n+o]=s.acctId,this.accountObject.accountsList[n+o]={kind:"gts.MenuImageItem",content:s.acctName,src:"assets/"+s.acctCategoryIcon,color:s.acctCategoryColor,value:s.acctId},this.accountObject.accounts[n+o]=enyo.clone(s),this.accountObject.accounts[n+o].sort=parseInt(this.accountObject.accounts[n+o].sort)}if(e>i.length){for(;this.accountObject.processingQueue.length>0;){var a=this.accountObject.processingQueue.shift();enyo.isFunction(a.func)&&enyo.asyncMethod(null,a.func)}this.accountObject.lastBuild=Date.parse(new Date),this.accountObject.processing=!1,this.accountObject.processingQueue=[]}else this._buildAccountObjects(t,e,n+e)},_prepareDataObject:function(t){for(key in t)"boolean"==typeof t[key]?t[key]=t[key]?1:0:t[key]===void 0&&(t[key]="")},_getOptions:function(t){var e={onSuccess:this._emptyFunction,onError:this.bound._errorHandler};return t===void 0&&(t={}),enyo.mixin(e,t),e},_prepareModOptions:function(t){var e={};return e.onSuccess=t&&enyo.isFunction(t.onSuccess)?enyo.bind(this,function(){this.updateAccountModTime(),t.onSuccess(!0)}):enyo.bind(this,this.updateAccountModTime),t&&enyo.isFunction(t.onError)?e.onError=t.onError:delete e.onError,e},updateAccountModTime:function(){this.accountObject.lastModified=Date.parse(new Date)},_emptyFunction:function(){},_errorHandler:function(){0>=arguments.length||(enyo.error("Account Control Error: "+Object.toJSON(arguments)),Checkbook.globals.criticalError&&Checkbook.globals.criticalError.load(null,"Account Control Error: "+Object.toJSON(arguments),null))}});

// list.js
enyo.kind({name:"Checkbook.accounts.list",fit:!0,style:"position: relative;",classes:"enyo-fit",accounts:[],events:{onSetupRow:"",onLoadStart:"",onLoadStop:""},published:{balanceView:4,editMode:!1,reorderable:!0,showHidden:!1,horizontal:"hidden"},components:[{name:"entries",kind:"enyo.List",classes:"enyo-fit",reorderable:!0,enableSwipe:!1,onSetupItem:"handleSetupRow",onReorder:"listReorder",onSetupReorderComponents:"setupReorderComponents",onSetupPinnedReorderComponents:"setupPinnedReorderComponents",onSetupSwipeItem:"setupSwipeItem",onSwipeComplete:"swipeComplete",components:[{name:"accountItem",kind:"gts.Item",classes:"bordered account-item",tapHighlight:!0,holdHighlight:!1,ontap:"accountTapped",components:[{name:"catDivider",kind:"gts.Divider",ontap:"dividerTapped",useFittable:!1},{layoutKind:"",classes:"account h-box box-pack-center box-align-center",components:[{name:"icon",kind:"enyo.Image",classes:"accountIcon"},{name:"iconLock",kind:"enyo.Image",src:"assets/padlock_1.png",classes:"accountLockIcon unlocked"},{name:"name",classes:"accountName text-ellipsis box-flex-1"},{name:"balance"}]},{name:"note",allowHtml:!0,classes:"note smaller text-ellipsis"}]}],reorderComponents:[{name:"reorderContent",layoutKind:"FittableColumnsLayout",classes:"enyo-fit deep-green-trans padding-std",components:[{name:"reorderIcon",kind:"enyo.Image",classes:"accountIcon"},{name:"reorderName",classes:"text-ellipsis accountName",fit:!0}]}],pinnedReorderComponents:[{name:"pinnedReorderItem",layoutKind:"FittableColumnsLayout",classes:"enyo-fit rich-brown-trans padding-std",components:[{name:"pinIcon",kind:"enyo.Image",classes:"accountIcon"},{name:"pinName",classes:"text-ellipsis accountName",fit:!0},{showing:!1,kind:"onyx.Button",ontap:"dropPinnedRow",content:"Drop"}]}],swipeableComponents:[{name:"swipeItem",layoutKind:"FittableColumnsLayout",classes:"enyo-fit naka-red-trans padding-std",components:[{content:"Delete Account?",fit:!0},{kind:"onyx.Button",ontap:"",content:"Cancel"},{kind:"onyx.Button",ontap:"",classes:"onyx-negative",content:"Cancel"}]}]},{kind:"Signals",accountChanged:"renderAccountList",accountSortChanged:"renderAccountList",balanceChanged:"refresh",accountBalanceChanged:"accountBalanceChanged"}],balanceViewChanged:function(){this.refresh()},reorderableChanged:function(){this.$.entries.setReorderable(this.reorderable)},showHiddenChanged:function(){this.renderAccountList()},renderAccountList:function(){this.log(),this.doLoadStart(),this.accounts=[],Checkbook.accounts.manager.fetchAccounts({showHidden:this.showHidden,onSuccess:enyo.bind(this,this.dataResponse)})},dataResponse:function(t){this.accounts=enyo.clone(t),this.refresh(),enyo.asyncMethod(this,this.doLoadStop)},refresh:function(){this.log(),this.$.entries.setCount(this.accounts.length),this.$.entries.refresh()},renderRow:function(t){void 0===t||isNaN(t)||this.$.entries.renderRow(t)},dividerTapped:function(t,e){return e.preventDefault(),!0},accountTapped:function(t,e){var n=this.accounts[e.index];if(n){var i,o={};this.editMode?(i="showPanePopup",o={name:"editAccount",kind:"Checkbook.accounts.modify",acctId:this.accounts[e.index].acctId,onFinish:enyo.bind(this,this.editAccountComplete,e.index)}):(i="viewAccount",o={account:n}),1==n.acctLocked?Checkbook.globals.security.authUser(n.acctName+" "+"PIN Code",n.lockedCode,{onSuccess:function(){enyo.Signals.send(i,o)}}):enyo.Signals.send(i,o)}return!0},editAccountComplete:function(t,e,n){if(this.log(),1===n.action&&n.actionStatus===!0){var i=this;Checkbook.accounts.manager.fetchAccount(this.accounts[t].acctId,{onSuccess:function(){enyo.Signals.send("accountChanged",{accountId:i.accounts[t].acctId})}})}else 2===n.action&&(this.log("Account deleted"),enyo.Signals.send("accountChanged",{accountId:this.accounts[t].acctId,deleted:!0}))},setupReorderComponents:function(t,e){var n=this.accounts[e.index];n&&(this.$.reorderName.setContent(n.acctName),this.$.reorderIcon.setSrc("assets/"+n.acctCategoryIcon))},listReorder:function(t,e){if(e.reorderTo!=e.reorderFrom&&e.reorderTo>-1&&e.reorderTo<this.accounts.length){var n=enyo.clone(this.accounts[e.reorderFrom]);this.accounts.splice(e.reorderFrom,1),this.accounts.splice(e.reorderTo,0,n);for(var i=[],o=0;this.accounts.length>o;o++)i.push(Checkbook.globals.gts_db.getUpdate("accounts",{sect_order:o},{rowid:this.accounts[o].acctId}));1!==Checkbook.globals.prefs.custom_sort&&(Checkbook.globals.prefs.custom_sort=1,i.push(new gts.databaseQuery({sql:"UPDATE prefs SET custom_sort = ?;",values:[Checkbook.globals.prefs.custom_sort]}))),Checkbook.globals.gts_db.queries(i),this.refresh(),enyo.Signals.send("accountSortOptionChanged")}},setupPinnedReorderComponents:function(t,e){var n=this.accounts[e.index];n&&(this.$.pinName.setContent(n.acctName),this.$.pinIcon.setSrc("assets/"+n.acctCategoryIcon),enyo.asyncMethod(this,this.dropPinnedRow,t,e))},dropPinnedRow:function(t,e){this.$.entries.dropPinnedRow(e)},setupSwipeItem:function(){this.log("NYI",arguments)},swipeComplete:function(){this.log("NYI",arguments)},accountDeleted:function(t,e){var n=this;return Checkbook.accounts.manager.deleteAccount(this.accounts[e.index].acctId,{onSuccess:function(){enyo.Signals.send("accountChanged",{accountId:n.accounts[e.index].acctId,deleted:!0})}}),!0},handleSetupRow:function(t,e){return enyo.isFunction(this.doSetupRow)&&""!==this.onSetupRow?this.doSetupRow(e):this.setupRow(t,e)},setupRow:function(t,e){var n=e.index,i=this.accounts[n];if(i){i.index=n,this.$.accountItem.addRemoveClass("alt-row",0===i.index%2),this.$.accountItem.addRemoveClass("norm-row",0!==i.index%2),this.$.accountItem.addRemoveClass("hiddenAccount",2===i.hidden&&this.showHidden),this.$.accountItem.addRemoveClass("maskedAccount",1===i.hidden),this.$.icon.setSrc("assets/"+i.acctCategoryIcon),this.$.iconLock.addRemoveClass("unlocked",1!==i.acctLocked),this.$.name.setContent(i.acctName);var o=4===this.balanceView?i.bal_view:this.balanceView;switch(o){case 0:i.balance=i.balance0;break;case 1:i.balance=i.balance1;break;case 2:i.balance=i.balance2;break;case 3:i.balance=i.balance3;break;default:i.balance=0}return i.balance=prepAmount(i.balance),this.$.balance.setContent(formatAmount(i.balance)),this.$.balance.addRemoveClass("positiveBalance",i.balance>0),this.$.balance.addRemoveClass("negativeBalance",0>i.balance),this.$.balance.addRemoveClass("neutralBalance",0==i.balance),this.$.note.setContent(i.acctNotes.replace(/\n/,"<br />")),this.$.catDivider.setContent(i.acctCategory),this.$.catDivider.canGenerate=(0===Checkbook.globals.prefs.custom_sort||3===Checkbook.globals.prefs.custom_sort)&&(0>=i.index||i.acctCategory!==this.accounts[i.index-1].acctCategory),!0}},accountBalanceChanged:function(t,e){if(!e||!e.accounts)return this.renderAccountList(),void 0;if(e=e.accounts,e.account===void 0&&e.linkedAccount===void 0&&e.atAccount===void 0)return this.renderAccountList(),void 0;if(e.account!==void 0){var n=e.account>=0?Checkbook.accounts.manager.fetchAccountIndex(e.account):-1;n>=0&&(e.accountBal!==void 0&&gts.Object.size(e.accountBal)>0?this.accountBalanceChangedHandler(n,e.accountBal):Checkbook.accounts.manager.fetchAccountBalance(e.account,{onSuccess:enyo.bind(this,this.accountBalanceChangedHandler,n)}))}if(e.linkedAccount!==void 0){var i=e.linkedAccount>=0?Checkbook.accounts.manager.fetchAccountIndex(e.linkedAccount):-1;i>=0&&Checkbook.accounts.manager.fetchAccountBalance(e.linkedAccount,{onSuccess:enyo.bind(this,this.accountBalanceChangedHandler,i)})}if(e.atAccount!==void 0&&e.linkedAccount!=e.atAccount){var i=e.atAccount>=0?Checkbook.accounts.manager.fetchAccountIndex(e.atAccount):-1;i>=0&&Checkbook.accounts.manager.fetchAccountBalance(e.atAccount,{onSuccess:enyo.bind(this,this.accountBalanceChangedHandler,i)})}},accountBalanceChangedHandler:function(t,e){e===void 0||isNaN(t)||0>t||t>=this.accounts.length||(this.accounts[t].balance0=e.balance0,this.accounts[t].balance1=e.balance1,this.accounts[t].balance2=e.balance2,this.accounts[t].balance3=e.balance3,this.renderRow(t))}});

// view.js
enyo.kind({name:"Checkbook.accounts.view",classes:"v-box",accounts:[],totalBalance:[0,0,0,0,0],balanceView:4,components:[{name:"header",kind:"onyx.Toolbar",layoutKind:"FittableColumnsLayout",components:[{kind:"enyo.Image",src:"assets/dollar_sign_1.png",classes:"img-icon",style:"margin-right: 0.25em; height: 32px;"},{content:"Checkbook",classes:"big enyo-text-ellipsis",fit:!0},{name:"balanceMenu",kind:"Checkbook.balanceMenu",onChange:"handleBalanceButton",style:"padding: 0 8px; margin: 0;"},{name:"editOverlay",content:"Edit Accounts",classes:"enyo-fit text-center header-overlay rounded",showing:!1}]},{name:"entries",kind:"Checkbook.accounts.list",classes:"box-flex-1",balanceView:4,editMode:!1,showHidden:!1,onLoadStart:"showLoading",onLoadStop:"hideLoading"},{kind:"Checkbook.MoreToolbar",classes:"rich-brown",components:[{kind:"onyx.MenuDecorator",onSelect:"sortMenuSelected",components:[{kind:"onyx.Button",classes:"padding-none transparent",components:[{kind:"onyx.Icon",src:"assets/menu_icons/sort.png"}]},{name:"sortMenu",kind:"gts.SelectedMenu",floating:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",style:"min-width: 225px;",components:accountSortOptions}]},{classes:"text-center",fit:!0,unmoveable:!0,components:[{name:"addAccountButton",kind:"onyx.Button",ontap:"addAccount",classes:"margin-half-right padding-none transparent",components:[{kind:"onyx.Icon",src:"assets/menu_icons/new.png"}]},{kind:"onyx.Button",ontap:"toggleLock",classes:"margin-half-left padding-none transparent",components:[{name:"editModeButtonIcon",kind:"onyx.Icon",src:"assets/menu_icons/lock_closed.png",classes:"onyx-icon-button"}]}]},{kind:"onyx.MenuDecorator",onSelect:"searchMenuSelected",components:[{kind:"onyx.Button",classes:"padding-none transparent",components:[{kind:"onyx.Icon",src:"assets/menu_icons/search.png"}]},{kind:"onyx.Menu",classes:"onyx-menu-wider",floating:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",components:[{kind:"gts.MenuImageItem",content:"Toggle Hidden",src:"assets/menu_icons/search.png"},{kind:"gts.MenuImageItem",content:"Toggle Edit Mode",src:"assets/menu_icons/lock_closed.png"}]}]},{kind:"onyx.Button",classes:"padding-none transparent",ontap:"triggerAppMenu",components:[{kind:"onyx.Icon",src:"assets/menu_icons/menu.png"}]}]},{name:"loadingScrim",kind:"onyx.Scrim",classes:"enyo-fit onyx-scrim-translucent",showing:!0,style:"z-index: 1000;",components:[{kind:"onyx.Spinner",style:"size-double",style:"position: absolute; top: 50%; margin-top: -45px; left: 50%; margin-left: -45px;"}]},{kind:"Signals",accountChanged:"renderAccountList",accountSortOptionChanged:"updateSortMenu",balanceViewChanged:"accountBalanceViewChanged",accountBalanceChanged:"accountBalanceForceUpdate"}],handlers:{onSelect:"menuItemSelected"},renderAccountList:function(){this.accountBalanceForceUpdate(),this.updateSortMenu()},showLoading:function(){this.$.loadingScrim.show()},hideLoading:function(){this.$.loadingScrim.hide()},accountBalanceViewChanged:function(t,e){if(e.index===void 0||0>e.index||e.index>=this.$.entries.accounts.length){for(var n=0;this.$.entries.accounts.length>n;n++)if(this.$.entries.accounts[n].acctId===e.id){this.$.entries.accounts[n].bal_view=e.mode,e.index=n;break}}else this.$.entries.accounts[e.index].bal_view=e.mode;this.$.entries.refresh(),enyo.isFunction(e.callbackFn)&&e.callbackFn(e.index)},accountBalanceForceUpdate:function(){Checkbook.accounts.manager.fetchOverallBalances({onSuccess:enyo.bind(this,this.buildBalanceButton,enyo.bind(this,this.renderBalanceButton))})},buildBalanceButton:function(t,e){this.totalBalance=e,enyo.isFunction(t)&&t()},renderBalanceButton:function(){this.$.balanceMenu.setChoices([{content:"Default:",balance:this.totalBalance[4],value:4},{content:"Available:",balance:this.totalBalance[0],value:0},{content:"Cleared:",balance:this.totalBalance[1],value:1},{content:"Pending:",balance:this.totalBalance[3],value:3},{content:"Final:",balance:this.totalBalance[2],value:2}]),this.$.balanceMenu.setValue(this.balanceView),this.$.header.reflow()},handleBalanceButton:function(t,e){this.balanceView=e.value,this.$.entries.setBalanceView(this.balanceView),this.$.entries.refresh()},triggerAppMenu:function(t,e){return enyo.Signals.send("onmenubutton",e),!0},updateSortMenu:function(){this.$.sortMenu.setValue(Checkbook.globals.prefs.custom_sort)},sortMenuSelected:function(t,e){return e.selected&&Checkbook.globals.prefs.custom_sort!==e.selected.value?(Checkbook.globals.prefs.custom_sort=e.selected.value,Checkbook.globals.gts_db.query(new gts.databaseQuery({sql:"UPDATE prefs SET custom_sort = ?;",values:[Checkbook.globals.prefs.custom_sort]}),{onSuccess:function(){Checkbook.accounts.manager.updateAccountModTime(),enyo.Signals.send("accountSortChanged")}}),!0):void 0},addAccount:function(){this.$.addAccountButton.getDisabled()||(this.$.addAccountButton.setDisabled(!0),enyo.Signals.send("showPanePopup",{name:"newAccount",kind:"Checkbook.accounts.modify",acctId:-1,onFinish:enyo.bind(this,this.addAccountComplete)}))},addAccountComplete:function(t,e){this.$.addAccountButton.setDisabled(!1),1===e.action&&e.actionStatus===!0&&enyo.Signals.send("accountChanged")},toggleLock:function(){this.$.entries.getEditMode()?this.$.entries.setEditMode(!1):this.$.entries.setEditMode(!0),this.$.editModeButtonIcon.setSrc(this.$.entries.getEditMode()?"assets/menu_icons/lock_open.png":"assets/menu_icons/lock_closed.png"),this.$.editOverlay.setShowing(this.$.entries.getEditMode()),this.$.header.reflow()},searchMenuSelected:function(t,e){var n=e.content.toLowerCase();return"toggle hidden"===n?this.$.entries.setShowHidden(!this.$.entries.getShowHidden()):"toggle edit mode"===n?this.toggleLock():"search"===n?enyo.Signals.send("showSearch",{}):"budget"===n?this.log("launch budget system (overlay like modify account)"):"reports"===n&&this.log("launch report system (overlay like modify account)"),!0}});

// modify.js
enyo.kind({name:"Checkbook.accounts.modify",kind:"FittableRows",classes:"enyo-fit",published:{acctId:-1},events:{onFinish:""},categories:[],sorting:[],pinChanged:!1,components:[{kind:"enyo.Scroller",horizontal:"hidden",classes:"rich-brown-gradient",fit:!0,components:[{classes:"light narrow-column",style:"min-height: 100%;",components:[{kind:"onyx.Groupbox",classes:"padding-half-top padding-half-bottom",components:[{kind:"onyx.InputDecorator",layoutKind:"FittableColumnsLayout",components:[{name:"accountName",kind:"onyx.Input",placeholder:"Enter Account Name...",fit:!0},{content:"Account Name",classes:"label"}]}]},{name:"accountCategory",kind:"gts.SelectorBar",classes:"custom-background bordered",label:"Account Category",onChange:"categoryChanged"},{name:"defaultAccount",kind:"gts.ToggleBar",classes:"bordered",label:"Default Account",sublabel:"This account is launched automatically on start.",onContent:"Yes",offContent:"No"},{name:"securityOptionDrawer",kind:"gts.DividerDrawer",caption:"Security Options",open:!0,components:[{name:"freezeAccount",kind:"gts.ToggleBar",classes:"bordered",label:"Freeze Internal Transactions",sublabel:"Prevent any changes from being made only in this account.",onContent:"Yes",offContent:"No"},{name:"pinLock",kind:"gts.ToggleBar",classes:"bordered",label:"PIN Lock",onContent:"Yes",offContent:"No",onChange:"togglePINStatus"},{name:"pinLockDrawer",kind:"onyx.Drawer",open:!1,components:[{kind:"onyx.Groupbox",classes:"padding-half-top",ontap:"changePinCode",components:[{kind:"onyx.InputDecorator",layoutKind:"FittableColumnsLayout",components:[{name:"pinCode",kind:"onyx.Input",type:"password",placeholder:"Tap to set...",disabled:!0,fit:!0},{content:"Code",classes:"label"}]}]}]}]},{kind:"gts.DividerDrawer",caption:"Display Options",open:!0,components:[{name:"transactionSorting",kind:"gts.SelectorBar",classes:"bordered",label:"Sorting",maxHeight:350,labelWidth:"150px",onChange:"transactionSortingUpdateLabel"},{name:"accountDisplay",kind:"gts.SelectorBar",classes:"bordered",label:"Display",maxHeight:350,labelWidth:"150px",onChange:"accountDisplayUpdateLabel",value:0,choices:[{content:"Show Account",value:0},{content:"Mask Account",value:1},{content:"Hide Account",value:2}]},{name:"balance",kind:"gts.SelectorBar",classes:"bordered",label:"Balance",maxHeight:350,labelWidth:"150px",onChange:"balanceUpdateLabel",value:0,choices:[{content:"Available",value:0},{content:"Cleared",value:1},{content:"Pending",value:3},{content:"Final",value:2}]},{name:"showTransTime",kind:"gts.ToggleBar",classes:"bordered",label:"Show Transaction Time",sublabel:"Displays the transaction time in addition to the date.",onContent:"Yes",offContent:"No",value:!0},{name:"showRunningBal",kind:"gts.ToggleBar",classes:"bordered",label:"Show Running Balance",sublabel:"Running balance will be shown beneath transaction amount. The transaction amount will be black and the current balance will be colored. Only available in certain sort modes.",onContent:"Yes",offContent:"No"},{name:"hideTransNotes",kind:"gts.ToggleBar",classes:"bordered",label:"Hide Transaction Notes",sublabel:"Transaction notes will be hidden.",onContent:"Yes",offContent:"No"}]},{kind:"gts.DividerDrawer",caption:"Transaction Options",open:!0,components:[{name:"descriptionMultilineMode",kind:"gts.ToggleBar",classes:"bordered",label:"Description Multiline Mode",sublabel:"Allows the transaction description to take up multiple lines in the add/edit transaction screen.",onContent:"Yes",offContent:"No"},{name:"autoComplete",kind:"gts.ToggleBar",classes:"bordered",label:"Use Auto-Complete",sublabel:"Displays suggestions for transaction descriptions based on your history.",onContent:"Yes",offContent:"No",value:!0},{name:"atmMode",kind:"gts.ToggleBar",classes:"bordered",label:"Use ATM Mode",sublabel:"Amount field will be automatically formatted as you type.",onContent:"Yes",offContent:"No",value:!0},{name:"autoTransfer",kind:"gts.SelectorBar",classes:"bordered",label:"Auto Transfer",onChange:"toggleAutoTransferDrawer",value:0,choices:[{content:"Do not transfer",value:0},{content:"Transfer remainder",value:1},{content:"Transfer additional dollar",value:2}]},{name:"autoTransferDrawer",kind:"onyx.Drawer",components:[{name:"autoTransferLink",kind:"gts.SelectorBar",label:"Transfer to...",classes:"iconListSelector"}]},{name:"expenseCategories",kind:"gts.ToggleBar",classes:"bordered",label:"Add Expense Categories",sublabel:"Add a field to record the expense category in the add/edit transaction screen.",onContent:"Yes",offContent:"No",value:!0},{name:"checkNumber",kind:"gts.ToggleBar",classes:"bordered",label:"Add Check Number Field",sublabel:"Add a field to record the check number in the add/edit transaction screen.",onContent:"Yes",offContent:"No"},{name:"payeeField",kind:"gts.ToggleBar",classes:"bordered",label:"Add Payee Field",sublabel:"Add a field to record the payee in the add/edit transaction screen.",onContent:"Yes",offContent:"No",value:!1},{showing:!1,name:"hideCleared",kind:"gts.ToggleBar",classes:"bordered",label:"Hide cleared transactions",sublabel:"",onContent:"Yes",offContent:"No"}]},{kind:"onyx.Groupbox",classes:"padding-half-top",components:[{kind:"onyx.InputDecorator",layoutKind:"FittableColumnsLayout",components:[{name:"accountNotes",kind:"onyx.TextArea",placeholder:"Account specific notes",style:"min-height: 150px;",fit:!0},{content:"Notes",classes:"label",style:"vertical-align: top;"}]}]},{name:"accountDeleteButton",kind:"onyx.Button",ontap:"deleteAccount",content:"Delete Account",classes:"onyx-negative",style:"margin-top: 1.5em; width: 100%;"},{style:"height: 1.5em;"}]}]},{kind:"onyx.Toolbar",classes:"text-center two-button-toolbar",components:[{kind:"onyx.Button",content:"Cancel",ontap:"doFinish"},{content:""},{kind:"onyx.Button",content:"Save",classes:"onyx-affirmative",ontap:"saveAccount"}]},{name:"loadingScrim",kind:"onyx.Scrim",classes:"onyx-scrim-translucent"},{name:"loadingSpinner",kind:"onyx.Spinner",classes:"size-double",style:"z-index: 2; position: absolute; top: 50%; margin-top: -45px; left: 50%; margin-left: -45px;"},{name:"acctCategoryManager",kind:"Checkbook.accountCategory.manager"}],rendered:function(){this.inherited(arguments),this.$.loadingScrim.show(),this.$.loadingSpinner.show(),this.$.acctCategoryManager.fetchCategories({onSuccess:enyo.bind(this,this.buildAccountCategories)})},buildAccountCategories:function(e){var t=null;this.categories={assoc:{},choices:[]};for(var n=0;e.length>n;n++)t=e[n],t&&(this.categories.assoc[t.name]={icon:"assets/"+t.icon,color:t.color},this.categories.choices.push({kind:"gts.MenuImageItem",content:t.name,src:"assets/"+t.icon,color:t.color,value:t.name}));this.$.accountCategory.setChoices(this.categories.choices),0>=transactionSortOptions.length?Checkbook.transactions.manager.fetchTransactionSorting({onSuccess:enyo.bind(this,this.buildTransactionSorting)}):this.buildTransactionSorting()},buildTransactionSorting:function(){this.$.transactionSorting.setChoices(transactionSortOptions),Checkbook.accounts.manager.fetchAccountsList({onSuccess:enyo.bind(this,this.buildAutoTransferLink)})},buildAutoTransferLink:function(e){e.length>0?(this.$.autoTransferLink.setChoices(e),this.$.autoTransfer.setDisabled(!1),this.$.autoTransferLink.setDisabled(!1)):(this.$.autoTransfer.setValue(0),this.$.autoTransfer.setDisabled(!0),this.$.autoTransferLink.setDisabled(!0)),enyo.asyncMethod(this,this.setAccountValues)},transactionSortingUpdateLabel:function(){Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getSelect("acctTrsnSortOptn",["desc"],{sortId:this.$.transactionSorting.getValue()}),{onSuccess:enyo.bind(this,this.transactionSortingUpdateLabelHandler)})},transactionSortingUpdateLabelHandler:function(e){e[0].desc?this.$.transactionSorting.setSublabel(e[0].desc):this.$.transactionSorting.setSublabel("")},accountDisplayUpdateLabel:function(){var e=this.$.accountDisplay.getValue();0===e?this.$.accountDisplay.setSublabel("Account is visible."):1===e?this.$.accountDisplay.setSublabel("Account is visible, but removed from total balance calculations."):2===e&&this.$.accountDisplay.setSublabel("Account is hidden and removed from total balance calculations. Account can still be accessed via Preferences.")},balanceUpdateLabel:function(){var e=this.$.balance.getValue();0===e?this.$.balance.setSublabel("Includes all transactions up to current date/time."):1===e?this.$.balance.setSublabel("Includes all cleared transactions up to current date/time."):2===e?this.$.balance.setSublabel("Includes all transactions."):3===e&&this.$.balance.setSublabel("Includes all pending transactions.")},categoryChanged:function(){if(1===Checkbook.globals.prefs.dispColor){for(var e=0;appColors.length>e;e++)this.$.accountCategory.removeClass(appColors[e].name);var t=this.$.accountCategory.getValue();this.categories.assoc[t]&&this.$.accountCategory.addClass(this.categories.assoc[t].color)}},togglePINStatus:function(){return this.$.pinLockDrawer.setOpen(this.$.pinLock.getValue()),!0},changePinCode:function(){this.createComponent({name:"pinPopup",kind:"Checkbook.pinChangePopup",onFinish:"changePinCodeHandler",onHide:"resized"}),this.$.pinPopup.show()},changePinCodeHandler:function(e,t){enyo.isString(t.value)&&(this.$.pinCode.setValue(t.value),this.pinChanged=!0),this.$.pinPopup.hide(),this.$.pinPopup.destroy()},toggleAutoTransferDrawer:function(){var e=this.$.autoTransfer.getValue();0===e?this.$.autoTransfer.setSublabel("Do not transfer anything."):1===e?this.$.autoTransfer.setSublabel("Remainder of dollar amount will be transferred to selected account."):2===e&&this.$.autoTransfer.setSublabel("Additional dollar will be transferred to selected account."),this.$.autoTransferDrawer.setOpen(this.$.autoTransfer.getValue()>0)},setAccountValues:function(){this.log(),this.acctId>=0?Checkbook.accounts.manager.fetchAccount(this.acctId,{onSuccess:enyo.bind(this,this.renderDisplayItems),onError:null}):this.renderDisplayItems({acctId:-1,acctName:"",acctNotes:"",acctCategory:this.categories.choices[0].value,sort:transactionSortOptions[0].value,defaultAccount:0,frozen:0,hidden:0,acctLocked:0,lockedCode:"",transDescMultiLine:0,showTransTime:1,useAutoComplete:1,atmEntry:1,bal_view:0,runningBalance:1,checkField:0,hideNotes:0,enableCategories:1,hide_cleared:0,last_sync:"",auto_savings:0,auto_savings_link:-1,payeeField:0})},renderDisplayItems:function(e){return e&&void 0!==e?(this.$.accountName.setValue(e.acctName),this.$.accountCategory.setValue(e.acctCategory),this.$.accountNotes.setValue(e.acctNotes),this.$.freezeAccount.setValue(1===e.frozen),this.$.pinLock.setValue(1===e.acctLocked),this.$.pinCode.setValue(e.lockedCode),this.$.transactionSorting.setValue(e.sort),this.$.accountDisplay.setValue(e.hidden),this.$.balance.setValue(e.bal_view),this.$.defaultAccount.setValue(1===e.defaultAccount),this.$.showTransTime.setValue(1===e.showTransTime),this.$.showRunningBal.setValue(1===e.runningBalance),this.$.hideTransNotes.setValue(1===e.hideNotes),this.$.descriptionMultilineMode.setValue(1===e.transDescMultiLine),this.$.autoComplete.setValue(1===e.useAutoComplete),this.$.atmMode.setValue(1===e.atmEntry),this.$.autoTransfer.setValue(e.auto_savings),this.$.autoTransferLink.setValue(e.auto_savings_link),this.$.checkNumber.setValue(1===e.checkField),this.$.expenseCategories.setValue(1===e.enableCategories),this.$.payeeField.setValue(1===e.payeeField),this.$.hideCleared.setValue(1===e.hide_cleared),this.transactionSortingUpdateLabel(),this.accountDisplayUpdateLabel(),this.balanceUpdateLabel(),this.togglePINStatus(),this.toggleAutoTransferDrawer(),this.categoryChanged(),0>this.acctId&&this.$.accountDeleteButton.hide(),this.$.loadingScrim.hide(),this.$.loadingSpinner.hide(),this.$.accountName.focus(),this.resized(),void 0):(this.doFinish(0),void 0)},saveAccount:function(){if(0>=this.$.accountName.getValue().length)return alert("you need an account name (replace this)"),void 0;var e={acctName:this.$.accountName.getValue(),acctNotes:this.$.accountNotes.getValue(),acctCategory:this.$.accountCategory.getValue(),sort:this.$.transactionSorting.getValue(),defaultAccount:this.$.defaultAccount.getValue(),frozen:this.$.freezeAccount.getValue(),hidden:this.$.accountDisplay.getValue(),acctLocked:this.$.pinLock.getValue(),lockedCode:this.$.pinCode.getValue(),transDescMultiLine:this.$.descriptionMultilineMode.getValue(),showTransTime:this.$.showTransTime.getValue(),useAutoComplete:this.$.autoComplete.getValue(),atmEntry:this.$.atmMode.getValue(),auto_savings:this.$.autoTransfer.getValue(),auto_savings_link:this.$.autoTransferLink.getValue(),bal_view:this.$.balance.getValue(),runningBalance:this.$.showRunningBal.getValue(),checkField:this.$.checkNumber.getValue(),hideNotes:this.$.hideTransNotes.getValue(),enableCategories:this.$.expenseCategories.getValue(),payeeField:this.$.payeeField.getValue(),hide_cleared:!1},t={onSuccess:enyo.bind(this,this.saveFinished)};0>this.acctId?Checkbook.accounts.manager.createAccount(e,t):Checkbook.accounts.manager.updateAccount(e,this.acctId,this.pinChanged,t)},saveFinished:function(e){enyo.asyncMethod(this,this.doFinish,{action:1,actionStatus:e})},deleteAccount:function(){0>this.acctId?this.doFinish(0):(this.createComponent({name:"deleteAccountConfirm",kind:"gts.ConfirmDialog",title:"Delete Account",message:"Are you sure you want to delete this account?",confirmText:"Delete",confirmClass:"onyx-negative",cancelText:"Cancel",cancelClass:"",onConfirm:"deleteAccountHandler",onCancel:"deleteAccountConfirmClose"}),this.$.deleteAccountConfirm.show())},deleteAccountConfirmClose:function(){this.$.deleteAccountConfirm.hide(),this.$.deleteAccountConfirm.destroy()},deleteAccountHandler:function(){this.deleteAccountConfirmClose(),Checkbook.accounts.manager.deleteAccount(this.acctId,{onSuccess:enyo.bind(this,this.deleteFinished)})},deleteFinished:function(e){enyo.asyncMethod(this,this.doFinish,{action:2,actionStatus:e})}});

// manager.js
enyo.kind({name:"Checkbook.accountCategory.manager",kind:enyo.Component,constructor:function(){this.inherited(arguments),Checkbook.globals.gts_db||(this.log("creating database object."),new gts.database(getDBArgs()))},fetchCategories:function(e,t,n){Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getSelect("accountCategories",["rowid","*"],null,["catOrder","name COLLATE NOCASE"],t,n),e)},fetchMatchingCount:function(e,t,n){Checkbook.globals.gts_db.query(new gts.databaseQuery({sql:"SELECT COUNT( name ) AS nameCount FROM accountCategories WHERE name LIKE ? AND rowid != ?;",values:[e,t]}),{onSuccess:function(e){var t=-1;try{t=e[e.length-1].nameCount}catch(i){}enyo.isFunction(n.onSuccess)&&n.onSuccess(t)},onError:enyo.isFunction(n.onError)?n.onError:null})},createCategory:function(e,t){Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getInsert("accountCategories",e),{onSuccess:enyo.bind(this,this.createCategoryFollower,t),onError:t.onError})},createCategoryFollower:function(e){Checkbook.accounts.manager.updateAccountModTime(),Checkbook.globals.gts_db.query(new gts.databaseQuery({sql:"UPDATE accountCategories SET catOrder = ( SELECT IFNULL( MAX( catOrder ) + 1, 0 ) FROM accountCategories LIMIT 1 ) WHERE rowid = ?;",values:[Checkbook.globals.gts_db.lastInsertRowId]}),e)},editCategory:function(e,t,n,i,o,s){Checkbook.accounts.manager.updateAccountModTime();var a=[Checkbook.globals.gts_db.getUpdate("accountCategories",{name:t,icon:n,color:i},{rowid:e}),Checkbook.globals.gts_db.getUpdate("accounts",{acctCategory:t},{acctCategory:o})];Checkbook.globals.gts_db.queries(a,s)},deleteCategory:function(e,t,n){Checkbook.accounts.manager.updateAccountModTime(),Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getDelete("accountCategories",{rowid:e,name:t}),n)},reorderCategories:function(e,t){Checkbook.accounts.manager.updateAccountModTime();for(var n=[],i=0;e.length>i;i++)n.push(Checkbook.globals.gts_db.getUpdate("accountCategories",{catOrder:i},{rowid:e[i].rowid}));Checkbook.globals.gts_db.queries(n,t)}});

// view.js
enyo.kind({name:"Checkbook.accountCategory.view",kind:"FittableRows",classes:"enyo-fit",style:"height: 100%;",categories:[],events:{onFinish:""},components:[{name:"header",kind:"onyx.Toolbar",classes:"text-center text-middle",style:"position: relative;",components:[{components:[{content:"Account Categories",className:"bigger"},{name:"subheader",className:"smaller"}]},{kind:"onyx.Button",ontap:"doFinish",content:"x",classes:"onyx-negative",style:"position: absolute; right: 15px;"}]},{kind:"enyo.Scroller",horizontal:"hidden",classes:"rich-brown-gradient",fit:!0,components:[{name:"entries",kind:"enyo.Repeater",classes:"enyo-fit light narrow-column padding-half-top padding-half-bottom",style:"min-height: 100%; position: relative;",onSetupItem:"setupRow",components:[{name:"item",kind:"onyx.Item",tapHighlight:!0,classes:"bordered text-middle custom-background legend h-box",ontap:"editItem",onDelete:"deleteItem",components:[{name:"icon",kind:"enyo.Image",classes:"img-icon"},{name:"name",classes:"margin-left box-flex-1"},{style:"width: 64px;",components:[{name:"up",kind:"onyx.IconButton",src:"assets/menu_icons/up.png",style:"float: left;",ontap:"moveUp"},{name:"down",kind:"onyx.IconButton",src:"assets/menu_icons/down.png",style:"float: right;",ontap:"moveDown"}]}]}]}]},{kind:"onyx.Toolbar",classes:"text-center",components:[{kind:"onyx.Button",content:"Create New",ontap:"createNew"}]},{name:"modifyCat",kind:"Checkbook.accountCategory.modify",onHide:"resized",onChangeComplete:"modificationComplete"},{name:"manager",kind:"Checkbook.accountCategory.manager"}],rendered:function(){this.inherited(arguments),this.fetchCategories(),this.$.header.addRemoveClass("text-left",enyo.Panels.isScreenNarrow()),this.$.header.addRemoveClass("text-center",!enyo.Panels.isScreenNarrow())},fetchCategories:function(){this.$.manager.fetchCategories({onSuccess:enyo.bind(this,this.dataResponse)})},dataResponse:function(e){this.categories=e,this.$.entries.setCount(this.categories.length)},setupRow:function(e,t){var n=t.index,i=t.item,o=this.categories[n];if(o){i.$.icon.setSrc("assets/"+o.icon),i.$.name.setContent(o.name);for(var s=0;appColors.length>s;s++)i.$.item.removeClass(appColors[s].name);return 1===Checkbook.globals.prefs.dispColor&&i.$.item.addClass(o.color),n>0?i.$.up.show():i.$.up.hide(),this.categories.length-1>n?i.$.down.show():i.$.down.hide(),!0}},createNew:function(){this.$.modifyCat.show(-1)},editItem:function(e,t){var n=this.categories[t.index];n&&this.$.modifyCat.show(n.rowid,n.name,n.icon,n.color)},deleteItem:function(e,t){var n=this.categories[t];n&&this.$.manager.deleteCategory(n.rowid,n.name,{onSuccess:enyo.bind(this,this.modificationComplete,{action:"delete"})})},modificationComplete:function(e,t){this.fetchCategories(),"reorder"!=t.action&&this.$.modifyCat.hide()},moveUp:function(e,t){return this.reorder(e,t.index,t.index-1),!0},moveDown:function(e,t){return this.reorder(e,t.index,t.index+1),!0},reorder:function(e,t,n){if(t!=n&&t>-1&&this.categories.length>t){var i=this.categories.splice(n,1),o=this.categories.slice(t);this.categories.length=t,this.categories.push.apply(this.categories,i),this.categories.push.apply(this.categories,o),this.$.manager.reorderCategories(this.categories,{onSuccess:enyo.bind(this,this.modificationComplete,{action:"reorder"})})}}});

// modify.js
enyo.kind({name:"Checkbook.accountCategory.modify",kind:"onyx.Popup",classes:"login-system small-popup",centered:!0,floating:!0,modal:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",autoDismiss:!1,events:{onChangeComplete:""},id:-1,general:"",specific:"",components:[{kind:"enyo.FittableColumns",classes:"text-middle margin-bottom",noStretch:!0,components:[{name:"title",content:"",classes:"bigger text-left margin-half-right",fit:!0},{kind:"onyx.Button",content:"X",ontap:"hide",classes:"onyx-blue small-padding"}]},{kind:"onyx.Groupbox",classes:"light",components:[{kind:"onyx.InputDecorator",layoutKind:"FittableColumnsLayout",classes:"onyx-focused",alwaysLooksFocused:!0,components:[{name:"name",kind:"onyx.Input",placeholder:"category name",fit:!0},{content:"name",classes:"small label"}]},{name:"icon",kind:"gts.SelectorBar",label:"Icon",maxHeight:300,choices:appIcons},{name:"color",kind:"gts.SelectorBar",label:"Color",classes:"custom-background legend",choices:appColors,onChange:"colorChanged"}]},{name:"errorMessage",kind:"gts.InlineNotification",type:"error",content:"",showing:!1},{classes:"padding-std margin-half-top text-center h-box",components:[{kind:"onyx.Button",classes:"margin-right box-flex",content:"Cancel",ontap:"hide"},{name:"deleteButton",kind:"onyx.Button",classes:"onyx-negative box-flex",content:"Delete",ontap:"deleteCategory"},{kind:"onyx.Button",classes:"onyx-affirmative margin-left box-flex",content:"Save",ontap:"save"}]},{name:"manager",kind:"Checkbook.accountCategory.manager"}],show:function(e,t,n,i){this.inherited(arguments),0>e?this.$.deleteButton.hide():this.$.deleteButton.show(),0>e?(this.$.title.setContent("Create a Category"),this.rowid=-1,this.name="",this.icon="",this.color=""):e>0?(this.$.title.setContent("Edit Category"),this.rowid=e,this.name=t,this.icon=n,this.color=i):this.hide(),this.$.name.setValue(this.name),this.$.icon.setValue(this.icon),this.$.color.setValue(gts.String.ucfirst(this.color));for(var o=0;appColors.length>o;o++)this.$.color.removeClass(appColors[o].name);this.$.color.addClass(this.color),1===Checkbook.globals.prefs.dispColor?this.$.color.show():this.$.color.hide(),this.$.name.focus()},colorChanged:function(e,t){return this.$.color.removeClass(this.color),this.color=t.selected.name,this.$.color.addClass(this.color),!0},deleteCategory:function(){if(this.rowid>=0){this.createComponent({name:"deleteCategoryConfirm",kind:"gts.ConfirmDialog",title:"Delete Account",message:"Are you sure you want to delete this account category?",confirmText:"Delete",confirmClass:"onyx-negative",cancelText:"Cancel",cancelClass:"",onConfirm:"deleteCategoryHandler",onCancel:"deleteCategoryConfirmClose"}),this.$.deleteCategoryConfirm.show();var e=this.getComputedStyleValue("zIndex");if(!e)for(var t=this.domCssText.split(";"),n=0;t.length>n;n++)if(t[n].match("z-index")){t=t[n].split(":"),e=t[1];break}this.$.deleteCategoryConfirm.applyStyle("z-index",e-5+10)}},deleteCategoryConfirmClose:function(){this.$.deleteCategoryConfirm.destroy()},deleteCategoryHandler:function(){this.deleteCategoryConfirmClose(),this.$.manager.deleteCategory(this.rowid,this.name,{onSuccess:enyo.bind(this,this.doChangeComplete,{action:"delete"})})},save:function(){var e=this.$.name.getValue();return this.icon=this.$.icon.getValue(),0>=e.length?(this.$.errorMessage.setContent("Category name may not be blank."),this.$.errorMessage.show(),void 0):(this.$.manager.fetchMatchingCount(e,this.rowid,{onSuccess:enyo.bind(this,this.saveFinisher,e)}),void 0)},saveFinisher:function(e,t){return t>0?(this.$.errorMessage.setContent("Category names must be unique."),this.$.errorMessage.show(),void 0):(this.$.errorMessage.hide(),0>this.rowid?this.$.manager.createCategory({name:e,icon:this.icon,color:this.color},{onSuccess:enyo.bind(this,this.doChangeComplete,{action:"new"})}):this.$.manager.editCategory(this.rowid,e,this.icon,this.color,this.name,{onSuccess:enyo.bind(this,this.doChangeComplete,{action:"edit"})}),void 0)}});

// manager.js
enyo.singleton({name:"Checkbook.transactions.manager",kind:"enyo.Component",createTransaction:function(e,t,n){Checkbook.globals.gts_db.query(new gts.databaseQuery({sql:"SELECT ( SELECT IFNULL( MAX( itemId ), 0 ) FROM transactions LIMIT 1 ) AS maxItemId, ( SELECT IFNULL( MAX( repeatId ), 0 ) FROM repeats LIMIT 1 ) AS maxRepeatId;",values:[]}),{onSuccess:enyo.bind(this,this.createTransactionFollower,e,t,n)})},createTransactionFollower:function(e,t,n,i){e.itemId=parseInt(i[0].maxItemId)+1,e.maxRepeatId=parseInt(i[0].maxRepeatId)+1,Checkbook.globals.gts_db.queries(this.generateInsertTransactionSQL({data:e,type:t}),n)},generateInsertTransactionSQL:function(e){var t=enyo.clone(e.data),n=t.autoTransfer,i=t.autoTransferLink,o=this._prepareData(t,e.type);if(o=o.concat(Checkbook.transactions.recurrence.manager.handleRecurrenceSystem(t,n,i)),o=o.concat(this.handleCategoryData(t)),o.push(Checkbook.globals.gts_db.getInsert("transactions",t)),gts.Object.validNumber(t.linkedRecord)&&t.linkedRecord>=0){var s=enyo.clone(t);gts.Object.swap(s,"linkedRecord","itemId"),gts.Object.swap(s,"linkedAccount","account"),s.amount=-s.amount,o.push(Checkbook.globals.gts_db.getInsert("transactions",s))}return n>0&&i>=0&&(o=o.concat(this.createAutoTransfer(t,n,i))),o},createAutoTransfer:function(e,t,n){if(0>=t||0>n)return[];var i=enyo.clone(e);if(i.itemId+=gts.Object.validNumber(i.linkedRecord)&&i.linkedRecord>=0?2:1,i.amount=1===t?i.amount>=0?Math.round(100*Math.ceil(i.amount)-100*i.amount)/100:Math.round(100*Math.floor(i.amount)-100*i.amount)/100:2===t?i.amount>=0?1:-1:0,0==i.amount)return[];i.linkedAccount=n,i.linkedRecord=i.itemId+1,i.note=i.desc,i.desc="Auto Transfer",i.category="Transfer",i.category2="Auto Transfer",delete i.checkNum,delete i.payee;var o=[];return o.push(Checkbook.globals.gts_db.getInsert("transactions",i)),gts.Object.swap(i,"linkedRecord","itemId"),gts.Object.swap(i,"linkedAccount","account"),i.amount=-i.amount,o.push(Checkbook.globals.gts_db.getInsert("transactions",i)),o},updateTransaction:function(e,t,n){Checkbook.globals.gts_db.query(new gts.databaseQuery({sql:"SELECT ( SELECT IFNULL( MAX( itemId ), 0 ) FROM transactions LIMIT 1 ) AS maxItemId, ( SELECT IFNULL( MAX( repeatId ), 0 ) FROM repeats LIMIT 1 ) AS maxRepeatId;",values:[]}),{onSuccess:enyo.bind(this,this.updateTransactionFollower,e,t,n)})},updateTransactionFollower:function(e,t,n,i){if(!e.hasOwnProperty("itemId")||isNaN(e.itemId)||!isFinite(e.itemId)||0>e.itemId)return enyo.isFunction(n.onError)?n.onError(!1):enyo.isFunction(n.onSuccess)&&n.onSuccess(!1),void 0;e.maxItemId=parseInt(i[0].maxItemId)+1,e.maxRepeatId=parseInt(i[0].maxRepeatId)+1;var o=this._prepareData(e,t);if(1!=e.repeatUnlinked&&1!=e.terminated?o=o.concat(Checkbook.transactions.recurrence.manager.handleRecurrenceSystem(e)):(delete e.rObj,delete e.maxItemId,delete e.maxRepeatId),o=o.concat(this.handleCategoryData(e)),o.push(Checkbook.globals.gts_db.getUpdate("transactions",e,{itemId:e.itemId})),gts.Object.validNumber(e.linkedRecord)){var s=enyo.clone(e);gts.Object.swap(s,"linkedRecord","itemId"),gts.Object.swap(s,"linkedAccount","account"),s.amount=-s.amount,delete s.cleared,o.push(Checkbook.globals.gts_db.getUpdate("transactions",s,{itemId:s.itemId}))}Checkbook.globals.gts_db.queries(o,n)},_prepareData:function(e,t){return e.desc=""===e.desc||null===e.desc?"Description":e.desc,e.cleared=e.cleared?1:0,e.amount=Number(e.amount).toFixed(2).valueOf(),e.date=Date.parse(e.date),"transfer"==t?"NOT_A_VALUE"!==e.amount_old&&0>e.amount_old?e.amount=-Math.abs(e.amount):"NOT_A_VALUE"!==e.amount_old&&e.amount_old>=0?e.amount=Math.abs(e.amount):(e.linkedRecord=e.itemId+1,e.amount=-Math.abs(e.amount)):"income"==t?(e.amount=Math.abs(e.amount),e.linkedAccount=null,e.linkedRecord=null):(e.amount=-Math.abs(e.amount),e.linkedAccount=null,e.linkedRecord=null),delete e.amount_old,delete e.autoTransfer,delete e.autoTransferLink,[]},handleCategoryData:function(e){var t=[];if(t.push(new gts.databaseQuery({sql:"DELETE FROM transactionSplit WHERE transId = ? OR transId = ( SELECT itemId FROM transactions WHERE linkedRecord = ? )",values:[e.itemId,e.itemId]})),e.category.length>1){for(var n=0;e.category.length>n;n++)""===e.category[n].amount||isNaN(e.category[n].amount)||(!e.linkedRecord||isNaN(e.linkedRecord)?t.push(Checkbook.globals.gts_db.getInsert("transactionSplit",{genCat:e.category[n].category,specCat:e.category[n].category2,amount:e.category[n].amount,transId:e.itemId})):(t.push(Checkbook.globals.gts_db.getInsert("transactionSplit",{genCat:e.category[n].category,specCat:e.category[n].category2,amount:-e.category[n].amount,transId:e.itemId})),t.push(Checkbook.globals.gts_db.getInsert("transactionSplit",{genCat:e.category[n].category,specCat:e.category[n].category2,amount:e.category[n].amount,transId:e.linkedRecord}))));e.category="||~SPLIT~||",e.category2=""}else 1===e.category.length?(e.category2=e.category[0].category2,e.category=e.category[0].category):(e.category="Uncategorized",e.category2="Other");return t},clearTransaction:function(e,t,n){Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getUpdate("transactions",{cleared:t?1:0},{itemId:e}),n)},deleteTransaction:function(e,t){Checkbook.globals.gts_db.queries([Checkbook.globals.gts_db.getDelete("transactions",{itemId:e}),Checkbook.globals.gts_db.getDelete("transactions",{linkedRecord:e}),new gts.databaseQuery({sql:"DELETE FROM transactionSplit WHERE transId = ? OR transId = ( SELECT itemId FROM transactions WHERE linkedRecord = ? )",values:[e,e]})],t)},fetchTransaction:function(e,t){var n=new gts.databaseQuery({sql:'SELECT DISTINCT main.itemId, main.desc, main.amount, main.note, main.date, main.account, main.linkedRecord, main.linkedAccount, main.cleared, main.repeatId, main.checkNum, main.payee, ( CASE WHEN main.category = \'||~SPLIT~||\' THEN ( \'[\' || IFNULL( ( SELECT GROUP_CONCAT( json ) FROM ( SELECT ( \'{ "category": "\' || ts.genCat || \'", "category2" : "\' || ts.specCat || \'", "amount": "\' || ts.amount || \'" }\' ) AS json FROM transactionSplit ts WHERE ts.transId = main.itemId ORDER BY ts.amount DESC ) ), \'{ "category": "?", "category2" : "?", "amount": "0" }\' ) || \']\' ) ELSE main.category END ) AS category, ( CASE WHEN main.category = \'||~SPLIT~||\' THEN \'PARSE_CATEGORY\' ELSE main.category2 END ) AS category2 FROM transactions main WHERE main.itemId = ? LIMIT 1;',values:[e]});Checkbook.globals.gts_db.query(n,{onSuccess:function(e){enyo.isFunction(t.onSuccess)&&t.onSuccess(e[0])},onError:t.onError})},fetchTransactions:function(e,t,n,i){var o=new gts.databaseQuery({sql:'SELECT DISTINCT main.itemId, main.desc, main.amount, main.note, main.date, main.account, main.linkedRecord, main.linkedAccount, main.cleared, main.repeatId, main.repeatUnlinked, main.checkNum, main.payee, ( CASE WHEN main.category = \'||~SPLIT~||\' THEN ( \'[\' || IFNULL( ( SELECT GROUP_CONCAT( json ) FROM ( SELECT ( \'{ "category": "\' || ts.genCat || \'", "category2" : "\' || ts.specCat || \'", "amount": "\' || ts.amount || \'" }\' ) AS json FROM transactionSplit ts WHERE ts.transId = main.itemId ORDER BY ts.amount DESC ) ), \'{ "category": "?", "category2" : "?", "amount": "0" }\' ) || \']\' ) ELSE main.category END ) AS category, ( CASE WHEN main.category = \'||~SPLIT~||\' THEN \'PARSE_CATEGORY\' ELSE main.category2 END ) AS category2 FROM transactions main WHERE account = ? ORDER BY '+e.sortQry,values:[e.acctId]});n&&(o.sql+=" LIMIT ?",o.values.push(n)),i&&(o.sql+=" OFFSET ?",o.values.push(i)),Checkbook.globals.gts_db.query(o,{onSuccess:enyo.bind(this,this.fetchTransactionsFollower,e,t,n,i)})},fetchTransactionsFollower:function(e,t,n,i,o){if(1===e.runningBalance){var s;s=o.length>0&&!isNaN(o[0].date)?parseInt(o[0].date):Date.parse(new Date);var a=new gts.databaseQuery({sql:"",values:[e.acctId,s]});a.sql=0!==e.sort&&6!==e.sort&&8!==e.sort?"SELECT SUM( amount ) AS balanceToDate FROM transactions WHERE account = ? AND date <= ?;":"SELECT SUM( amount ) AS balanceToDate FROM transactions WHERE account = ? AND date < ?;",Checkbook.globals.gts_db.query(a,{onSuccess:function(e){enyo.isFunction(t.onSuccess)&&t.onSuccess(i,o,e)},onError:t.onError})}else enyo.isFunction(t.onSuccess)&&t.onSuccess(i,o,[])},searchTransactions:function(e,t,n,i,o,s){var a=new gts.databaseQuery({sql:'SELECT DISTINCT main.itemId, main.desc, main.amount, main.note, main.date, main.account, main.linkedRecord, main.linkedAccount, main.cleared, main.repeatId, main.checkNum, main.payee, ( SELECT accts.acctName FROM accounts accts WHERE accts.acctId = main.account ) AS acctName, ( SELECT accts.acctCategory FROM accounts accts WHERE accts.acctId = main.account ) AS acctCategory,IFNULL( ( SELECT accountCategories.icon FROM accountCategories WHERE accountCategories.name = ( SELECT accts.acctCategory FROM accounts accts WHERE accts.acctId = main.account ) ), \'icon_2.png\' ) AS acctCategoryIcon,  ( SELECT accts.showTransTime FROM accounts accts WHERE accts.acctId = main.account ) AS showTransTime, ( SELECT accts.enableCategories FROM accounts accts WHERE accts.acctId = main.account ) AS enableCategories, ( SELECT accts.checkField FROM accounts accts WHERE accts.acctId = main.account ) AS checkField, ( SELECT accts.hideNotes FROM accounts accts WHERE accts.acctId = main.account ) AS hideNotes, ( SELECT accts.frozen FROM accounts accts WHERE accts.acctId = main.account ) AS frozen, ( CASE WHEN main.category = \'||~SPLIT~||\' THEN ( \'[\' || IFNULL( ( SELECT GROUP_CONCAT( json ) FROM ( SELECT ( \'{ "category": "\' || ts.genCat || \'", "category2" : "\' || ts.specCat || \'", "amount": "\' || ts.amount || \'" }\' ) AS json FROM transactionSplit ts WHERE ts.transId = main.itemId ORDER BY ts.amount DESC ) ), \'{ "category": "?", "category2" : "?", "amount": "0" }\' ) || \']\' ) ELSE main.category END ) AS category, ( CASE WHEN main.category = \'||~SPLIT~||\' THEN \'PARSE_CATEGORY\' ELSE main.category2 END ) AS category2 FROM transactions main WHERE '+e+" ORDER BY "+n,values:enyo.clone(t)});o&&(a.sql+=" LIMIT ?",a.values.push(o)),s&&(a.sql+=" OFFSET ?",a.values.push(s)),Checkbook.globals.gts_db.query(a,i)},searchTransactionsCount:function(e,t,n,i){var o=new gts.databaseQuery({sql:"SELECT COUNT( DISTINCT main.itemId ) AS searchCount FROM transactions main WHERE "+e,values:enyo.clone(t)});Checkbook.globals.gts_db.query(o,{onSuccess:function(e){enyo.isFunction(i.onSuccess)&&i.onSuccess(e[0])},onError:i.onError})},fetchTransactionSorting:function(e){Checkbook.globals.gts_db.query("SELECT * FROM acctTrsnSortOptn ORDER BY groupOrder ASC, label",{onSuccess:enyo.bind(this,this.buildTransactionSorting,e)})},buildTransactionSorting:function(e,t){this.log();var n=null;transactionSortOptions=[];for(var i=0;t.length>i;i++){var n=t[i];n&&transactionSortOptions.push({kind:"gts.MenuImageItem",classes:"transactionSortMenuItem",content:n.label,src:"assets/sort_icons/"+n.sortGroup.toLowerCase().replace(" ","")+".png",value:n.sortId,qry:n.qry,sortGroup:n.sortGroup})}enyo.isFunction(e.onSuccess)&&e.onSuccess()},fetchMaxCheckNumber:function(e,t){return gts.Object.isNumber(e)?(Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getSelect("transactions",["MAX( checkNum ) AS maxCheckNum"],{account:e}),{onSuccess:function(e){if(enyo.isFunction(t.onSuccess)){var n=parseInt(e[0].maxCheckNum);isNaN(n)?t.onSuccess(1):t.onSuccess(n+1)}},onError:t.onError}),void 0):(this.log("No account number specified."),enyo.isFunction(t.onError)&&t.onError("No account specified"),void 0)},parseCategoryDB:function(e,t){var n;return"PARSE_CATEGORY"===t?n=enyo.json.parse(e):(""===e&&""===t?(e="Uncategorized",t="Other"):""===t&&(t=e.split("|",2)[1],e=e.split("|",2)[0]),n=[{category:e,category2:t,amount:""}]),n},formatCategoryDisplay:function(e,t,n,i){n=n!==void 0?n:!0,i=i!==void 0?i:"small";var o;if("PARSE_CATEGORY"===t){for(var s=enyo.json.parse(e),a="",r="",c=0;(s.length>3&&n?2:s.length)>c;c++)a+="<div class='cat-item "+i+"'>"+s[c].category+" &raquo; "+s[c].category2+"</div>",r+="<div class='cat-item "+i+"'>"+formatAmount(s[c].amount)+"</div>";o="<div style='margin-bottom: 0.5em;'><div class='splitCatContainer h-box'><div class='categoryGroup'>"+a+"</div>"+"<div class='categoryAmount'>"+r+"</div>"+"</div>"+(s.length>3&&n?"<div class='"+i+"'>+"+(s.length-2)+" more</div>":"")+"</div>"}else""===t&&(t=e.split("|",2)[1],e=e.split("|",2)[0]),o="<span class='"+i+"'>"+e+" >> "+t+"</span>";return""!==e?o:""},determineTransactionType:function(e){var t="income";return gts.Object.validNumber(e.linkedAccount)&&e.linkedAccount>=0&&gts.Object.validNumber(e.linkedRecord)&&e.linkedRecord>=0?t="transfer":0>e.amount&&(t="expense"),t}});

// view.js
enyo.kind({name:"Checkbook.transactions.view",classes:"v-box",account:{},components:[{name:"header",kind:"onyx.Toolbar",layoutKind:"enyo.FittableColumnsLayout",noStretch:!0,components:[{name:"acctTypeIcon",kind:"enyo.Image",src:"assets/dollar_sign_1.png",classes:"img-icon",style:"margin: 0 15px 0 0;"},{name:"loadingSpinner",kind:"onyx.Spinner",showing:!1,classes:"img-icon",style:"margin: 0 15px 0 0;"},{name:"acctName",content:"Checkbook",classes:"enyo-text-ellipsis",fit:!0},{name:"balanceMenu",kind:"Checkbook.balanceMenu",onChange:"handleBalanceButton",style:"padding: 0 8px; margin: 0;"}]},{name:"entries",kind:"Checkbook.transactions.list",fit:!0,classes:"checkbook-stamp box-flex-1",style:"position: relative;",ondragstart:"listDrag",ondrag:"listDrag",ondragfinish:"listDrag",onLoadingStart:"showLoadingIcon",onLoadingFinish:"hideLoadingIcon",onCloneTransaction:"cloneTransaction"},{name:"footer",kind:"Checkbook.MoreToolbar",classes:"deep-green",noStretch:!0,components:[{name:"backButton",kind:"onyx.Button",classes:"padding-none transparent",ontap:"fireBack",components:[{kind:"onyx.Icon",src:"assets/menu_icons/back.png"}]},{kind:"onyx.MenuDecorator",components:[{kind:"onyx.Button",classes:"padding-none transparent",components:[{kind:"onyx.Icon",src:"assets/menu_icons/sort.png"}]},{name:"sortMenu",kind:"gts.SelectedMenu",classes:"bordered-menu",floating:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",onChange:"transactionSortingChanged",style:"min-width: 225px;"}]},{classes:"text-center",style:"min-width: 145px;",fit:!0,unmoveable:!0,components:[{name:"addIncomeButton",kind:"onyx.Button",ontap:"addIncome",classes:"padding-none margin-none transparent",components:[{kind:"onyx.Icon",src:"assets/menu_icons/income.png"}]},{name:"addTransferButton",kind:"onyx.Button",ontap:"addTransfer",classes:"padding-none margin-half-left margin-half-right transparent",components:[{kind:"onyx.Icon",src:"assets/menu_icons/transfer.png"}]},{name:"addExpenseButton",kind:"onyx.Button",ontap:"addExpense",classes:"padding-none margin-none transparent",components:[{kind:"onyx.Icon",src:"assets/menu_icons/expense.png"}]}]},{kind:"onyx.MenuDecorator",components:[{kind:"onyx.Button",classes:"padding-none transparent",components:[{kind:"onyx.Icon",src:"assets/menu_icons/search.png"}]},{kind:"onyx.Menu",floating:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",onSelect:"footerMenuSelected",components:[{kind:"gts.MenuImageItem",content:"Refresh",src:"assets/menu_icons/refresh.png"},{showing:!1,classes:"onyx-menu-divider"},{showing:!1,content:"Purge"},{showing:!1,content:"Combine"},{showing:!1,content:"Clear Multiple"}]}]},{name:"menuButton",kind:"onyx.Button",classes:"padding-none transparent",ontap:"triggerAppMenu",components:[{kind:"onyx.Icon",src:"assets/menu_icons/menu.png"}]}]},{name:"loadingScrim",kind:"onyx.Scrim",classes:"onyx-scrim-translucent",style:"z-index: 1000;",components:[{kind:"onyx.Spinner",style:"size-double",style:"position: absolute; top: 50%; margin-top: -45px; left: 50%; margin-left: -45px;"}]},{kind:"Signals",viewAccount:"viewAccount",accountChanged:"accountChanged",accountBalanceChanged:"balanceChanged"}],rendered:function(){this.inherited(arguments),this.$.header.hide(),this.$.footer.hide()},listDrag:function(e,t){return t.preventDefault(),!0},accountChanged:function(e,t){t&&t.deleted&&this.getAccountId()===t.accountId?this.unloadSystem():this.reloadSystem()},viewAccount:function(e,t){this.showLoadingScrim(),enyo.asyncMethod(this,this._viewAccount,e,t)},_viewAccount:function(e,t){return t.account&&t.account.acctId?(this.adjustViewForScreenSize(),this.account.acctId||(this.$.header.show(),this.$.footer.show()),(t.force||!this.account.acctId||this.account.acctId!==t.account.acctId)&&(this.account=enyo.clone(t.account),this.$.entries.account=enyo.clone(this.account),this.$.entries.initialScrollCompleted=!1,this.$.acctName.setContent(this.account.acctName),this.$.acctTypeIcon.setSrc("assets/"+this.account.acctCategoryIcon),this.renderBalanceButton(),this.renderSortButton(),this.$.entries.reloadSystem(),1===this.account.frozen?(this.$.addIncomeButton.setDisabled(!0),this.$.addTransferButton.setDisabled(!0),this.$.addExpenseButton.setDisabled(!0)):(this.$.addIncomeButton.setDisabled(!1),this.$.addTransferButton.setDisabled(!1),this.$.addExpenseButton.setDisabled(!1))),this.$.header.reflow(),this.$.footer.reflow(),this.reflow(),enyo.asyncMethod(this,this.hideLoadingScrim),void 0):(this.unloadSystem(),void 0)},resized:function(){this.inherited(arguments),this.adjustViewForScreenSize()},adjustViewForScreenSize:function(){this.$.backButton.setShowing(enyo.Panels.isScreenNarrow()),this.$.menuButton.setShowing(enyo.Panels.isScreenNarrow())},getAccountId:function(){return this.account.acctId},setAccountIndex:function(e){this.account.index=e},unloadSystem:function(){this.account={},this.$.entries.unloadSystem(),this.$.header.hide(),this.$.footer.hide()},reloadSystem:function(){return!this.account.acctId||0>this.account.acctId?(this.log("System not ready yet"),!1):(this.$.entries.reloadSystem(),this.balanceChanged(),void 0)},balanceChanged:function(e,t){var n={sendSignal:!1};if(t&&t.accounts&&t.accounts.account?enyo.mixin(n,t.accounts):n.account=this.account.acctId,n.accountBal!==void 0&&4===n.accountBal.length){var i={balance0:n.accountBal[0],balance1:n.accountBal[1],balance2:n.accountBal[2],balance3:n.accountBal[3]};this.balanceChangedHandler(n,i)}else this.balanceChangedHandler(n)},balanceChangedHandler:function(e,t){return e||(e={account:this.account.acctId,linkedAccount:-1}),t?(this.account.balance0=prepAmount(t.balance0),this.account.balance1=prepAmount(t.balance1),this.account.balance2=prepAmount(t.balance2),this.account.balance3=prepAmount(t.balance3),this.renderBalanceButton(),e.accountBal=e.account==this.account.acctId?{balance0:this.account.balance0,balance1:this.account.balance1,balance2:this.account.balance2,balance3:this.account.balance3}:{},(void 0===e.sendSignal||e.sendSignal!==!1)&&enyo.Signals.send("accountBalanceChanged",{accounts:e}),void 0):(Checkbook.accounts.manager.fetchAccountBalance(this.account.acctId,{onSuccess:enyo.bind(this,this.balanceChangedHandler,e)}),void 0)},renderBalanceButton:function(){this.$.balanceMenu.setChoices([{content:"Available:",balance:this.account.balance0,value:0},{content:"Cleared:",balance:this.account.balance1,value:1},{content:"Pending:",balance:this.account.balance3,value:3},{content:"Final:",balance:this.account.balance2,value:2}]),this.$.balanceMenu.setValue(this.account.bal_view),this.$.header.reflow()},handleBalanceButton:function(e,t){return this.account.bal_view===t.value?!0:(this.account.bal_view=t.value,Checkbook.accounts.manager.updateAccountBalView(this.account.acctId,this.account.bal_view,{onSuccess:enyo.bind(this,this.renderBalanceButton)}),enyo.Signals.send("balanceViewChanged",{index:this.account.index,id:this.account.acctId,mode:this.account.bal_view,callbackFn:enyo.bind(this,this.setAccountIndex)}),!0)},triggerAppMenu:function(e,t){return enyo.Signals.send("onmenubutton",t),!0},showLoadingIcon:function(){this.$.acctTypeIcon.hide(),this.$.loadingSpinner.show()},hideLoadingIcon:function(){this.$.loadingSpinner.hide(),this.$.acctTypeIcon.show()},showLoadingScrim:function(){this.$.loadingScrim.show()},hideLoadingScrim:function(){this.$.loadingScrim.hide()},fireBack:function(){return enyo.Signals.send("onbackbutton"),!0},renderSortButton:function(){0>=transactionSortOptions.length?Checkbook.transactions.manager.fetchTransactionSorting({onSuccess:enyo.bind(this,this.buildTransactionSorting)}):this.buildTransactionSorting()},buildTransactionSorting:function(){enyo.isArray(transactionSortOptions)&&(this.$.sortMenu.setChoices(transactionSortOptions),this.$.sortMenu.setValue(this.account.sort))},transactionSortingChanged:function(e,t){return this.account.sort===t.value?!0:(this.account.sort=t.value,this.account.sortQry=t.qry,Checkbook.accounts.manager.updateAccountSorting(this.account.acctId,this.account.sort),this.$.entries.account=enyo.clone(this.account),this.$.entries.reloadSystem(),!0)},addIncome:function(){this.newTransaction("Income")},addTransfer:function(){this.newTransaction("Transfer")},addExpense:function(){this.newTransaction("Expense")},footerMenuSelected:function(e,t){if("refresh"===t.content.toLowerCase()){var n=this.account.acctId;this.$.entries.rememberScrollPosition(),Checkbook.transactions.recurrence.manager.updateSeriesTransactions(n,{onSuccess:function(){Checkbook.accounts.manager.fetchAccount(n,{onSuccess:function(e){enyo.Signals.send("viewAccount",{account:e,force:!0})}})}})}else"budget"===t.content.toLowerCase()?this.log("Budget system go"):"reports"===t.content.toLowerCase()?this.log("Report system go"):"search"===t.content.toLowerCase()?enyo.Signals.send("showSearch",{acctId:this.account.acctId,index:this.account.index}):this.log(t.selected);return!0},newTransaction:function(e){this.cloneTransaction(null,{data:{},type:e.toLowerCase()})},cloneTransaction:function(e,t){this.$.addIncomeButton.getDisabled()||this.$.addTransferButton.getDisabled()||this.$.addExpenseButton.getDisabled()||(this.toggleCreateButtons(),enyo.Signals.send("showPanePopup",{name:"createTransaction",kind:"Checkbook.transactions.modify",accountObj:this.account,trsnObj:t.data,transactionType:t.type,onFinish:enyo.bind(this,this.addTransactionComplete)}))},addTransactionComplete:function(e,t){1===t.modifyStatus&&(delete t.modifyStatus,this.balanceChangedHandler(t),this.account.itemCount++,this.$.entries.setItemCount(this.account.itemCount),this.$.entries.reloadSystem()),this.toggleCreateButtons()},toggleCreateButtons:function(){this.$.addIncomeButton.getDisabled()?(this.$.addIncomeButton.setDisabled(!1),this.$.addTransferButton.setDisabled(!1),this.$.addExpenseButton.setDisabled(!1)):(this.$.addIncomeButton.setDisabled(!0),this.$.addTransferButton.setDisabled(!0),this.$.addExpenseButton.setDisabled(!0))}});

// list.js
enyo.kind({name:"Checkbook.transactions.list",transactions:[],account:{},initialScrollCompleted:!1,savedScrollPosition:!1,events:{onLoadingStart:"",onLoadingFinish:"",onCloneTransaction:""},components:[{name:"list",kind:"gts.LazyList",classes:"checkbook-stamp enyo-fit",reorderable:!1,enableSwipe:!1,touchOverscroll:!1,onSetupItem:"transactionBuildRow",onAcquirePage:"transactionFetchGroup",onReorder:"",onSetupReorderComponents:"",onSetupPinnedReorderComponents:"",onSetupSwipeItem:"",onSwipeComplete:"",aboveComponents:[],components:[{name:"transactionWrapper",kind:"gts.Item",tapHighlight:!0,holdHighlight:!1,ontap:"transactiontapped",onhold:"transactionHeld",classes:"bordered",style:"padding-right: 20px; padding-left: 30px;",components:[{name:"mainBody",classes:"transaction-item-top h-box",components:[{classes:"box-flex-1",components:[{name:"desc",classes:"description text-ellipsis bold",allowHtml:!0},{name:"time",classes:"date smaller"}]},{classes:"margin-left text-top",components:[{classes:"amount-block text-right",components:[{name:"amount"},{name:"runningBal"}]},{name:"cleared",ontap:"transactionCleared",classes:"onyx-checkbox checkbox-clone margin-left"}]}]},{name:"category",allowHtml:!0},{name:"checkNum",classes:"smaller"},{name:"payee",classes:"smaller"},{name:"note",classes:"smaller",allowHtml:!0}]}],belowComponents:[{content:"&nbsp;",allowHtml:!0}],reorderComponents:[],pinnedReorderComponents:[],swipeableComponents:[]},{name:"transactonMenu",kind:"gts.EventMenu",showOnTop:!0,floating:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",onSelect:"transactionHeldHandler",components:[{name:"tmClear",content:"Clear",value:"clear",classes:"bordered"},{content:"Edit",value:"edit",classes:"bordered"},{content:"Duplicate",value:"duplicate",classes:"bordered"},{content:"Delete",value:"delete",classes:"bordered"}]},{name:"viewSingle",kind:"Checkbook.transactions.viewSingle",onClear:"vsCleared",onEdit:"vsEdit",onDelete:"transactionDeleted"}],constructor:function(){this.inherited(arguments),this.bound={transactionFetchGroupHandler:enyo.bind(this,this.transactionFetchGroupHandler),initialScroll:enyo.bind(this,this._initialScroll),initialScrollHandler:enyo.bind(this,this.initialScrollHandler),moveToSavedScrollPosition:enyo.bind(this,this.moveToSavedScrollPosition)}},accountChanged:function(e,t){this.log(),t&&t.deleted&&this.getAccountId()===t.accountId?this.unloadSystem():this.reloadSystem()},unloadSystem:function(){this.log(),this.account={},this.$.list.setCount(0),this.$.list.reset()},reloadSystem:function(){return this.log(),!this.account.acctId||0>this.account.acctId?(this.log("System not ready yet"),!1):(this.savedScrollPosition===!1&&(this.initialScrollCompleted=!1),this.reloadTransactionList(),void 0)},setItemCount:function(e){Number.isFinite(e)&&(this.account.itemCount=e)},reloadTransactionList:function(){return this.log(),!this.account.acctId||0>this.account.acctId?!1:(this.transactions=[],this.$.list.setCount(0),this.$.list.reset(),this.$.list.lazyLoad(),void 0)},initialScroll:function(){this.startJob("initialScroll",this.bound.initialScroll,100)},_initialScroll:function(){if(0>=this.$.list.getCount())return this.log("empty list"),void 0;if(0!==this.account.sort&&1!==this.account.sort&&6!==this.account.sort&&7!==this.account.sort)return this.$.list.scrollToRow(0),void 0;var e=new Date;1!==this.account.showTransTime&&e.setHours(23,59,59,999),e=Date.parse(e);var t=null;switch(this.account.sort){case 0:t=new gts.databaseQuery({sql:"SELECT DISTINCT COUNT( itemId ) AS itemIndex FROM transactions main WHERE account = ? AND CAST( date AS INTEGER ) <= ? ORDER BY date ASC, itemId ASC;",values:[this.account.acctId,e]});break;case 1:t=new gts.databaseQuery({sql:"SELECT DISTINCT COUNT( itemId ) AS itemIndex FROM transactions main WHERE account = ? AND CAST( date AS INTEGER ) <= ? ORDER BY date DESC, itemId DESC;",values:[this.account.acctId,e]});break;case 6:t=new gts.databaseQuery({sql:"SELECT DISTINCT COUNT( itemId ) AS itemIndex FROM transactions main WHERE account = ? AND cleared = 1;",values:[this.account.acctId]});break;case 7:t=new gts.databaseQuery({sql:"SELECT DISTINCT COUNT( itemId ) AS itemIndex FROM transactions main WHERE account = ? AND cleared = 0;",values:[this.account.acctId]})}if(t){var n={onSuccess:this.bound.initialScrollHandler};Checkbook.globals.gts_db.query(t,n)}},initialScrollHandler:function(e){var t=0;t=1===this.account.sort?this.account.itemCount-e[0].itemIndex-3:e[0].itemIndex-3,t=t>=0?t:0,this.$.list.scrollToRow(t)},rememberScrollPosition:function(){this.savedScrollPosition=this.$.list.getScrollPosition()},moveToSavedScrollPosition:function(){this.$.list.setScrollPosition(this.savedScrollPosition),this.savedScrollPosition=!1},transactionBuildRow:function(e,t){var n=t.index,i=this.transactions[n];if(i){this.$.transactionWrapper.addRemoveClass("alt-row",0===n%2),this.$.transactionWrapper.addRemoveClass("norm-row",0!==n%2),this.$.desc.setContent(i.desc);var o=new Date(parseInt(i.date));this.$.time.setContent(o.format({date:enyo.Panels.isScreenNarrow()?"short":"long",time:1===this.account.showTransTime?"short":""}));var s=new Date;1!==this.account.showTransTime&&s.setHours(23,59,59,999),this.$.transactionWrapper.addRemoveClass("futureTransaction",i.date>Date.parse(s)),this.$.amount.setContent(formatAmount(i.amount)),i.dispRunningBalance?(this.$.runningBal.setContent(formatAmount(i.runningBalance)),this.$.runningBal.addRemoveClass("positiveBalance",i.runningBalance>0),this.$.runningBal.addRemoveClass("negativeBalance",0>i.runningBalance),this.$.runningBal.addRemoveClass("neutralBalance",0==i.runningBalance),this.$.amount.setClassAttribute("")):(this.$.runningBal.setContent(""),this.$.amount.addRemoveClass("positiveBalance",i.amount>0),this.$.amount.addRemoveClass("negativeBalance",0>i.amount),this.$.amount.addRemoveClass("neutralBalance",0==i.amount)),this.$.cleared.addRemoveClass("checked",1===i.cleared),1===this.account.enableCategories?(this.$.category.show(),this.$.category.setContent(Checkbook.transactions.manager.formatCategoryDisplay(i.category,i.category2,!0,"smaller"))):this.$.category.hide(),this.$.checkNum.setContent(1===this.account.checkField&&i.checkNum&&""!==i.checkNum?"Check #"+i.checkNum:""),this.$.payee.setContent(1===this.account.payeeField&&i.payee&&""!==i.payee?"Payee: "+i.payee:""),this.$.note.setContent((1===this.account.hideNotes?"":i.note).replace(/\n/g,"<br />"));var a=i.linkedRecord&&!isNaN(i.linkedRecord)&&""!=i.linkedRecord,r=i.repeatId&&!isNaN(i.repeatId)&&""!=i.repeatId&&i.repeatId>=0;return this.$.mainBody.addRemoveClass("repeatTransferIcon",a&&r),this.$.mainBody.addRemoveClass("transferIcon",a&&!r),this.$.mainBody.addRemoveClass("repeatIcon",!a&&r),!0}},transactionFetchGroup:function(e,t){var n=t.page*t.pageSize;return!this.account.acctId||0>this.account.acctId?(this.log("System not ready yet"),!1):n>=0&&this.account.itemCount>=this.$.list.getCount()&&!this.transactions[n]?(this.doLoadingStart(),enyo.asyncMethod(this,this._transactionFetchGroup,t.pageSize,n),!0):!1},_transactionFetchGroup:function(e,t){Checkbook.transactions.manager.fetchTransactions(this.account,{onSuccess:this.bound.transactionFetchGroupHandler},e,t)},transactionFetchGroupHandler:function(e,t,n){var i=0;n.length>0&&(e>0||"0"!==this.account.sort&&"6"!==this.account.sort&&"8"!==this.account.sort)&&(i=n[0].balanceToDate);for(var o=1===this.account.runningBalance&&(0===this.account.sort||1===this.account.sort||6===this.account.sort||7===this.account.sort||8===this.account.sort),s=0;t.length>s;s++)(0===this.account.sort||6===this.account.sort||8===this.account.sort)&&(i+=t[s].amount),this.transactions[e+s]=enyo.mixin({dispRunningBalance:o,runningBalance:prepAmount(i),amount:prepAmount(t[s].amount)},t[s]),this.transactions[e+s].desc=gts.String.dirtyString(this.transactions[e+s].desc),this.transactions[e+s].category=gts.String.dirtyString(this.transactions[e+s].category),this.transactions[e+s].category2=gts.String.dirtyString(this.transactions[e+s].category2),this.transactions[e+s].note=gts.String.dirtyString(this.transactions[e+s].note),0!==this.account.sort&&6!==this.account.sort&&8!==this.account.sort&&(i-=this.transactions[e+s].amount);this.$.list.setCount(this.transactions.length),this.$.list.refresh(),this.initialScrollCompleted?this.savedScrollPosition&&this.startJob("moveToSavedScrollPosition",this.bound.moveToSavedScrollPosition,1e3):(this.initialScrollCompleted=!0,this.initialScroll()),enyo.asyncMethod(this,this.doLoadingFinish)},duplicateTransaction:function(e){var t=enyo.clone(this.transactions[e]),n="income";gts.Object.validNumber(t.linkedRecord)&&t.linkedRecord>=0?n="transfer":0>t.amount&&(n="expense"),delete t.date,delete t.itemId,delete t.linkedRecord,delete t.repeatId,delete t.cleared,this.doCloneTransaction({data:t,type:n.toLowerCase()})},transactiontapped:function(e,t){return 1===Checkbook.globals.prefs.transPreview?(this.$.viewSingle.setIndex(t.rowIndex),this.$.viewSingle.setTransaction(this.transactions[t.rowIndex]),this.$.viewSingle.setAccount(this.account),enyo.asyncMethod(this.$.viewSingle,this.$.viewSingle.show)):enyo.asyncMethod(this,this.vsEdit,null,t),!0},vsEdit:function(e,t){this.log(),1!==this.account.frozen&&enyo.Signals.send("showPanePopup",{name:"editTransaction",kind:"Checkbook.transactions.modify",accountObj:this.account,trsnObj:enyo.clone(this.transactions[t.rowIndex]),transactionType:"",onFinish:enyo.bind(this,this.modifyTransactionComplete,t.rowIndex)})},modifyTransactionComplete:function(e,t,n){var i=n.modifyStatus;delete n.modifyStatus,1==i?(enyo.Signals.send("accountBalanceChanged",{accounts:n}),this.reloadTransactionList(),enyo.asyncMethod(this.$.list,this.$.list.scrollToRow,e)):2==i&&(enyo.Signals.send("accountBalanceChanged",{accounts:n}),this.account.itemCount--,this.reloadTransactionList(),enyo.asyncMethod(this.$.list,this.$.list.scrollToRow,e-1))},transactionHeld:function(e,t){1!==this.account.frozen&&(1===this.transactions[t.index].cleared?this.$.tmClear.setContent("Unclear"):this.$.tmClear.setContent("Clear"),this.$.transactonMenu.rowIndex=t.index,this.$.transactonMenu.showAtEvent(t))},transactionHeldHandler:function(e,t){var n=this.$.transactonMenu.rowIndex;if(gts.Object.validNumber(n)&&!(0>n)&&t.selected)return"clear"===t.selected.value?enyo.asyncMethod(this,this.vsCleared,null,{rowIndex:n}):"edit"===t.selected.value?enyo.asyncMethod(this,this.vsEdit,null,{rowIndex:n}):"duplicate"===t.selected.value?this.duplicateTransaction(n):"delete"===t.selected.value&&enyo.asyncMethod(this,this.confirmDeletion,n),!0},transactionCleared:function(e,t){return this.vsCleared(null,t),t.preventDefault(),!0},vsCleared:function(e,t){var n=t.rowIndex;if(this.transactions[n]){if(1===this.account.frozen)return this.$.list.refresh(),void 0;var i=1!==this.transactions[n].cleared;return this.transactions[n].cleared=i?1:0,this.$.list.renderRow(n),enyo.asyncMethod(this,this.transactionClearedDatabaseUpdate,t,n,i),!0}},transactionClearedDatabaseUpdate:function(e,t,n){Checkbook.transactions.manager.clearTransaction(this.transactions[t].itemId,n),enyo.Signals.send("accountBalanceChanged",{accounts:{account:this.transactions[t].account,linkedAccount:this.transactions[t].linkedAccount}}),enyo.isFunction(e.callback)&&e.callback(n)},confirmDeletion:function(e){this.transactions[e].repeatId>0||0===this.transactions[e].repeatId?this.createComponent({name:"deleteTransactionConfirm",kind:"Checkbook.transactions.recurrence.delete",transactionId:this.transactions[e].itemId,recurrenceId:this.transactions[e].repeatId,rowIndex:e,onFinish:"deleteTransactionHandler",onCancel:"deleteTransactionConfirmClose"}):this.createComponent({name:"deleteTransactionConfirm",kind:"gts.ConfirmDialog",title:"Delete Transaction",message:"Are you sure you want to delete this transaction?",confirmText:"Delete",confirmClass:"onyx-negative",cancelText:"Cancel",cancelClass:"",rowIndex:e,onConfirm:"deleteTransactionHandler",onCancel:"deleteTransactionConfirmClose"}),this.$.deleteTransactionConfirm.show()},deleteTransactionConfirmClose:function(){this.$.deleteTransactionConfirm.hide(),this.$.deleteTransactionConfirm.destroy()},deleteTransactionHandler:function(){this.transactionDeleted(null,{rowIndex:this.$.deleteTransactionConfirm.rowIndex}),enyo.asyncMethod(this,this.deleteTransactionConfirmClose)},transactionDeleted:function(e,t){this.log();var n=t.rowIndex;if(1===this.account.frozen)return this.$.list.setCount(this.transactions.length),this.$.list.refresh(),void 0;var i={account:this.transactions[n].account,linkedAccount:this.transactions[n].linkedAccount};if(Checkbook.transactions.manager.deleteTransaction(this.transactions[n].itemId),t.recurrence)return enyo.Signals.send("accountBalanceChanged",{accounts:i}),this.reloadTransactionList(),void 0;var o=this.transactions[n].amount;if(this.transactions.splice(n,1),1===this.account.runningBalance&&(0===this.account.sort||1===this.account.sort||6===this.account.sort||7===this.account.sort||8===this.account.sort)){if(0===n)return enyo.Signals.send("accountBalanceChanged",{accounts:i}),this.reloadTransactionList(),void 0;for(var s=n>this.$.list.getPageSize()?n-this.$.list.getPageSize():0,a=n+this.$.list.getPageSize()<this.transactions.length?n+this.$.list.getPageSize():this.transactions.length,r=s,c=this.transactions[r].runningBalance-o;a>r&&this.transactions[r];)(0===this.account.sort||6===this.account.sort||8===this.account.sort)&&(c+=this.transactions[r].amount),this.transactions[r].runningBalance=prepAmount(c),0!==this.account.sort&&6!==this.account.sort&&8!==this.account.sort&&(c-=this.transactions[r].amount),r++}this.$.list.setCount(this.transactions.length),this.$.list.refresh(),Checkbook.transactions.manager.fetchTransactions(this.account,{onSuccess:this.bound.transactionFetchGroupHandler},1,this.transactions.length),enyo.Signals.send("accountBalanceChanged",{accounts:i})}});

// single.js
enyo.kind({name:"Checkbook.transactions.viewSingle",kind:"onyx.Popup",classes:"large-popup",modal:!0,centered:!0,floating:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",autoDismiss:!0,published:{index:-1,account:null,transaction:null},events:{onClear:"",onEdit:"",onDelete:""},components:[{content:"Transaction Details",classes:"biggest bold text-center padding-half-bottom"},{name:"scroller",kind:"enyo.Scroller",horizontal:"hidden",classes:"light popup-scroller",components:[{kind:"onyx.Groupbox",components:[{name:"desc",classes:"bordered bigger padding-std",style:"min-height: 65px;"},{kind:"enyo.FittableColumns",noStretch:!0,classes:"bordered padding-std text-middle",components:[{classes:"img-icon margin-half-right",style:"overflow: hidden;",components:[{name:"transTypeIcon",kind:"enyo.Image",style:"width: 32px; height: 64px;"}]},{name:"amount",classes:"big",fit:!0},{content:"amount",classes:"label"}]},{name:"fromAccountHolder",kind:"enyo.FittableColumns",noStretch:!0,classes:"expenseIcon custom-background bordered padding-std padding-left text-middle",components:[{name:"fromAccountImg",kind:"enyo.Image",classes:"img-icon margin-right"},{name:"fromAccount",fit:!0},{content:"from",classes:"label"}]},{name:"toAccountHolder",kind:"enyo.FittableColumns",noStretch:!0,classes:"incomeIcon custom-background bordered padding-std padding-left text-middle",components:[{name:"toAccountImg",kind:"enyo.Image",classes:"img-icon margin-right"},{name:"toAccount",fit:!0},{content:"to",classes:"label"}]},{kind:"enyo.FittableColumns",noStretch:!0,classes:"bordered padding-std text-middle",components:[{kind:"enyo.Image",src:"assets/calendar.png",classes:"img-icon margin-right"},{name:"time"}]},{name:"recurrenceWrapper",kind:"enyo.FittableColumns",noStretch:!0,classes:"bordered padding-std text-middle",components:[{kind:"enyo.Image",src:"assets/repeat.png",classes:"img-icon margin-right"},{name:"recurrenceDisplay",fit:!0}]},{name:"categoryHolder",kind:"enyo.FittableColumns",noStretch:!0,classes:"bordered padding-std text-middle",components:[{name:"category",allowHtml:!0,fit:!0},{content:"category",classes:"label"}]},{name:"checkNumHolder",kind:"enyo.FittableColumns",noStretch:!0,classes:"bordered padding-std text-middle",components:[{name:"checkNum",fit:!0},{content:"check number",classes:"label"}]},{name:"payeeHolder",kind:"enyo.FittableColumns",noStretch:!0,classes:"bordered padding-std text-middle",components:[{name:"payee",fit:!0},{content:"payee",classes:"label"}]},{name:"cleared",kind:"gts.ToggleBar",classes:"bordered",label:"Cleared",sublabel:"",onContent:"Cleared",offContent:"Pending",onChange:"clearToggled"},{name:"noteHolder",kind:"enyo.FittableColumns",noStretch:!0,classes:"bordered padding-std text-top",components:[{name:"note",allowHtml:!0,fit:!0},{content:"note",classes:"label"}]}]}]},{classes:"padding-std text-center h-box pack-center",components:[{name:"btnCancel",kind:"onyx.Button",content:"Close",ontap:"hide",classes:"margin-right box-flex"},{name:"btnDelete",kind:"onyx.Button",content:"Delete",ontap:"deleteClicked",classes:"onyx-negative box-flex"},{name:"btnEdit",kind:"onyx.Button",content:"Edit",ontap:"editClicked",classes:"tardis-blue margin-left box-flex"}]}],constructor:function(){this.log(),this.inherited(arguments),this._binds={renderFromAccount:enyo.bind(this,this.renderFromAccount),renderToAccount:enyo.bind(this,this.renderToAccount)}},show:function(e){if(this.log(),e)this.inherited(arguments);else{if(!this.account.acctId)return this.hide(),void 0;var t=0;for(var n in this.account)this.account.hasOwnProperty(n)&&t++;var i=enyo.bind(this,this.inherited,arguments);5>=t?Checkbook.accounts.manager.fetchAccount(this.account.acctId,{onSuccess:enyo.bind(this,this.loadAccount,i)}):this.renderDisplay(i)}},reflow:function(){this.log(),this.$.scroller.applyStyle("height",null),this.inherited(arguments);var e=this.$.scroller.getBounds();e&&this.$.scroller.applyStyle("height",e.height+"px")},hide:function(e){if(this.log(),!e){for(var t=0;appColors.length>t;t++)this.$.desc.removeClass(appColors[t].name),this.$.toAccountHolder.removeClass(appColors[t].name),this.$.fromAccountHolder.removeClass(appColors[t].name);this.$.desc.removeClass("custom-background legend")}this.inherited(arguments)},loadAccount:function(e,t){this.log(),this.account=t,this.renderDisplay(e)},renderDisplay:function(e){this.log(),1===this.account.frozen?(this.$.btnEdit.hide(),this.$.btnDelete.hide()):(this.$.btnEdit.show(),this.$.btnDelete.show()),this.$.desc.addRemoveClass("custom-background legend "+this.account.acctCategoryColor,1===Checkbook.globals.prefs.dispColor),this.$.desc.setContent(this.transaction.desc),this.transactionType=Checkbook.transactions.manager.determineTransactionType(this.transaction),this.$.transTypeIcon.setSrc("assets/menu_icons/"+this.transactionType+".png"),this.$.amount.setContent(formatAmount(Math.abs(this.transaction.amount))),"transfer"===this.transactionType?(this.$.fromAccountHolder.show(),this.$.toAccountHolder.show(),0>this.transaction.amount?(this._binds.renderFromAccount(this.account),Checkbook.accounts.manager.fetchAccount(this.transaction.linkedAccount,{onSuccess:this._binds.renderToAccount})):(Checkbook.accounts.manager.fetchAccount(this.transaction.linkedAccount,{onSuccess:this._binds.renderFromAccount}),this._binds.renderToAccount(this.account))):(this.$.fromAccountHolder.hide(),this.$.toAccountHolder.hide());var t=new Date(parseInt(this.transaction.date));this.$.time.setContent(t.format({date:"long",time:1===this.account.showTransTime?"short":""})),1===this.account.enableCategories?(this.$.categoryHolder.show(),this.$.category.setContent(Checkbook.transactions.manager.formatCategoryDisplay(this.transaction.category,this.transaction.category2,!1,""))):this.$.categoryHolder.hide(),1===this.account.checkField&&this.transaction.checkNum&&""!==this.transaction.checkNum?(this.$.checkNumHolder.show(),this.$.checkNum.setContent("#"+this.transaction.checkNum)):(this.$.checkNumHolder.hide(),this.$.checkNum.setContent("")),this.$.cleared.setValue(1==this.transaction.cleared),1===this.account.payeeField&&this.transaction.payee&&""!==this.transaction.payee?(this.$.payeeHolder.show(),this.$.payee.setContent(this.transaction.payee)):this.$.payeeHolder.hide(),""!=this.transaction.note?(this.$.noteHolder.show(),this.$.note.setContent(this.transaction.note.replace(/\n/g,"<br />"))):this.$.noteHolder.hide(),this.transaction.repeatId&&!isNaN(this.transaction.repeatId)&&""!=this.transaction.repeatId&&this.transaction.repeatId>=0?Checkbook.transactions.recurrence.manager.fetchSummary(this.transaction.repeatId,{onSuccess:enyo.bind(this,this.renderRecurrence,e)}):this.renderRecurrence(e,[])},renderRecurrence:function(e,t){t&&t.length>0?(this.$.recurrenceWrapper.show(),this.$.recurrenceDisplay.setContent(t)):this.$.recurrenceWrapper.hide(),e()},renderFromAccount:function(e){this.$.fromAccountImg.setSrc("assets/"+e.acctCategoryIcon),this.$.fromAccount.setContent(e.acctName),1===Checkbook.globals.prefs.dispColor?this.$.fromAccountHolder.addClass(e.acctCategoryColor):this.$.fromAccountHolder.removeClass("custom-background")},renderToAccount:function(e){this.$.toAccountImg.setSrc("assets/"+e.acctCategoryIcon),this.$.toAccount.setContent(e.acctName),1===Checkbook.globals.prefs.dispColor?this.$.toAccountHolder.addClass(e.acctCategoryColor):this.$.toAccountHolder.removeClass("custom-background")},clearToggled:function(){return this.doClear({rowIndex:this.index,callback:enyo.bind(this,this.clearToggledHandler)}),!0},clearToggledHandler:function(e){return this.$.cleared.setValue(e),!0},editClicked:function(){this.doEdit({rowIndex:this.index}),enyo.asyncMethod(this,this.hide)},deleteClicked:function(){this.transaction.repeatId>0||0===this.transaction.repeatId?this.createComponent({name:"deleteTransactionConfirm",kind:"Checkbook.transactions.recurrence.delete",transactionId:this.transaction.itemId,recurrenceId:this.transaction.repeatId,onFinish:"deleteTransactionHandler",onCancel:"deleteTransactionConfirmClose"}):this.createComponent({name:"deleteTransactionConfirm",kind:"gts.ConfirmDialog",title:"Delete Transaction",message:"Are you sure you want to delete this transaction?",confirmText:"Delete",confirmClass:"onyx-negative",cancelText:"Cancel",cancelClass:"",onConfirm:"deleteTransactionHandler",onCancel:"deleteTransactionConfirmClose"}),this.hide(!0),this.$.deleteTransactionConfirm.show()},deleteTransactionConfirmClose:function(){this.$.deleteTransactionConfirm.hide(),this.$.deleteTransactionConfirm.destroy(),this.show(!0)},deleteTransactionHandler:function(){this.deleteTransactionConfirmClose(),this.doDelete({rowIndex:this.index,recurrence:this.transaction.repeatId>0||0===this.transaction.repeatId}),enyo.asyncMethod(this,this.hide)}});

// modify.js
enyo.kind({name:"Checkbook.transactions.modify",kind:"FittableRows",classes:"enyo-fit",style:"height: 100%;",accountList:[],renderCategories:!1,published:{accountObj:{},trsnObj:{},transactionType:""},events:{onFinish:""},components:[{kind:"onyx.Toolbar",classes:"text-center",components:[{name:"transTypeText",content:"Modify Transaction",classes:"bigger"}]},{kind:"enyo.Scroller",horizontal:"hidden",classes:"deep-green-gradient",fit:!0,components:[{classes:"light narrow-column",style:"min-height: 100%;",components:[{kind:"onyx.Groupbox",classes:"padding-half-top padding-half-bottom",components:[{name:"autocomplete",kind:"Checkbook.transactions.autocomplete",onValueChanged:"descAutoSuggestMade",components:[{name:"desc",kind:"onyx.Input",placeholder:"Enter Description",onkeypress:"descKeyPress",autoKeyModifier:"shift-single"}]},{kind:"onyx.InputDecorator",layoutKind:"FittableColumnsLayout",noStretch:!0,components:[{name:"transTypeIcon",kind:"onyx.Icon",ontap:"amountTypeChanged",classes:"margin-right"},{name:"amount",kind:"gts.DecimalInput",fit:!0,placeholder:"0.00"},{content:"Amount",classes:"label"}]},{name:"account",kind:"gts.SelectorBar",label:"Account",onChange:"accountChanged",classes:"custom-background bordered",menuClasses:"onyx-menu-wider"},{name:"linkedAccount",kind:"gts.SelectorBar",label:"Transfer To...",onChange:"linkedAccountChanged",classes:"custom-background",menuClasses:"onyx-menu-wider"}]},{kind:"onyx.Groupbox",classes:"padding-half-top padding-half-bottom",components:[{kind:"onyx.GroupboxHeader",content:"Date",classes:"padding-std"},{kind:"enyo.FittableColumns",noStretch:!0,classes:"padding-std",ontap:"toggleDateDrawer",components:[{kind:"enyo.Image",src:"assets/calendar.png",classes:"img-icon",style:"margin-right: 1em;"},{name:"dateDisplay",style:"margin-top: 2px;",fit:!0},{name:"dateArrow",classes:"arrow"}]},{name:"dateDrawer",kind:"onyx.Drawer",open:!1}]},{name:"categoryHolder",kind:"onyx.Groupbox",classes:"padding-half-top padding-half-bottom",components:[{kind:"onyx.GroupboxHeader",content:"Category",classes:"padding-std"},{name:"categoryList",kind:"enyo.Repeater",onSetupItem:"getCategoryItem",classes:"transaction-category-list",components:[{name:"categoryWrapper",classes:"onyx-item text-middle bordered h-box",components:[{name:"categoryText",kind:"onyx.Button",classes:"margin-right box-flex",ontap:"categoryTapped"},{name:"categoryItemBreak",tag:"br"},{components:[{kind:"onyx.InputDecorator",classes:"inline-force margin-right",components:[{name:"categoryAmount",kind:"gts.DecimalInput",oninput:"categoryAmountChanged",placeholder:"0.00"}]},{name:"categoryDelete",kind:"onyx.Button",classes:"small-padding",content:"-",ontap:"categoryDelete"}]}]}]},{name:"categoryFooter",kind:"enyo.FittableColumns",noStretch:!0,classes:"padding-std",components:[{kind:"onyx.Button",content:"Add Category",ontap:"categoryAddNew",classes:"margin-right",style:"min-width: 45%;"},{fit:!0},{name:"fillValueButton",kind:"onyx.Button",content:"Fill Values",ontap:"categoriesFillValues",classes:"margin-left",style:"min-width: 25%;"}]}]},{name:"recurrenceWrapper",kind:"onyx.Groupbox",classes:"padding-half-top padding-half-bottom",components:[{kind:"onyx.GroupboxHeader",content:"Recurrence",classes:"padding-std"},{kind:"enyo.FittableColumns",noStretch:!0,classes:"padding-std text-middle",ontap:"toggleRecurrenceDrawer",components:[{kind:"enyo.Image",src:"assets/repeat.png",classes:"img-icon margin-right"},{name:"recurrenceDisplay",fit:!0},{name:"recurrenceArrow",classes:"arrow"}]},{name:"recurrenceDrawer",kind:"onyx.Drawer",open:!1,components:[{name:"recurrenceSelect",kind:"Checkbook.transactions.recurrence.select",onRecurrenceChange:"recurrenceChanged"}]}]},{name:"checkNumHolder",kind:"onyx.Groupbox",classes:"padding-half-top padding-half-bottom",components:[{kind:"onyx.InputDecorator",layoutKind:"FittableColumnsLayout",noStretch:!0,classes:"padding-half-top",components:[{name:"checkNum",kind:"onyx.Input",fit:!0,placeholder:"# (optional)"},{kind:"onyx.Button",content:"Check Number",classes:"label",ontap:"autofillCheckNo"}]}]},{name:"payeeFieldHolder",kind:"onyx.Groupbox",classes:"padding-half-top padding-half-bottom",components:[{kind:"onyx.InputDecorator",layoutKind:"FittableColumnsLayout",noStretch:!0,classes:"padding-half-top",components:[{name:"payeeField",kind:"onyx.Input",fit:!0},{content:"Payee",classes:"label"}]}]},{name:"cleared",kind:"gts.ToggleBar",classes:"bordered",label:"Cleared",sublabel:"",onContent:"Cleared",offContent:"Pending",value:!1},{name:"autoTrans",kind:"gts.ToggleBar",classes:"bordered",label:"Auto Transfer",sublabel:"",onContent:"Yes",offContent:"No",value:!0},{kind:"onyx.Groupbox",classes:"padding-half-top",components:[{kind:"onyx.InputDecorator",layoutKind:"FittableColumnsLayout",components:[{name:"notes",kind:"onyx.TextArea",placeholder:"Transaction Notes",style:"min-height: 150px;",fit:!0},{content:"Notes",classes:"label",style:"vertical-align: top;"}]}]},{name:"transactionDeleteButton",kind:"onyx.Button",content:"Delete Transaction",ontap:"deleteTransaction",classes:"onyx-negative margin-top",style:"width: 100%;"},{style:"height: 1.5em;"}]}]},{kind:"onyx.Toolbar",classes:"text-center two-button-toolbar",components:[{kind:"onyx.Button",content:"Cancel",ontap:"doFinish"},{content:""},{kind:"onyx.Button",content:"Save",ontap:"saveTransaction",classes:"deep-green"}]},{name:"loadingScrim",kind:"onyx.Scrim",classes:"onyx-scrim-translucent"},{name:"loadingSpinner",kind:"onyx.Spinner",classes:"size-double",style:"z-index: 2; position: absolute; top: 50%; margin-top: -45px; left: 50%; margin-left: -45px;"},{name:"categorySystem",kind:"Checkbook.transactionCategory.select",onHide:"resized"}],create:function(){this.inherited(arguments),this.buildDateSystem()},destroy:function(){this.$.categorySystem.hide(),this.inherited(arguments)},buildDateSystem:function(){!enyo.Panels.isScreenNarrow()||Checkbook.globals.prefs.alwaysFullCalendar?this.$.dateDrawer.createComponent({name:"date",kind:"gts.DatePicker",onSelect:"dateChanged",components:[{name:"time",kind:"gts.TimePicker",label:"Time",minuteInterval:5,is24HrMode:!1,onSelect:"dateChanged"}]},{owner:this}):this.$.dateDrawer.createComponents([{classes:"onyx-toolbar-inline",components:[{name:"label",classes:"label",content:"Date"},{name:"date",kind:"onyx.DatePicker",onSelect:"dateChanged"}]},{name:"time",kind:"gts.TimePicker",label:"Time",minuteInterval:5,is24HrMode:!1,onSelect:"dateChanged"}],{owner:this})},rendered:function(){this.inherited(arguments),this.$.loadingScrim.show(),this.$.loadingSpinner.show(),delete this.trsnObj.dispRunningBalance,delete this.trsnObj.runningBalance,this.trsnObj=enyo.mixin({itemId:-1,desc:"",amount:"",amount_old:"NOT_A_VALUE",note:"",date:Date.parse(new Date),account:this.accountObj.acctId,linkedRecord:-1,linkedAccount:-1,cleared:0,repeatId:-1,repeatUnlinked:0,checkNum:"",category:"Uncategorized",category2:"Other",payee:""},this.trsnObj),0>this.trsnObj.itemId?(this.$.transTypeText.setContent("New Transaction"),this.$.transactionDeleteButton.hide()):this.$.transTypeText.setContent("Modify Transaction"),Checkbook.accounts.manager.fetchAccountsList({onSuccess:enyo.bind(this,this.buildAccountSystems)})},buildAccountSystems:function(e){this.accountList=e,this.$.account.setChoices(this.accountList),this.$.account.setDisabled(!1),this.$.account.render(),this.accountList.length>1?(this.$.linkedAccount.setChoices(this.accountList),this.$.linkedAccount.setDisabled(!1)):this.$.linkedAccount.setDisabled(!0);var t=0;for(var n in this.accountObj)this.accountObj.hasOwnProperty(n)&&t++;5>=t?Checkbook.accounts.manager.fetchAccount(this.accountObj.acctId,{onSuccess:enyo.bind(this,this.initialAccountLoadHandler)}):this.$.categorySystem.loadCategories(enyo.bind(this,this.loadTransactionData))},initialAccountLoadHandler:function(e){this.$.account.removeClass(this.accountObj.acctCategoryColor),this.accountObj=e,this.$.categorySystem.loadCategories(enyo.bind(this,this.loadTransactionData))},loadTransactionData:function(){this.log(),gts.Object.validNumber(this.trsnObj.amount)&&(this.trsnObj.amount_old=this.trsnObj.amount),this.trsnObj.itemId>=0&&(this.transactionType=Checkbook.transactions.manager.determineTransactionType(this.trsnObj)),this.trsnObj.amount=Math.abs(this.trsnObj.amount).toFixed(2),this.trsnObj.date=new Date(parseInt(this.trsnObj.date)),this.trsnObj.cleared=1===this.trsnObj.cleared,this.$.desc.setValue(this.trsnObj.desc),this.$.amount.setValue(this.trsnObj.amount),this.$.account.setValue(this.trsnObj.account),this.$.linkedAccount.setValue(this.trsnObj.linkedAccount),this.$.date.setValue(this.trsnObj.date),this.$.time.setValue(this.trsnObj.date),this.$.checkNum.setValue(this.trsnObj.checkNum),this.$.payeeField.setValue(this.trsnObj.payee),this.$.cleared.setValue(this.trsnObj.cleared),this.$.notes.setValue(this.trsnObj.note),(this.trsnObj.repeatId>0||0===this.trsnObj.repeatId)&&1!=this.trsnObj.repeatUnlinked?Checkbook.transactions.recurrence.manager.fetch(this.trsnObj.repeatId,{onSuccess:enyo.bind(this,this.loadRecurrenceData)}):1==this.trsnObj.repeatUnlinked&&this.$.recurrenceWrapper.hide(),this.trsnObj.category=Checkbook.transactions.manager.parseCategoryDB(this.trsnObj.category,this.trsnObj.category2),this.trsnObj.categoryOriginal=this.trsnObj.category,this.renderCategories=!0,this.$.transTypeIcon.setSrc("assets/menu_icons/"+this.transactionType+".png"),this.adjustSystemViews(),this.dateChanged(),this.$.loadingScrim.hide(),this.$.loadingSpinner.hide(),this.reflow()},adjustSystemViews:function(){if(this.$.linkedAccount.setShowing("transfer"===this.transactionType),this.$.autocomplete.setEnabled(1===this.accountObj.useAutoComplete),this.$.autoTrans.setShowing(0>this.trsnObj.itemId&&"transfer"!==this.transactionType&&this.accountObj.auto_savings>0&&this.accountObj.auto_savings_link>-1),1==this.accountObj.atmEntry?(this.$.amount.setAtm(!0),this.$.amount.setSelectOnFocus(!1)):(this.$.amount.setAtm(!1),this.$.amount.setSelectOnFocus(!0)),1==this.accountObj.enableCategories?(this.categoryChanged(),this.$.categoryHolder.show()):this.$.categoryHolder.hide(),1==this.accountObj.checkField?(this.$.checkNumHolder.show(),Checkbook.transactions.manager.fetchMaxCheckNumber(this.$.account.getValue(),{onSuccess:enyo.bind(this,this.adjustMaxCheckNumber)})):this.$.checkNumHolder.hide(),1==this.accountObj.payeeField?this.$.payeeFieldHolder.show():this.$.payeeFieldHolder.hide(),1===Checkbook.globals.prefs.dispColor){if(this.$.account.addClass(this.accountObj.acctCategoryColor),!this.$.linkedAccount.getDisabled())for(var e=0;this.accountList.length>e;e++)if(this.accountList[e].value==this.$.linkedAccount.getValue()){this.linkedAccountChanged(null,{selected:{color:this.accountList[e].color}});break}}else this.$.account.removeClass("custom-background"),this.$.linkedAccount.removeClass("custom-background");this.adjustLinkedAccountList(),enyo.asyncMethod(this.$.desc,this.$.desc.focus)},adjustLinkedAccountList:function(){if(1>=this.accountList.length)return this.log("not enough accounts"),void 0;for(var e=this.$.account.getValue(),t=0;this.accountList.length>t;t++)this.accountList[t].disabled=this.accountList[t].value==e?!0:!1;this.$.linkedAccount.getValue()==e&&(this.trsnObj.linkedAccount=null,this.$.linkedAccount.setValue(null)),this.$.linkedAccount.setChoices(this.accountList),this.$.linkedAccount.render();for(var t=0;this.accountList.length>t;t++)this.accountList[t].disabled=!1},descKeyPress:function(e,t){1!==this.accountObj.transDescMultiLine&&13===t.keyCode&&t.preventDefault()},descAutoSuggestMade:function(e,t){this.trsnObj.desc=this.$.desc.getValue(),t.data&&(this.trsnObj.linkedAccount="transfer"===this.transactionType?t.linkedAccount:-1,this.$.linkedAccount.setValue(this.trsnObj.linkedAccount),this.trsnObj.category=t.category,this.categoryChanged()),enyo.asyncMethod(this.$.amount,this.$.amount.focus)},amountTypeChanged:function(){switch(this.transactionType){case"expense":this.transactionType="income";break;case"transfer":break;case"income":this.transactionType="expense"}this.$.transTypeIcon.setSrc("assets/menu_icons/"+this.transactionType+".png")},accountChanged:function(){Checkbook.accounts.manager.fetchAccount(this.$.account.getValue(),{onSuccess:enyo.bind(this,this.accountChangedFollower)})},accountChangedFollower:function(e){for(var t=0;appColors.length>t;t++)this.$.account.removeClass(appColors[t].name);this.accountObj=e,this.adjustSystemViews(),this.dateChanged()},linkedAccountChanged:function(e,t){for(var n=0;appColors.length>n;n++)this.$.linkedAccount.removeClass(appColors[n].name);this.$.linkedAccount.addClass(t.selected.color)},toggleDateDrawer:function(){this.$.dateArrow.addRemoveClass("invert",!this.$.dateDrawer.getOpen()),this.$.dateDrawer.setOpen(!this.$.dateDrawer.getOpen()),this.$.date.render()},dateChanged:function(){var e=this.$.date.getValue(),t=this.$.time.getValue();return e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),this.$.dateDisplay.setContent(e.format({date:"long",time:1===this.accountObj.showTransTime?"short":""})),this.$.recurrenceSelect.setDate(e),this.$.recurrenceSelect.dateChanged(),!0},getCategoryItem:function(e,t){if(this.renderCategories){var n=this.trsnObj.category[t.index],i=t.item;return n&&i?(i.$.categoryWrapper.addRemoveClass("h-box",!enyo.Panels.isScreenNarrow()),i.$.categoryItemBreak.setShowing(enyo.Panels.isScreenNarrow()),i.$.categoryText.setContent(n.category+" >> "+gts.String.dirtyString(n.category2)),i.$.categoryText.addRemoveClass("margin-half-bottom",enyo.Panels.isScreenNarrow()),i.$.categoryText.addRemoveClass("full-width",enyo.Panels.isScreenNarrow()),this.trsnObj.category.length>1?(n.amount=Math.abs(n.amount).toFixed(2),1==this.accountObj.atmEntry?(i.$.categoryAmount.setAtm(!0),i.$.categoryAmount.setSelectOnFocus(!1)):(i.$.categoryAmount.setAtm(!1),i.$.categoryAmount.setSelectOnFocus(!0)),i.$.categoryAmount.setValue(n.amount),i.$.categoryAmount.setDisabled(!1),i.$.categoryDelete.setDisabled(!1),i.$.categoryDelete.addClass("onyx-negative")):(i.$.categoryAmount.setDisabled(!0),i.$.categoryDelete.setDisabled(!0),i.$.categoryDelete.removeClass("onyx-negative"),n.amount=0),!0):void 0}},categoryTapped:function(e,t){this.$.categorySystem.getCategoryChoice(enyo.bind(this,this.categorySelected,t.index),this.trsnObj.category[t.index])},categorySelected:function(e,t){enyo.mixin(this.trsnObj.category[e],t),this.categoryChanged()},categoriesFillValues:function(){for(var e,t=0,n=[],i=0,o=0;this.trsnObj.category.length>o;o++)e=deformatAmount(this.trsnObj.category[o].amount),t+=e,0==e&&n.push(o);if(t=deformatAmount(this.$.amount.getValue())-t,i=n.length,t>0&&i>0){for(var s=(t/i).toFixed(2),o=0;i-1>o;o++)this.trsnObj.category[n[o]].amount=s;this.trsnObj.category[n[i-1]].amount=t-s*(i-1)}this.categoryChanged()},categoryAmountChanged:function(e,t){this.trsnObj.category[t.index].amount=t.originator.getValueAsNumber()},categoryAddNew:function(){this.trsnObj.category.push({category:"Uncategorized",category2:"Other",amount:""}),this.categoryChanged()},categoryDelete:function(e,t){this.trsnObj.category.splice(t.index,1),this.categoryChanged()},categoryChanged:function(){this.$.fillValueButton.setShowing(this.trsnObj.category.length>1),this.$.categoryFooter.reflow(),this.$.categoryList.getCount()===this.trsnObj.category.length?this.$.categoryList.build():this.$.categoryList.setCount(this.trsnObj.category.length)},loadRecurrenceData:function(e){return 1==e.terminated?(this.$.recurrenceWrapper.hide(),void 0):(this.trsnObj.rObj=enyo.clone(e),this.trsnObj.rObj.endDate=new Date(parseInt(e.endDate)),this.trsnObj.rObj.origDate=new Date(parseInt(e.origDate)),this.trsnObj.rObj.lastUpdated=new Date(parseInt(e.lastUpdated)),this.trsnObj.rObj.lastOccurrence=new Date(parseInt(e.lastOccurrence)),this.$.recurrenceSelect.setValue(this.trsnObj.rObj),void 0)},toggleRecurrenceDrawer:function(){this.$.recurrenceArrow.addRemoveClass("invert",!this.$.recurrenceDrawer.getOpen()),this.$.recurrenceDrawer.setOpen(!this.$.recurrenceDrawer.getOpen())},recurrenceChanged:function(e,t){this.$.recurrenceDisplay.setContent(t.summary)},adjustMaxCheckNumber:function(e){this.$.checkNum.autofillValue=e},autofillCheckNo:function(){1==this.accountObj.checkField&&0>=this.$.checkNum.getValue().length&&this.$.checkNum.setValue(this.$.checkNum.autofillValue)},saveTransaction:function(){if(0>this.trsnObj.itemId)this.saveNewTransaction();else{var e=this.$.recurrenceSelect.getValue();if((this.trsnObj.repeatId>0||0===this.trsnObj.repeatId||"none"!==e.frequency)&&1!=this.trsnObj.repeatUnlinked&&1!=this.trsnObj.terminated){var t=this.checkForChanges();if(!t.major&&!t.minor&&!t.recurrence)return this.doFinish({status:0}),void 0;if(this.trsnObj.repeatId>0||0===this.trsnObj.repeatId){if("none"==e.frequency)return this.createComponent({name:"recurrenceEventDialog",kind:"gts.ConfirmDialog",title:"End Transaction Series",message:"This will end the series and delete all following transactions.",confirmText:"Continue",confirmClass:"onyx-negative",cancelText:"Cancel",cancelClass:"",onConfirm:"endRecurrenceEvent",onCancel:"closeRecurrenceEventDialog"}),this.$.recurrenceEventDialog.show(),void 0;if(t.major)return this.createComponent({name:"recurrenceEventDialog",kind:"Checkbook.transactions.recurrence.confirm",onOne:"updateSingle",onFuture:"updateFuture",onAll:"updateAll",onCancel:"closeRecurrenceEventDialog"}),this.$.recurrenceEventDialog.show(),void 0;if(t.recurrence)return this.createComponent({name:"recurrenceEventDialog",kind:"gts.ConfirmDialog",title:"Transaction Series",message:"This will change this and all following transactions.",confirmText:"Continue",confirmClass:"",cancelText:"Cancel",cancelClass:"",onConfirm:"updateFuture",onCancel:"closeRecurrenceEventDialog"}),this.$.recurrenceEventDialog.show(),void 0;this.updateTransactionObject(t.minor)}else this.updateTransactionObject();Checkbook.transactions.manager.updateTransaction(this.trsnObj,this.transactionType,this.getSaveOptions())}else this.saveModifiedTransaction()}},getSaveOptions:function(){return{onSuccess:enyo.bind(this,this.saveCompleteHandler,{modifyStatus:1,account:this.trsnObj.account,linkedAccount:"transfer"==this.transactionType?this.trsnObj.linkedAccount:-1,atAccount:this.trsnObj.autoTransfer>0&&this.trsnObj.autoTransferLink>=0?this.trsnObj.autoTransferLink:-1}),onFailure:null}},checkForChanges:function(){var e={minor:!1,major:!1,recurrence:!1},t=this.$.date.getValue();return t.setHours(this.$.time.getValue().getHours()),t.setMinutes(this.$.time.getValue().getMinutes()),(this.trsnObj.desc!==this.$.desc.getValue()||this.trsnObj.amount_old!=this.$.amount.getValue()||this.trsnObj.date!==t||this.trsnObj.account!==this.$.account.getValue()||this.$.linkedAccount.getShowing()&&this.trsnObj.linkedAccount!==this.$.linkedAccount.getValue()||enyo.json.stringify(this.trsnObj.categoryOriginal)!==enyo.json.stringify(this.trsnObj.category)||this.trsnObj.payee!==this.$.payeeField.getValue()||this.trsnObj.note!==this.$.notes.getValue())&&(e.major=!0),(this.trsnObj.checkNum!==this.$.checkNum.getValue()||this.trsnObj.cleared!==this.$.cleared.getValue())&&(e.minor=!0),Checkbook.transactions.recurrence.manager.compare(this.trsnObj.rObj,this.$.recurrenceSelect.getValue())||(e.recurrence=!0),e},updateTransactionObject:function(e){this.trsnObj.desc=this.$.desc.getValue(),this.trsnObj.amount=this.$.amount.getValue(),this.trsnObj.account=this.$.account.getValue(),this.trsnObj.linkedAccount=this.$.linkedAccount.getValue();var t=this.$.time.getValue();this.trsnObj.date=this.$.date.getValue(),this.trsnObj.date.setHours(t.getHours()),this.trsnObj.date.setMinutes(t.getMinutes()),delete this.trsnObj.categoryOriginal,this.trsnObj.checkNum=this.$.checkNum.getValue(),this.trsnObj.payee=this.$.payeeField.getValue(),this.trsnObj.cleared=this.$.cleared.getValue(),this.trsnObj.note=this.$.notes.getValue(),e?this.trsnObj.rObj=!1:(this.trsnObj.rObj||(this.trsnObj.rObj={}),enyo.mixin(this.trsnObj.rObj,enyo.clone(this.$.recurrenceSelect.getValue()))),this.trsnObj.autoTransfer=this.$.autoTrans.getShowing()&&this.$.autoTrans.getValue()?this.accountObj.auto_savings:0,this.trsnObj.autoTransferLink=this.accountObj.auto_savings_link},saveNewTransaction:function(){this.updateTransactionObject(),Checkbook.transactions.manager.createTransaction(this.trsnObj,this.transactionType,this.getSaveOptions())},saveModifiedTransaction:function(e){this.updateTransactionObject(e),Checkbook.transactions.manager.updateTransaction(this.trsnObj,this.transactionType,this.getSaveOptions())},saveCompleteHandler:function(e){enyo.asyncMethod(this,this.doFinish,e)},closeRecurrenceEventDialog:function(){this.$.recurrenceEventDialog.hide(),this.$.recurrenceEventDialog.destroy()},endRecurrenceEvent:function(){this.closeRecurrenceEventDialog(),Checkbook.transactions.recurrence.manager.deleteOnlyFuture(this.trsnObj.itemId,this.trsnObj.repeatId,{onSuccess:enyo.bind(this,this.saveModifiedTransaction,!0)})},updateSingle:function(){this.closeRecurrenceEventDialog(),this.trsnObj.repeatUnlinked=1,this.saveModifiedTransaction(!0)},updateFuture:function(){this.closeRecurrenceEventDialog(),this.saveModifiedTransaction()},updateAll:function(){var e=this.trsnObj.repeatId;this.closeRecurrenceEventDialog(),this.updateTransactionObject(),this.trsnObj.repeatId=-1,this.$.date.setValue(gts.Object.isDate(this.trsnObj.rObj.origDate)?this.trsnObj.rObj.origDate.getTime():this.trsnObj.rObj.origDate),Checkbook.transactions.recurrence.manager.deleteAll(e,{onSuccess:enyo.bind(this,this.saveNewTransaction)})},deleteTransaction:function(){0>this.trsnObj.itemId?this.doFinish({status:0}):(this.trsnObj.repeatId>0||0===this.trsnObj.repeatId?this.createComponent({name:"deleteTransactionConfirm",kind:"Checkbook.transactions.recurrence.delete",transactionId:this.trsnObj.itemId,recurrenceId:this.trsnObj.repeatId,onFinish:"deleteTransactionConfirmClose",onCancel:"deleteTransactionConfirmClose"}):this.createComponent({name:"deleteTransactionConfirm",kind:"gts.ConfirmDialog",title:"Delete Transaction",message:"Are you sure you want to delete this transaction?",confirmText:"Delete",confirmClass:"onyx-negative",cancelText:"Cancel",cancelClass:"",onConfirm:"deleteTransactionHandler",onCancel:"deleteTransactionConfirmClose"}),this.$.deleteTransactionConfirm.show())},deleteTransactionConfirmClose:function(){this.$.deleteTransactionConfirm.hide(),this.$.deleteTransactionConfirm.destroy()},deleteTransactionHandler:function(){this.deleteTransactionConfirmClose(),Checkbook.transactions.manager.deleteTransaction(this.trsnObj.itemId,{onSuccess:enyo.bind(this,this.saveCompleteHandler,{modifyStatus:2})})}});

// manager.js
enyo.kind({name:"Checkbook.autocompleteprefs.manager",kind:enyo.Component,constructor:function(){this.inherited(arguments),Checkbook.globals.gts_db||(this.log("creating database object."),new gts.database(getDBArgs()))}});

// view.js
enyo.kind({name:"Checkbook.autocompleteprefs.view",style:"height: 100%;",flex:1,events:{onFinish:""},components:[{kind:enyo.PageHeader,className:"enyo-header-dark",components:[{kind:enyo.Spacer},{content:"Auto-Complete Preferences",className:"bigger"},{kind:enyo.Spacer}]},{name:"entries",kind:enyo.VirtualList,flex:1,onSetupRow:"buildRow",components:[{kind:enyo.SwipeableItem,layoutKind:enyo.HFlexLayout,className:"light narrow-column",tapHighlight:!0,ontap:"itemTapped",onConfirm:"itemDeleted",components:[{name:"desc",className:"enyo-text-ellipsis",flex:1},{name:"icon",kind:enyo.Image,className:"img-icon"}]}]},{kind:enyo.Toolbar,className:"tardis-blue",components:[{kind:enyo.ToolButtonGroup,components:[{caption:"Close",className:"enyo-grouped-toolbutton-dark",ontap:"doFinish"},{icon:"assets/menu_icons/sort.png",className:"enyo-grouped-toolbutton-dark",ontap:""}]},{kind:enyo.Spacer,flex:1},{kind:enyo.ToolButtonGroup,components:[{icon:"assets/menu_icons/new.png",className:"enyo-grouped-toolbutton-dark",ontap:""}]}]}],itemTapped:function(){this.log(arguments)},itemDeleted:function(){this.log(arguments)},buildRow:function(e,t){return t>=0&&100>t?(this.$.desc.setContent("description name: "+t),this.$.icon.setSrc("assets/"+(0==t%2?"green-plus.png":"red-cross.png")),!0):void 0},fetchGroup:function(e,t){var n=t*e.getPageSize();0>n}});

// modify.js
enyo.kind({name:"Checkbook.autocompleteprefs.modify",kind:enyo.Component});

// autocomplete.js
enyo.kind({name:"Checkbook.transactions.autocomplete",events:{onValueChanged:""},published:{enabled:!0},components:[{name:"ac",kind:"gts.AutoComplete",onValueSelected:"handleSuggestion",onDataRequested:"fetchData",components:[{tag:"",name:"client"}]}],rendered:function(){this.inherited(arguments),this.enabledChanged()},enabledChanged:function(){this.$.ac.setEnabled(this.enabled)},fetchData:function(e,t){return 0>=t.value.length?(t.callback([]),void 0):(Checkbook.globals.gts_db.query(new gts.databaseQuery({sql:"SELECT DISTINCT desc FROM transactions WHERE desc LIKE ? ORDER BY desc ASC LIMIT ?;",values:[t.value+"%",e.getLimit()]}),{onSuccess:enyo.bind(this,this.buildSuggestionList)}),void 0)},buildSuggestionList:function(e){for(var t=[],n=0;e.length>n;n++)t.push(e[n].desc);this.$.ac.setValues(t)},handleSuggestion:function(e,t){return Checkbook.globals.gts_db.query(new gts.databaseQuery({sql:"SELECT ( SELECT linkedAccount FROM( SELECT b.linkedAccount, COUNT( b.desc ) AS countB FROM transactions b WHERE b.desc = a.desc AND b.linkedAccount != '' AND b.account = ? GROUP BY b.linkedAccount ORDER BY countB DESC LIMIT 1 ) ) AS linkedAcct,  ( CASE WHEN a.category = '||~SPLIT~||' THEN ( '[' || ( SELECT GROUP_CONCAT( json ) FROM ( SELECT ( '{ \"category\": \"' || ts.genCat || '\", \"category2\" : \"' || ts.specCat || '\", \"amount\": \"' || ts.amount || '\" }' ) AS json FROM transactionSplit ts WHERE ts.transId = a.itemId ORDER BY ts.amount DESC ) ) || ']' ) ELSE a.category END ) AS category, ( CASE WHEN a.category = '||~SPLIT~||' THEN 'PARSE_CATEGORY' ELSE a.category2 END ) AS category2, COUNT( desc ) AS count FROM transactions a WHERE desc = ? AND category != '' GROUP BY category ORDER BY count DESC LIMIT 1;",values:[this.getOwner().$.account.getValue(),t.value]}),{onSuccess:enyo.bind(this,this.dataHandler,t.value)}),!0},dataHandler:function(e,t){var n={data:!1};if(t.length>0)var n={data:!0,desc:e,linkedAccount:t[0].linkedAccount,category:Checkbook.transactions.manager.parseCategoryDB(gts.String.dirtyString(t[0].category),gts.String.dirtyString(t[0].category2))};this.doValueChanged(n)}});

// manager.js
enyo.singleton({name:"Checkbook.transactions.recurrence.manager",kind:"enyo.Component",compare:function(e,t){if(gts.Object.isUndefined(e)&&!gts.Object.isUndefined(t)||!gts.Object.isUndefined(e)&&gts.Object.isUndefined(t))return!1;var n=!0;if(n=n&&e.frequency===t.frequency,n=n&&e.itemSpan===t.itemSpan,n=n&&enyo.json.stringify(e.daysOfWeek)===enyo.json.stringify(t.daysOfWeek),n=n&&e.endingCondition===t.endingCondition,n&&("date"==e.endingCondition||"date"==t.endingCondition)){var o=gts.Object.isDate(e.endDate)?e.endDate:new Date(e.endDate),i=gts.Object.isDate(t.endDate)?t.endDate:new Date(t.endDate);n=n&&o===i}return!n||"occurences"!=e.endingCondition&&"occurences"!=t.endingCondition||(n=n&&e.endCount===t.endCount),n},fetch:function(e,t){return isNaN(e)||0>e?(enyo.isFunction(t.onSuccess)&&t.onSuccess({}),void 0):(Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getSelect("repeats","*",{repeatId:e}),{onSuccess:function(e){enyo.isFunction(t.onSuccess)&&t.onSuccess(e[0])},onError:t.onError}),void 0)},fetchSummary:function(e,t){return isNaN(e)||0>e?(enyo.isFunction(t.onSuccess)&&t.onSuccess(""),void 0):(Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getSelect("repeats","*",{repeatId:e}),{onSuccess:function(e){if(enyo.isFunction(t.onSuccess)){if(0>=e.length)return t.onSuccess(""),void 0;var e=enyo.clone(e[0]),n="Repeats every "+(e.itemSpan>1?e.itemSpan+" ":"");switch(e.frequency){case"daily":n+="day"+(e.itemSpan>1?"s":"");break;case"weekly":var o=new Date(2011,4,1),s=enyo.json.parse(e.daysOfWeek),a=[],r=[];for(i=0;7>i;i++)s.indexOf(i)>=0?(a.push(o.format({format:"EEEE"})),r[i]=o.format({format:"EEEE"})):r[i]="",o.setDate(o.getDate()+1);""!=r[1]&&""!=r[2]&&""!=r[3]&&""!=r[4]&&""!=r[5]&&(a.splice(a.indexOf(r[1]),1),a.splice(a.indexOf(r[2]),1),a.splice(a.indexOf(r[3]),1),a.splice(a.indexOf(r[4]),1),a.splice(a.indexOf(r[5]),1),a.push("Weekdays")),""!=r[0]&&""!=r[6]&&(a.splice(a.indexOf(r[0]),1),a.splice(a.indexOf(r[6]),1),a.push("Weekends"));var c=a.join(", ");a.length>1&&(c=c.substr(0,c.lastIndexOf(", "))+(a.length>2?",":"")+" and "+c.substr(c.lastIndexOf(", ")+2)),n+="week"+(e.itemSpan>1?"s":"")+" on "+c;break;case"monthly":n+="month"+(e.itemSpan>1?"s":"")+" on the "+this.dateSuffix(this.date.getDate());break;case"yearly":n+="year"+(e.itemSpan>1?"s":"")+" on "+this.date.format({format:"MMMM"})+" "+this.dateSuffix(this.date.getDate());break;default:n+="span"+(e.itemSpan>1?"s":"")}t.onSuccess(n)}},onError:t.onError}),void 0)},handleRecurrenceSystem:function(e,t,n){var o=[];if(0!=e.rObj)if((isNaN(e.repeatId)||0>e.repeatId)&&"none"!=e.rObj.frequency){if(e.repeatId=e.maxRepeatId,"weekly"==e.rObj.frequency&&0==e.rObj.daysOfWeek.length)return[];var i={repeatId:e.repeatId,frequency:e.rObj.frequency,itemSpan:e.rObj.itemSpan,daysOfWeek:enyo.json.stringify("weekly"==e.rObj.frequency?e.rObj.daysOfWeek:""),endingCondition:e.rObj.endingCondition,endDate:"date"==e.rObj.endingCondition?e.rObj.endDate:"",endCount:"occurences"==e.rObj.endingCondition?e.rObj.endCount:"",lastOccurrence:e.date,currCount:1,origDate:e.rObj.origDate,rep_desc:e.desc,rep_amount:e.amount,rep_note:e.note,rep_category:enyo.json.stringify(e.category),rep_acctId:e.account,rep_linkedAcctId:e.linkedAccount,rep_autoTrsnLink:t>0&&n>=0?t:0,rep_autoTrsnLinkAcct:t>0&&n>=0?n:"",last_sync:"",maxItemId:gts.Object.validNumber(e.linkedAccount)&&e.linkedAccount>=0?e.itemId+2:e.itemId+1};o=o.concat(this.generateSeriesSQL([enyo.clone(i)])),delete i.maxItemId,o.unshift(Checkbook.globals.gts_db.getInsert("repeats",i))}else if(!(isNaN(e.repeatId)||0>e.repeatId)&&1!=e.repeatUnlinked&&1!=e.terminated)if("none"==e.rObj.frequency)o.push(this._getDeleteFutureSQL(e.itemId,e.repeatId,!0));else{var s={repeatId:e.repeatId,frequency:e.rObj.frequency,itemSpan:e.rObj.itemSpan,daysOfWeek:enyo.json.stringify("weekly"==e.rObj.frequency?e.rObj.daysOfWeek:""),endingCondition:e.rObj.endingCondition,endDate:"date"==e.rObj.endingCondition?e.rObj.endDate:"",endCount:"occurences"==e.rObj.endingCondition?e.rObj.endCount:"",lastOccurrence:e.date,currCount:e.rObj.currCount,origDate:e.rObj.origDate,rep_desc:e.desc,rep_amount:e.amount,rep_note:e.note,rep_category:enyo.json.stringify(e.category),rep_acctId:e.account,rep_linkedAcctId:e.linkedAccount,rep_autoTrsnLink:t>0&&n>=0?t:0,rep_autoTrsnLinkAcct:t>0&&n>=0?n:"",last_sync:"",terminated:0,maxItemId:gts.Object.validNumber(e.linkedAccount)&&e.linkedAccount>=0?e.maxItemId+1:e.maxItemId};o=o.concat(this._getDeleteFutureSQL(e.itemId,s.repeatId,!0)),o=o.concat(this.generateSeriesSQL([enyo.clone(s)])),delete s.maxItemId,delete s.lastOccurrence,delete s.currCount,o.push(Checkbook.globals.gts_db.getUpdate("repeats",s,{repeatId:s.repeatId}))}return delete e.rObj,delete e.maxItemId,delete e.maxRepeatId,o},updateSeriesTransactions:function(e,t){var n=new Date,o=new Date(n.getFullYear(),n.getMonth(),n.getDate()+Checkbook.globals.prefs.seriesDayLimit,23,59,59,999);e=e||-1,Checkbook.globals.gts_db.query(new gts.databaseQuery({sql:"SELECT ( SELECT IFNULL( MAX( itemId ), 0 ) FROM transactions LIMIT 1 ) AS maxItemId, *, ( ( SELECT count( * ) FROM transactions WHERE transactions.repeatId = repeats.repeatId AND transactions.linkedAccount IS NULL AND transactions.date > ? ) +  ( SELECT count( * ) FROM transactions WHERE transactions.repeatId = repeats.repeatId AND transactions.linkedAccount IS NOT NULL AND transactions.date > ? ) / 2 ) AS futureCount FROM repeats WHERE ( rep_acctId = ? "+(0>e?"OR 1 = 1 ":"")+") "+"AND lastOccurrence < ? "+"AND futureCount < ? "+"AND ( "+"( "+"endingCondition = 'none' "+") OR ( "+"endingCondition = 'date' "+"AND endDate != '' "+"AND endDate > lastOccurrence "+") OR ( "+"endingCondition = 'occurences' "+"AND endCount != '' "+"AND endCount > currCount "+") "+") "+"AND terminated != 1",values:[Date.parse(n),Date.parse(n),e,Date.parse(o),Checkbook.globals.prefs.seriesCountLimit]}),{onSuccess:enyo.bind(this,this._updateSeriesTransactionsHandler,t),onError:t.onError})},_updateSeriesTransactionsHandler:function(e,t){if(t.length>0){var n=parseInt(t[0].maxItemId)+1;Checkbook.globals.gts_db.queries(this.generateSeriesSQL(t,n),e)}else enyo.isFunction(e.onSuccess)&&e.onSuccess()},generateSeriesSQL:function(e,t){var n=[];if(e.length>0){var t=t||e[0].maxItemId;new Date;for(var o,i,s,a,r,c,l,h=0;e.length>h;h++){i=new Date(parseInt(e[h].origDate)),s=new Date(parseInt(e[h].lastOccurrence)),a=new Date(parseInt(e[h].lastOccurrence)),r=e[h].currCount,c=e[h].futureCount;var d=enyo.json.parse(e[h].rep_category),u=enyo.json.parse(e[h].daysOfWeek);for(this.log(e[h].testCount);Math.floor((a-s)/864e5)<Checkbook.globals.prefs.seriesDayLimit&&Checkbook.globals.prefs.seriesCountLimit>c&&("none"==e[h].endingCondition||"date"==e[h].endingCondition&&e[h].endDate&&Date.parse(a)<=e[h].endDate||"occurences"==e[h].endingCondition&&e[h].endCount&&e[h].endCount>=r);){if("daily"==e[h].frequency)a.setDate(a.getDate()+1*e[h].itemSpan);else if("weekly"==e[h].frequency){var g=u.indexOf(a.getDay());if(0>g||g+1>=u.length){for(;a.getDay()>0;)a.setDate(a.getDate()+1);for(;7>a.getDay()&&a.getDay()!=u[0];)a.setDate(a.getDate()+1);a.setDate(a.getDate()+7*(e[h].itemSpan-1))}else a.setDate(a.getDate()+(u[g+1]-u[g]))}else if("monthly"==e[h].frequency){var p=Math.max(a.getDate(),i.getDate());a.setDate(1),a.setMonth(a.getMonth()+1*e[h].itemSpan),a.setDate(Math.min(p,a.daysInMonth()))}else"yearly"==e[h].frequency&&a.setYear(a.getFullYear()+1*e[h].itemSpan);o={itemId:t,account:e[h].rep_acctId,repeatId:e[h].repeatId,desc:e[h].rep_desc,note:e[h].rep_note,date:a,amount:e[h].rep_amount,amount_old:"NOT_A_VALUE",linkedRecord:-1,linkedAccount:e[h].rep_linkedAcctId,cleared:!1,checkNum:"",category:d,category2:"",rObj:!1,autoTransfer:e[h].rep_autoTrsnLink,autoTransferLink:e[h].rep_autoTrsnLink>0?e[h].rep_autoTrsnLinkAcct:-1},l=gts.Object.validNumber(e[h].rep_linkedAcctId)&&e[h].rep_linkedAcctId>=0?"transfer":0>e[h].rep_amount?"expense":"income",n=n.concat(Checkbook.transactions.manager.generateInsertTransactionSQL({data:o,type:l})),r++,c++,t+=gts.Object.validNumber(o.linkedAccount)&&o.linkedAccount>=0?2:1,o.autoTransfer>0&&o.autoTransferLink>=0&&(t+=2)}n.push(Checkbook.globals.gts_db.getUpdate("repeats",{lastOccurrence:Date.parse(a),currCount:r,lastUpdated:Date.parse(new Date)},{repeatId:e[h].repeatId}))}n.length>0&&Checkbook.accounts.manager.updateAccountModTime()}return n},setTermination:function(e,t,n){Checkbook.globals.gts_db.queries(Checkbook.globals.gts_db.getUpdate("repeats",{terminated:t?1:0},{repeatId:e}),n)},deleteOne:function(e,t,n){Checkbook.globals.gts_db.queries([Checkbook.globals.gts_db.getDelete("transactions",{itemId:e}),Checkbook.globals.gts_db.getDelete("transactions",{linkedRecord:e}),new gts.databaseQuery({sql:"DELETE FROM transactionSplit WHERE transId = ? OR transId = ( SELECT itemId FROM transactions WHERE linkedRecord = ? )",values:[e,e]}),new gts.databaseQuery({sql:"UPDATE repeats SET currCount = MAX( IFNULL( ( SELECT ( sub.currCount - 1 ) FROM repeats sub WHERE sub.repeatId = repeats.repeatId ), 0 ), 0 ) WHERE repeatId = ?",values:[t]})],n)},deleteFuture:function(e,t,n){Checkbook.globals.gts_db.queries(this._getDeleteFutureSQL(e,t),n)},deleteOnlyFuture:function(e,t,n){Checkbook.globals.gts_db.queries(this._getDeleteFutureSQL(e,t,!0),n)},_getDeleteFutureSQL:function(e,t,n){var o;return o=n?[t,e]:[t,e,e],[new gts.databaseQuery({sql:"UPDATE repeats SET terminated = 1, currCount = MAX( ( ( SELECT sub.currCount FROM repeats sub WHERE sub.repeatId = repeats.repeatId ) - ( SELECT count( * ) FROM transactions WHERE transactions.repeatId = repeats.repeatId AND transactions.date "+(n?">":">=")+" ( SELECT trsn.date FROM transactions trsn WHERE trsn.itemId = ? ) ) ), 0 ) WHERE repeatId = ?",values:[e,t]}),new gts.databaseQuery({sql:"DELETE FROM transactions WHERE repeatId = ? AND ( "+(n?"":"itemId = ? OR ")+"itemId IN ( SELECT sub.itemId FROM transactions sub WHERE sub.repeatId = transactions.repeatId AND sub.date "+(n?">":">=")+" ( SELECT sub2.date FROM transactions sub2 WHERE sub2.itemId = ? ) ) )",values:o})]},deleteAll:function(e,t){Checkbook.globals.gts_db.queries([Checkbook.globals.gts_db.getDelete("transactions",{repeatId:e}),Checkbook.globals.gts_db.getDelete("repeats",{repeatId:e})],t)}});

// confirm.js
enyo.kind({name:"Checkbook.transactions.recurrence.confirm",kind:"onyx.Popup",classes:"gts-confirm-dialog",centered:!0,floating:!0,modal:!0,autoDismiss:!1,scrim:!0,scrimclasses:"onyx-scrim-translucent",style:"max-width: 325px;",events:{onOne:"",onFuture:"",onAll:"",onCancel:""},components:[{name:"title",classes:"title-wrapper",content:" Recurring Transaction"},{name:"message",classes:"message-wrapper",content:"Would you like to change only this transaction, all transactions in the series, or this and all following transactions in the series?"},{classes:"block-buttons text-center",components:[{kind:"onyx.Button",content:"Only this instance",ontap:"doOne"},{kind:"onyx.Button",content:"This and all following",ontap:"doFuture"},{kind:"onyx.Button",content:"All transactions in the series",ontap:"doAll"},{kind:"onyx.Button",content:"Cancel",ontap:"doCancel"}]}]});

// delete.js
enyo.kind({name:"Checkbook.transactions.recurrence.delete",kind:"onyx.Popup",classes:"gts-confirm-dialog",centered:!0,floating:!0,modal:!0,autoDismiss:!1,scrim:!0,scrimclasses:"onyx-scrim-translucent",style:"max-width: 325px;",published:{transactionId:-1,recurrenceId:-1},events:{onDeleteOne:"",onDeleteFuture:"",onDeleteAll:"",onFinish:"",onCancel:""},components:[{name:"title",classes:"title-wrapper",content:"Delete Recurring Transaction"},{name:"message",classes:"message-wrapper",content:"Would you like to delete only this transaction, this and all following transactions in the series, or all transactions in the series?"},{classes:"block-buttons text-center",components:[{kind:"onyx.Button",content:"Only this instance",classes:"onyx-negative",ontap:"deleteOne"},{kind:"onyx.Button",content:"This and all following",classes:"onyx-negative",ontap:"deleteFuture"},{kind:"onyx.Button",content:"All transactions in the series",classes:"onyx-negative",ontap:"deleteAll"},{kind:"onyx.Button",content:"Cancel",ontap:"doCancel"}]}],deleteOne:function(){Checkbook.transactions.recurrence.manager.deleteOne(this.transactionId,this.recurrenceId,{onSuccess:enyo.bind(this,this.deleteCompleted,"one")})},deleteFuture:function(){Checkbook.transactions.recurrence.manager.deleteFuture(this.transactionId,this.recurrenceId,{onSuccess:enyo.bind(this,this.deleteCompleted,"future")})},deleteAll:function(){Checkbook.transactions.recurrence.manager.deleteAll(this.recurrenceId,{onSuccess:enyo.bind(this,this.deleteCompleted,"all")})},deleteCompleted:function(e){switch(e){case"all":this.doDeleteAll();break;case"future":this.doDeleteFuture();break;case"one":this.doDeleteOne()}this.doFinish()}});

// select.js
enyo.kind({name:"Checkbook.transactions.recurrence.select",recurrenceOptions:[],systemActive:!1,published:{date:""},events:{onRecurrenceChange:""},components:[{name:"recurrenceNode",kind:"gts.SelectorBar",label:"Recurrence",onChange:"recurrenceNodeChanged",classes:"force-left-padding",value:0},{name:"weeklyOptions",classes:"h-box bo",showing:!1,components:[]},{name:"durationWrapper",showing:!1,components:[{kind:"onyx.Item",classes:"text-center bordered h-box box-pack-center box-align-center",components:[{content:"Every"},{kind:"onyx.PickerDecorator",components:[{classes:"margin-half-left margin-half-right"},{name:"itemSpan",kind:"gts.IntegerPicker",min:1,max:64,style:"margin-right: 3px;",onChange:"sendSummary"}]},{name:"itemSpanUnits"},{content:"Frequency",classes:"label box-flex-1 text-right"}]},{name:"endingCondition",kind:"gts.SelectorBar",label:"Ending Condition",classes:"bordered",onChange:"endingConditionChanged",choices:[{content:"Forever",value:"f",active:!0},{content:"Until Date",value:"d"},{content:"Occurrences",value:"o"}],value:"f"},{name:"endingDateWrapper",kind:"onyx.Item",classes:"bordered",showing:!1,components:[]},{name:"endingCountWrapper",kind:"onyx.Item",classes:"text-center bordered h-box box-pack-center box-align-center",showing:!1,components:[{kind:"onyx.PickerDecorator",components:[{classes:"margin-half-left margin-half-right"},{name:"endingCount",kind:"gts.IntegerPicker",min:1,max:100,onChange:"sendSummary"}]},{content:"Occurrences",classes:"label box-flex-1 text-right"}]}]}],create:function(){this.inherited(arguments),""==this.date&&(this.date=new Date),this.buildRecurrenceOptions(),this.buildDateSystem(),this.buildDayOfWeekSystem(),this.recurrenceNodeChanged(),this.systemActive=!0},getValue:function(){var e={};if(0==this.$.recurrenceNode.getValue())e.frequency="none";else{switch(e.origDate=Date.parse(this.date),e.itemSpan=this.$.itemSpan.getValue(),this.$.recurrenceNode.getValue()){case 1:e.frequency="daily";break;case 2:for(e.frequency="weekly",e.daysOfWeek=[],i=0;7>i;i++)this.$["weekly"+i].getChecked()&&e.daysOfWeek.push(i);break;case 3:e.frequency="monthly";break;case 4:default:e.frequency="yearly"}switch(this.$.endingCondition.getValue()){case"d":e.endingCondition="date",e.endDate=Date.parse(this.$.endingDate.getValue());break;case"o":e.endingCondition="occurences",e.endCount=this.$.endingCount.getValue();break;case"f":default:e.endingCondition="none"}}return e},setValue:function(e){if(null==e||e===void 0)this.$.recurrenceNode.setValue(0);else{for(this.date=e.origDate,this.$.itemSpan.setValue(e.itemSpan),i=0;7>i;i++)this.$["weekly"+i].setChecked(!1);switch(e.frequency){case"daily":this.$.recurrenceNode.setValue(1);break;case"weekly":for(this.$.recurrenceNode.setValue(2),e.daysOfWeek=enyo.json.parse(e.daysOfWeek),i=0;e.daysOfWeek.length>i;i++)this.$["weekly"+e.daysOfWeek[i]].setChecked(!0);break;case"monthly":this.$.recurrenceNode.setValue(3);break;case"yearly":this.$.recurrenceNode.setValue(4);break;default:this.$.recurrenceNode.setValue(0)}switch(e.endingCondition){case"date":this.$.endingCondition.setValue("d"),this.$.endingDate.setValue(e.endDate);break;case"occurences":this.$.endingCondition.setValue("o"),this.$.endingCount.setValue(e.endCount);break;case"none":default:this.$.endingCondition.setValue("f")}}this.buildRecurrenceOptions(),this.recurrenceNodeChanged()},sendSummary:function(){var e="";if(0==this.$.recurrenceNode.getValue())e="No Recurrence";else switch(e="Repeats every "+this.$.itemSpan.getValue()+" ",this.$.recurrenceNode.getValue()){case 1:e+="day(s)";break;case 2:var t=[],n=[];for(i=0;7>i;i++)this.$["weekly"+i].getChecked()?(t.push(this.$["weekly"+i].dayName),n[i]=this.$["weekly"+i].dayName):n[i]="";""!=n[1]&&""!=n[2]&&""!=n[3]&&""!=n[4]&&""!=n[5]&&(t.splice(t.indexOf(n[1]),1),t.splice(t.indexOf(n[2]),1),t.splice(t.indexOf(n[3]),1),t.splice(t.indexOf(n[4]),1),t.splice(t.indexOf(n[5]),1),t.push("Weekdays")),""!=n[0]&&""!=n[6]&&(t.splice(t.indexOf(n[0]),1),t.splice(t.indexOf(n[6]),1),t.push("Weekends"));var o=t.join(", ");t.length>1&&(o=o.substr(0,o.lastIndexOf(", "))+(t.length>2?",":"")+" and "+o.substr(o.lastIndexOf(", ")+2)),e+="week(s) on "+o;break;case 3:e+="month(s) on the "+this.dateSuffix(this.date.getDate());break;case 4:e+="year(s) on "+this.date.format({format:"MMMM"})+" "+this.dateSuffix(this.date.getDate());break;default:e+="span(s)"}this.systemActive&&this.doRecurrenceChange({summary:e,value:this.getValue()})},buildRecurrenceOptions:function(){this.recurrenceOptions=[{content:"No Recurrence",value:0},{content:"Daily",value:1},{content:"Weekly",value:2},{content:"Monthly on the "+this.dateSuffix(this.date.getDate()),value:3},{content:"Yearly on "+this.date.format({format:"MMMM"})+" "+this.dateSuffix(this.date.getDate()),value:4}];var e=this.$.recurrenceNode.getValue();this.$.recurrenceNode.setChoices(this.recurrenceOptions),this.$.recurrenceNode.render(),this.$.recurrenceNode.setValue(e)},buildDateSystem:function(){!enyo.Panels.isScreenNarrow()||Checkbook.globals.prefs.alwaysFullCalendar?this.$.endingDateWrapper.createComponent({name:"endingDate",kind:"gts.DatePicker",onSelect:"sendSummary",components:[{name:"endingTime",kind:"gts.TimePicker",label:"Time",minuteInterval:5,is24HrMode:!1,onSelect:"sendSummary"}]},{owner:this}):this.$.endingDateWrapper.createComponents([{classes:"onyx-toolbar-inline",components:[{name:"label",classes:"label",content:"Date"},{name:"endingDate",kind:"onyx.DatePicker",onSelect:"sendSummary"}]},{name:"endingTime",kind:"gts.TimePicker",label:"Time",minuteInterval:5,is24HrMode:!1,onSelect:"sendSummary"}],{owner:this})},buildDayOfWeekSystem:function(){var e=new Date(2011,4,1),t=[];for(i=0;7>i;i++)t.push({classes:"text-center box-flex-1",components:[{content:e.format({format:"EEE"}),classes:"label"},{name:"weekly"+i,kind:"onyx.Checkbox",onchange:"sendSummary",checked:this.date.getDay()==i,dayName:e.format({format:"EEEE"})}]}),e.setDate(e.getDate()+1);this.$.weeklyOptions.createComponents(t,{owner:this}),this.$.weeklyOptions.render()},recurrenceNodeChanged:function(){switch(this.$.recurrenceNode.addRemoveClass("enyo-single",0==this.$.recurrenceNode.getValue()),this.$.durationWrapper.setShowing(0!=this.$.recurrenceNode.getValue()),this.$.weeklyOptions.setShowing(2==this.$.recurrenceNode.getValue()),this.$.recurrenceNode.getValue()){case 1:this.$.itemSpanUnits.setContent("day(s)");break;case 2:this.$.itemSpanUnits.setContent("week(s)");break;case 3:this.$.itemSpanUnits.setContent("month(s)");break;case 4:this.$.itemSpanUnits.setContent("year(s)");break;default:this.$.itemSpanUnits.setContent("span(s)")}return this.sendSummary(),!0},dateChanged:function(){if(this.buildRecurrenceOptions(),2!=this.$.recurrenceNode.getValue())for(i=0;7>i;i++)this.$["weekly"+i].setChecked(this.date.getDay()==i);this.buildRecurrenceOptions(),this.sendSummary()},endingConditionChanged:function(){return this.$.endingDateWrapper.setShowing("d"==this.$.endingCondition.getValue()),this.$.endingCountWrapper.setShowing("o"==this.$.endingCondition.getValue()),this.$.endingDateWrapper.getShowing()&&(this.$.endingDate.render(),this.$.endingTime.render()),this.sendSummary(),!0},dateSuffix:function(e){return e+["th","st","nd","rd"][e%10>3?0:(10!=e%100-e%10)*e%10]}});

// manager.js
enyo.singleton({name:"Checkbook.transactionCategory.manager",kind:enyo.Component,trsnCategories:null,fetchCategories:function(e,t,n){Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getSelect("transactionCategories",["*"],null,["genCat COLLATE NOCASE","specCat COLLATE NOCASE"],t,n),e)},load:function(e,t,n,o){if(!o||!n||!e){if(this.trsnCategories)return this.log("transaction categories already built"),callbackFn(),void 0;o=0,n=100,e=null,this.trsnCategories={mainCats:[],subCats:{}}}this.fetchCategories({onSuccess:enyo.bind(this,this._loadHandler,e,t,n,o),onError:t.onError},n,o)},_loadHandler:function(e,t,n,o,i){for(var s=0;i.length>s;s++){var a=i[s];e&&e===a.genCat||(""!==a.genCat&&this.trsnCategories.mainCats.push({id:a.catId,content:a.genCat,parent:""}),e=a.genCat,this.trsnCategories.subCats[e]=[]),this.trsnCategories.subCats[e].push({id:a.catId,content:a.specCat,parent:e})}n>i.length?enyo.isFunction(t.onSuccess)&&t.onSuccess():this.load(e,t,o+n,n)},createCategory:function(e,t,n){this.categoriesChanged();var o=new gts.databaseQuery({sql:"INSERT INTO transactionCategories( genCat, specCat ) VALUES( ?, ? );",values:[e,t]});Checkbook.globals.gts_db.query(o,n)},editCategory:function(e,t,n,o,i,s){this.categoriesChanged();var a=[new gts.databaseQuery({sql:"UPDATE transactionCategories SET genCat = ?, specCat = ? WHERE catId = ?;",values:[t,n,e]}),new gts.databaseQuery({sql:"UPDATE transactions SET category = ?, category2 = ? WHERE category = ? AND category2 = ?;",values:[t,n,o,i]}),new gts.databaseQuery({sql:"UPDATE transactionSplit SET genCat = ?, specCat = ? WHERE genCat = ? AND specCat = ?;",values:[t,n,o,i]})];Checkbook.globals.gts_db.queries(a,s)},editGroup:function(e,t,n){this.categoriesChanged();var o=[new gts.databaseQuery({sql:"UPDATE transactionCategories SET genCat = ? WHERE genCat = ?;",values:[e,t]}),new gts.databaseQuery({sql:"UPDATE transactions SET category = ? WHERE category = ?;",values:[e,t]}),new gts.databaseQuery({sql:"UPDATE transactionSplit SET genCat = ? WHERE genCat = ?;",values:[e,t]})];Checkbook.globals.gts_db.queries(o,n)},deleteCategory:function(e,t){this.categoriesChanged();var n=new gts.databaseQuery({sql:"DELETE FROM transactionCategories WHERE catId = ?;",values:[e]});Checkbook.globals.gts_db.query(n,t)},categoriesChanged:function(){this.trsnCategories&&(this.log("wiping transaction categories"),this.trsnCategories=null)}});

// select.js
enyo.kind({name:"Checkbook.transactionCategory.select",kind:"onyx.Popup",classes:"small-popup",centered:!0,floating:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",autoDismiss:!1,style:"max-height: 95%;",categories:{},dispCategories:[],selected:{},doCategorySelect:null,published:{entireGeneral:!1},components:[{kind:"enyo.FittableColumns",classes:"text-middle margin-bottom",noStretch:!0,components:[{classes:"bigger text-left ",fit:!0,components:[{content:"Select a Category",classes:"bigger"},{name:"subheader",classes:"smaller"}]},{kind:"onyx.Button",content:"X",ontap:"hide",classes:"onyx-blue small-padding"}]},{name:"scroller",kind:"enyo.Scroller",horizontal:"hidden",classes:"light popup-scroller",components:[]}],handlers:{onShow:"_show"},_show:function(){var e=this.$.scroller.getBounds();this.$.scroller.applyStyle("height",e.height+"px")},loadCategories:function(e){Checkbook.transactionCategory.manager.trsnCategories?(this.log("transaction categories already built"),e()):Checkbook.transactionCategory.manager.load(null,{onSuccess:e},null,null)},getCategoryChoice:function(e,t){this.dispCategories=enyo.clone(Checkbook.transactionCategory.manager.trsnCategories.mainCats),this._generateTree(),this.show(),this.doCategorySelect=e,t?(this.selected=t,this.$.subheader.setContent(t.category+" >> "+t.category2)):(this.selected={category:"",category2:""},this.$.subheader.setContent("")),this.reflow()},_generateTree:function(){this.log(),this.$.scroller.destroyClientControls();for(var e=[],t=Checkbook.transactionCategory.manager.trsnCategories.mainCats,n=0;t.length>n;n++){var o={kind:"enyo.Node",expandable:!0,expanded:!1,style:"padding: 0.5em;",classes:"padding-std bordered",icon:"assets/folder.png",content:t[n].content,onExpand:"nodeExpand",onNodeTap:"nodeTap",components:[]},i=Checkbook.transactionCategory.manager.trsnCategories.subCats[t[n].content];this.entireGeneral&&o.components.push({style:"padding: 0.25em;",classes:"padding-half-std margin-left margin-right bordered",icon:"assets/tag.png",allowHtml:!0,content:"<strong>All</strong>",parentNode:t[n].content});for(var s=0;i.length>s;s++)o.components.push({style:"padding: 0.25em;",classes:"padding-half-std margin-left margin-right bordered",icon:"assets/tag.png",content:i[s].content,parentNode:i[s].parent});e.push(o)}this.$.scroller.createComponents(e,{owner:this}),this.$.scroller.render()},nodeExpand:function(e){e.setIcon("assets/"+(e.expanded?"folder-open.png":"folder.png"))},nodeTap:function(e,t){return t.originator.parentNode&&(enyo.isFunction(this.doCategorySelect)&&this.doCategorySelect({category:t.originator.parentNode,category2:"All Sub Categories"===t.originator.content?"%":t.originator.content}),this.hide()),!0},returnedFromView:function(){this.$.transactionCategoryView.hide(),this.$.transactionCategoryView.destroy(),this.datasetChanged()}});

// view.js
enyo.kind({name:"Checkbook.transactionCategory.view",kind:"FittableRows",classes:"enyo-fit",style:"height: 100%;",events:{onFinish:""},components:[{name:"header",kind:"onyx.Toolbar",classes:"text-center text-middle",style:"position: relative;",components:[{components:[{content:"Transaction Categories",className:"bigger"},{name:"subheader",className:"smaller"}]},{kind:"onyx.Button",ontap:"doFinish",content:"x",classes:"onyx-negative",style:"position: absolute; right: 15px;"}]},{kind:"enyo.Scroller",horizontal:"hidden",classes:"deep-green-gradient",fit:!0,components:[{name:"mainCategories",kind:"enyo.Repeater",classes:"enyo-fit light narrow-column padding-half-top padding-half-bottom",style:"min-height: 100%; position: relative;",onSetupItem:"setupMainRow",components:[{name:"item",kind:"onyx.Item",tapHighlight:!0,classes:"text-middle",style:"padding-top: 0; padding-bottom: 0;",components:[{name:"content",classes:"bold bordered padding-std",ontap:"editMainCategory"},{name:"subCats",kind:"enyo.Repeater",classes:"margin-double-left margin-right",count:0,parentContent:"",onSetupItem:"setupSubRow",components:[{name:"item",kind:"onyx.Item",tapHighlight:!0,classes:"bordered text-middle",ontap:"editChildCategory",onDelete:"deleteItem",components:[{name:"subContent"}]}]}]}]}]},{kind:"onyx.Toolbar",classes:"text-center",components:[{kind:"onyx.Button",content:"Create New",ontap:"createNew"}]},{name:"modifyCat",kind:"Checkbook.transactionCategory.modify",onChangeComplete:"modificationComplete"}],rendered:function(){this.inherited(arguments),this.$.header.addRemoveClass("text-left",enyo.Panels.isScreenNarrow()),this.$.header.addRemoveClass("text-center",!enyo.Panels.isScreenNarrow()),this.fetchCategories()},fetchCategories:function(){Checkbook.transactionCategory.manager.trsnCategories?this.dataResponse():Checkbook.transactionCategory.manager.load(null,{onSuccess:enyo.bind(this,this.dataResponse)},null,null)},dataResponse:function(){this.$.mainCategories.setCount(Checkbook.transactionCategory.manager.trsnCategories.mainCats.length)},setupMainRow:function(e,t){var n=t.index,o=t.item,i=Checkbook.transactionCategory.manager.trsnCategories.mainCats[n];return i&&o&&o.$.content&&n>=0?(o.$.content.setContent(i.content),o.$.subCats.parentContent=i.content,o.$.subCats.setCount(Checkbook.transactionCategory.manager.trsnCategories.subCats[i.content].length),!0):void 0},setupSubRow:function(e,t){var n=t.item;if(n&&n.$.subContent){var o=n.index,i=Checkbook.transactionCategory.manager.trsnCategories.subCats[t.originator.parentContent][o];return i&&o>=0?(n.$.subContent.setContent(i.content),n.$.subContent.parentContent=i.parent,!0):void 0}},createNew:function(){return this.$.modifyCat.show(-1),!0},editMainCategory:function(e,t){var n=Checkbook.transactionCategory.manager.trsnCategories.mainCats[t.index];return n?(this.$.modifyCat.show(-1,n.content,null),!0):void 0},editChildCategory:function(e,t){var n=Checkbook.transactionCategory.manager.trsnCategories.subCats[t.originator.parentContent];if(n){var o=n[t.index];return o?(this.$.modifyCat.show(o.id,o.parent,o.content),!0):void 0}},deleteItem:function(e,t){return this.log(arguments),!0},modificationComplete:function(e,t){this.fetchCategories(),"reorder"!=t.action&&this.$.modifyCat.hide()}});

// modify.js
enyo.kind({name:"Checkbook.transactionCategory.modify",kind:"onyx.Popup",classes:"login-system small-popup",centered:!0,floating:!0,modal:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",autoDismiss:!1,events:{onChangeComplete:""},catId:-1,general:"",specific:"",mode:"",components:[{kind:"enyo.FittableColumns",classes:"text-middle margin-bottom",noStretch:!0,components:[{name:"title",content:"",classes:"bigger text-left margin-half-right",fit:!0},{kind:"onyx.Button",content:"X",ontap:"hide",classes:"onyx-blue small-padding"}]},{kind:"onyx.Groupbox",classes:"light",components:[{name:"generalWrapper",kind:"gts.AutoComplete",layoutKind:"FittableColumnsLayout",alwaysLooksFocused:!0,onValueSelected:"generalAutoSuggestComplete",onDataRequested:"fetchData",zIndex:200,components:[{name:"general",kind:"onyx.Input",placeholder:"group name",fit:!0},{content:"group",classes:"small label"}]},{name:"specificWrapper",kind:"onyx.InputDecorator",layoutKind:"FittableColumnsLayout",classes:"onyx-focused",alwaysLooksFocused:!0,components:[{name:"specific",kind:"onyx.Input",placeholder:"category name",fit:!0,onkeypress:"keyPressed"},{content:"category",classes:"small label"}]}]},{name:"errorMessage",kind:"gts.InlineNotification",type:"error",content:"",showing:!1},{classes:"padding-std margin-half-top text-center h-box",components:[{kind:"onyx.Button",classes:"margin-right box-flex",content:"Cancel",ontap:"hide"},{name:"deleteButton",kind:"onyx.Button",classes:"onyx-negative box-flex",content:"Delete",ontap:"deleteCategory"},{kind:"onyx.Button",classes:"onyx-affirmative margin-left box-flex",content:"Save",ontap:"save"}]}],show:function(e,t,n){this.inherited(arguments),0>e?this.$.deleteButton.hide():this.$.deleteButton.show(),0>e&&!enyo.isString(t)?(this.$.title.setContent("Create a Category"),this.$.specificWrapper.show(),this.mode="new",this.catId=-1,this.general="",this.specific=""):0>e&&enyo.isString(t)?(this.$.title.setContent("Edit Group Name"),this.$.specificWrapper.hide(),this.mode="group",this.catId=-1,this.general=t,this.specific=""):e>0&&enyo.isString(t)&&enyo.isString(n)?(this.$.title.setContent("Edit Category"),this.$.specificWrapper.show(),this.mode="category",this.catId=e,this.general=t,this.specific=n):this.hide(),this.$.general.setValue(this.general),this.$.specific.setValue(this.specific),this.$.general.focus()},keyPressed:function(e,t){(124===t.keyCode||126===t.keyCode)&&t.preventDefault()},fetchData:function(e,t){return 0>=t.value.length?(t.callback([]),void 0):(Checkbook.globals.gts_db.query(new gts.databaseQuery({sql:"SELECT DISTINCT genCat FROM transactionCategories WHERE genCat LIKE ? LIMIT ?;",values:[t.value+"%",e.getLimit()]}),{onSuccess:enyo.bind(this,this.buildSuggestionList,t.callback)}),void 0)},buildSuggestionList:function(e,t){for(var n=[],o=0;t.length>o;o++)n.push(t[o].genCat);e(n)},generalAutoSuggestComplete:function(e,t){return this.$.general.setValue(t.value),!0},deleteCategory:function(){if(this.catId>=0){this.createComponent({name:"deleteCategoryConfirm",kind:"gts.ConfirmDialog",title:"Delete Category",message:"Are you sure you want to delete this transaction category?",confirmText:"Delete",confirmClass:"onyx-negative",cancelText:"Cancel",cancelClass:"",onConfirm:"deleteCategoryHandler",onCancel:"deleteCategoryConfirmClose"}),this.$.deleteCategoryConfirm.show();var e=this.getComputedStyleValue("zIndex");if(!e)for(var t=this.domCssText.split(";"),n=0;t.length>n;n++)if(t[n].match("z-index")){t=t[n].split(":"),e=t[1];break}this.$.deleteCategoryConfirm.applyStyle("z-index",e-5+10)}},deleteCategoryConfirmClose:function(){this.$.deleteCategoryConfirm.destroy()},deleteCategoryHandler:function(){this.deleteCategoryConfirmClose(),Checkbook.transactionCategory.manager.deleteCategory(this.catId,{onSuccess:enyo.bind(this,this.doChangeComplete,{action:"delete"})})},save:function(){var e=this.$.general.getValue().replace(/(~|\|)/g,""),t=this.$.specific.getValue().replace(/(~|\|)/g,"");return 0>=e.length||"group"!==this.mode&&0>=t.length?(this.$.errorMessage.setContent("Category fields may not be blank."),this.$.errorMessage.show(),void 0):"All Sub Categories"===t?(this.$.errorMessage.setContent("Invalid category."),this.$.errorMessage.show(),void 0):(this.$.errorMessage.hide(),this.general===e&&this.specific===t&&this.hide(),"new"===this.mode?Checkbook.transactionCategory.manager.createCategory(e,t,{onSuccess:enyo.bind(this,this.doChangeComplete,{action:"new"})}):"category"===this.mode?Checkbook.transactionCategory.manager.editCategory(this.catId,e,t,this.general,this.specific,{onSuccess:enyo.bind(this,this.doChangeComplete,{action:"category"})}):"group"===this.mode?Checkbook.transactionCategory.manager.editGroup(e,this.general,{onSuccess:enyo.bind(this,this.doChangeComplete,{action:"group"})}):this.hide(),void 0)}});

// search.js
enyo.kind({name:"Checkbook.search.pane",kind:"enyo.FittableRows",classes:"enyo-fit",published:{acctId:null,category:null,category2:null,dateStart:null,dateEnd:null},events:{onFinish:""},components:[{name:"menubar",kind:"onyx.Toolbar",layoutKind:"enyo.FittableColumnsLayout",noStretch:!0,components:[{name:"systemIcon",kind:"enyo.Image",src:"assets/dollar_sign_1.png",classes:"img-icon",style:"margin: 0 15px 0 0;"},{name:"loadingSpinner",kind:"onyx.Spinner",showing:!1,classes:" img-icon",style:"margin: 0 15px 0 0;"},{content:"Search System",classes:"enyo-text-ellipsis",fit:!0},{name:"resultCount",kind:"onyx.Button",className:"onyx-dark",showing:!1,style:"padding: 0 8px; margin: 0;"}]},{name:"mainViews",kind:"Panels",fit:!0,animate:!1,draggable:!1,classes:"app-panels",arrangerKind:"CollapsingArranger",components:[{name:"filter",kind:"Checkbook.search.filter",onSearch:"searchTransactions",onFinish:"closeSearch"},{name:"results",kind:"Checkbook.search.results",onResultsFound:"resultCount",onLoading:"loadingDisplay"}]}],rendered:function(){this.inherited(arguments),this.$.filter.load(this.acctId,this.category,this.category2,this.dateStart,this.dateEnd)},searchTransactions:function(e,t){this.$.results.search(t.strings,t.args)},resultCount:function(e,t){this.$.resultCount.show(),this.$.resultCount.setContent(t.count+" transactions")},loadingDisplay:function(e,t){this.$.loadingSpinner.setShowing(t.status),this.$.systemIcon.setShowing(!t.status)},closeSearch:function(){this.doFinish(this.$.results.getChangesMade())}});

// filter.js
enyo.kind({name:"Checkbook.search.filter",kind:"FittableRows",acctList:{count:0,items:[]},events:{onSearch:"",onFinish:""},components:[{kind:"enyo.Scroller",fit:!0,components:[{kind:"onyx.InputDecorator",layoutKind:"FittableColumnsLayout",noStretch:!0,style:"width: 95%",components:[{name:"searchString",kind:"onyx.Input",fit:!0,placeholder:"Search phrase",onchange:"searchChanged"},{kind:"Image",src:"assets/search.png",classes:"img-icon"}]},{name:"accountDrawer",kind:"gts.DividerDrawer",caption:"Accounts",open:!1,components:[{name:"accounts",kind:"enyo.Repeater",onSetupRow:"setupRow",components:[{tapHighlight:!0,ontap:"accountSelectedChanged",components:[{name:"icon",kind:"enyo.Image",classes:"accountIcon"},{name:"iconLock",kind:"enyo.Image",src:"assets/padlock_1.png",classes:"accountLockIcon unlocked"},{flex:1,components:[{name:"accountName"},{name:"accountNote",classes:"smaller"}]},{name:"accountSelected",style:"margin-right: 10px;"}]}]}]},{name:"fromToggle",kind:"gts.ToggleBar",classes:"bordered",label:"Limit Start Date",sublabel:"Limit the earliest date that can appear in search query.",onContent:"Yes",offContent:"No",value:!1,onChange:"toggleToggles"},{name:"startDateDrawer",kind:"onyx.Drawer",open:!1,components:[{classes:"onyx-toolbar-inline",components:[{classes:"label",content:"Date"},{name:"fromDate",kind:"onyx.DatePicker",onSelect:"dateChanged"}]},{name:"fromTime",kind:"gts.TimePicker",label:"Time",minuteInterval:5,is24HrMode:!1,onSelect:"dateChanged"}]},{name:"toToggle",kind:"gts.ToggleBar",classes:"bordered",label:"Limit End Date",sublabel:"Limit the latest date that can appear in search query.",onContent:"Yes",offContent:"No",value:!1,onChange:"toggleToggles"},{name:"endDateDrawer",kind:"onyx.Drawer",open:!1,components:[{classes:"onyx-toolbar-inline",components:[{classes:"label",content:"Date"},{name:"toDate",kind:"onyx.DatePicker",onSelect:"dateChanged"}]},{name:"toTime",kind:"gts.TimePicker",label:"Time",minuteInterval:5,is24HrMode:!1,onSelect:"dateChanged"}]},{name:"cleared",kind:"gts.SelectorBar",label:"Include Transaction Status",classes:"bordered",value:2,choices:[{content:"All",value:2},{content:"Cleared Only",value:1},{content:"Pending Only",value:0}]},{name:"includeNeg",kind:"gts.ToggleBar",classes:"bordered",label:"Include Expenses",onText:"Yes",offText:"No",value:!0},{name:"includePos",kind:"gts.ToggleBar",classes:"bordered",label:"Include Income",onText:"Yes",offText:"No",value:!0},{name:"includeTrans",kind:"gts.ToggleBar",classes:"bordered",label:"Include Transfers",onText:"Yes",offText:"No",value:!0}]},{kind:"onyx.Toolbar",classes:"tardis-blue text-center",components:[{kind:"onyx.Button",content:"Back",ontap:"doFinish"},{kind:"onyx.Button",content:"Search",ontap:"search"}]}],create:function(){this.inherited(arguments),(!enyo.Panels.isScreenNarrow()||Checkbook.globals.prefs.alwaysFullCalendar)&&(this.$.startDateDrawer.destroyClientControls(),this.$.startDateDrawer.createComponent({name:"fromDate",kind:"gts.DatePicker",onSelect:"",components:[{name:"fromTime",kind:"gts.TimePicker",label:"Time",minuteInterval:5,is24HrMode:!1,onSelect:""}]},{owner:this}),this.$.endDateDrawer.destroyClientControls(),this.$.endDateDrawer.createComponent({name:"toDate",kind:"gts.DatePicker",onSelect:"",components:[{name:"toTime",kind:"gts.TimePicker",label:"Time",minuteInterval:5,is24HrMode:!1,onSelect:""}]},{owner:this}))},load:function(e,t,n,o,i){Checkbook.accounts.manager.fetchAccounts({onSuccess:enyo.bind(this,this.renderAccountList,e,t,n,o,i)})},renderAccountList:function(e,t,n,o,i,s){return this.log(arguments),void 0},toggleToggles:function(){this.$.startDateDrawer.setOpen(this.$.fromToggle.getValue()),this.$.startDateDrawer.render(),this.$.endDateDrawer.setOpen(this.$.toToggle.getValue()),this.$.endDateDrawer.render()},renderDrawerCaption:function(){this.$.accountDrawer.setCaption("Accounts")+" ("+this.acctList.count+$L(" of ")+this.acctList.items.length+")"},setupRow:function(e,t){var n=this.acctList.items[t];return n?(this.$.accountName.setContent(n.acctName),this.$.icon.setSrc("assets/"+n.acctCategoryIcon),this.$.iconLock.addRemoveClass("unlocked",1!==n.acctLocked||n.bypass),this.$.accountSelected.setChecked(n.selectStatus),!0):void 0},accountSelectedChanged:function(e,t){var n=t.rowIndex;this.acctList.items[n].acctLocked&&!this.acctList.items[n].bypass?Checkbook.globals.security.authUser(this.acctList.items[n].name+" "+"PIN Code",this.acctList.items[n].lockedCode,{onSuccess:enyo.bind(this,this.authSuccessful,t)}):(this.acctList.items[n].selectStatus=!this.acctList.items[n].selectStatus,this.acctList.count=this.acctList.items[n].selectStatus?this.acctList.count+1:this.acctList.count-1),this.renderDrawerCaption(),this.$.accounts.renderRow(n)},authSuccessful:function(e){this.acctList.items[e.rowIndex].bypass=!0,this.accountSelectedChanged(null,e)},search:function(){return this.log(),void 0}});

// results.js
enyo.kind({name:"Checkbook.search.results",kind:"FittableRows",where:{strings:"",arguments:[]},resultCount:0,transactions:[],sort:null,sortQry:null,published:{changesMade:!1},events:{onResultsFound:"",onLoading:""},components:[{name:"entries",fit:!0,classes:"checkbook-stamp",onSetupRow:"setupRow",onAcquirePage:"acquirePage",components:[{tapHighlight:!0,ontap:"transactiontapped",onConfirm:"transactionDeleted",style:"padding-right: 20px; padding-left: 30px;",components:[{name:"mainBody",classes:"transactionItemTop",components:[{flex:1,components:[{name:"desc",classes:"description enyo-text-ellipsis bold"},{name:"time",classes:"date smaller"},{align:"center",pack:"start",components:[{name:"accountIcon",kind:"enyo.Image",src:"",style:"height: 16px; width: 16px; margin: 0 5px 0 0;"},{name:"account",classes:"small",content:"Account Name"}]}]},{name:"amount",style:"text-align: right;"},{name:"cleared",ontap:"transactionCleared",style:"margin-left: 15px;"}]},{name:"category",allowHtml:!0},{name:"checkNum",classes:"small"},{name:"note",classes:"small",allowHtml:!0}]}]},{classes:"tardis-blue",pack:"start",components:[{},{style:"margin-left: 50px;",components:[{ontap:"sortClicked",icon:"assets/menu_icons/sort.png",classes:"enyo-grouped-toolbutton-dark"}]}]},{name:"sortMenu"},{name:"viewSingle",onClear:"vsCleared",onEdit:"vsEdit",onDelete:"transactionDeleted"}],rendered:function(){this.inherited(arguments)},search:function(e,t){this.where={strings:e,arguments:t},this.doLoading(!0),0>=this.where.strings.length?this.fetchSearchCountHandler():Checkbook.transactions.manager.searchTransactionsCount(this.where.strings,this.where.arguments,this.sortQry,{onSuccess:enyo.bind(this,this.fetchSearchCountHandler)})},fetchSearchCountHandler:function(e){this.resultCount=e&&e.searchCount?e.searchCount:0,this.doResultsFound(this.resultCount),this.transactions=[],this.$.entries.punt()},buildTransactionSorting:function(){this.sort=transactionSortOptions[0].value,this.sortQry=transactionSortOptions[0].qry,this.$.sortMenu.setItems(transactionSortOptions)},sortClicked:function(e){this.$.sortMenu.openAtControl(e,this.sort)},menuItemClick:function(){var e=arguments[2===arguments.length?0:1];if("transactionsortoptions"===e.menuParent.toLowerCase()){if(this.sort===e.value)return;this.sort=e.value,this.sortQry=e.qry,this.transactions=[],this.$.entries.punt()}},transactiontapped:function(e,t,n){this.log(),1===Checkbook.globals.prefs.transPreview?(this.$.viewSingle.setIndex(n),this.$.viewSingle.setTransaction(this.transactions[n]),this.$.viewSingle.setAccount({acctId:this.transactions[n].account}),this.$.viewSingle.openAtCenter()):this.vsEdit(null,n)},transactionCleared:function(e,t){this.vsCleared(null,t.rowIndex),t.stopPropagation()},vsCleared:function(e,t){return 1===this.transactions[t].frozen?(this.$.entries.refresh(),void 0):(this.changesMade=!0,this.doLoading(!0),this.transactions[t].cleared=1===this.transactions[t].cleared?0:1,Checkbook.transactions.manager.clearTransaction(this.transactions[t].itemId,1===this.transactions[t].cleared),this.$.entries.refresh(),this.transactions[t].cleared)},vsEdit:function(e,t){var n=this.transactions[t];if(n&&1!==n.frozen){var o={acctId:n.account},i={account:n.account,amount:n.amount,category:n.category,category2:n.category2,checkNum:n.checkNum,cleared:n.cleared,date:n.date,desc:n.desc,itemId:n.itemId,linkedAccount:n.linkedAccount,linkedRecord:n.linkedRecord,note:n.note,repeatId:n.repeatId};enyo.asyncMethod(this,this.doModify,{name:"editTransaction",kind:"Checkbook.transactions.modify",accountObj:o,trsnObj:i,transactionType:"",onFinish:enyo.bind(this,this.modifyTransactionComplete,t)})}},modifyTransactionComplete:function(e,t,n,o,i){1===n&&i===!0?(this.changesMade=!0,this.transactions=[],this.$.entries.punt()):2===n&&(this.changesMade=!0,this.transactions=[],this.$.entries.punt(),this.resultCount--,this.doResultsFound(this.resultCount))},transactionDeleted:function(e,t){return 1===this.transactions[t].frozen?(this.$.entries.refresh(),void 0):(this.changesMade=!0,this.doLoading(!0),Checkbook.transactions.manager.deleteTransaction(this.transactions[t].itemId),this.transactions.splice(t,1),this.$.entries.refresh(),this.resultCount--,this.doResultsFound(this.resultCount),Checkbook.transactions.manager.searchTransactions(this.where.strings,this.where.arguments,this.sortQry,{onSuccess:enyo.bind(this,this.acquirePageHandler,this.transactions.length)},1,this.transactions.length),void 0)},setupRow:function(e,t){var n=this.transactions[t];if(n){this.$.swipeableItem.addRemoveClass("alt-row",0===t%2),this.$.swipeableItem.addRemoveClass("norm-row",0!==t%2),this.$.desc.setContent(n.desc);var o=new Date(parseInt(n.date));this.$.time.setContent(o.format({date:"long",time:1===n.showTransTime?"short":""}));var i=new Date;1!==n.showTransTime&&i.setHours(23,59,59,999),this.$.swipeableItem.addRemoveClass("futureTransaction",n.date>Date.parse(i)),this.$.amount.setContent(formatAmount(n.amount)),this.$.amount.addRemoveClass("positiveBalance",n.amount>0),this.$.amount.addRemoveClass("negativeBalance",0>n.amount),this.$.amount.addRemoveClass("neutralBalance",0==n.amount),this.$.cleared.setChecked(1===n.cleared),this.$.accountIcon.setSrc("assets/"+n.acctCategoryIcon),this.$.account.setContent(n.acctName),1===n.enableCategories?(this.$.category.show(),this.$.category.setContent(Checkbook.transactions.manager.formatCategoryDisplay(n.category,n.category2))):this.$.category.hide(),this.$.checkNum.setContent(1===n.checkField&&n.checkNum&&""!==n.checkNum?"Check #"+n.checkNum:""),this.$.note.setContent(1===n.hideNotes?"":n.note);var s=n.linkedRecord&&!isNaN(n.linkedRecord)&&""!=n.linkedRecord,a=n.repeatId&&!isNaN(n.repeatId)&&""!=n.repeatId;return this.$.mainBody.addRemoveClass("repeatTransferIcon",s&&a),this.$.mainBody.addRemoveClass("transferIcon",s&&!a),this.$.mainBody.addRemoveClass("repeatIcon",!s&&a),!0}},acquirePage:function(e,t){if(0>=this.where.strings.length)return this.transactions=[],this.doLoading(!1),void 0;var n=t*e.getPageSize();this.where.strings&&this.where.arguments&&n>=0&&!this.transactions[n]&&(this.doLoading(!0),Checkbook.transactions.manager.searchTransactions(this.where.strings,this.where.arguments,this.sortQry,{onSuccess:enyo.bind(this,this.acquirePageHandler,n)},e.getPageSize(),n))},acquirePageHandler:function(e,t){for(var n=0;t.length>n;n++)this.transactions[e+n]=enyo.mixin({amount:prepAmount(t[n].amount)},t[n]),this.transactions[e+n].desc=gts.String.dirtyString(this.transactions[e+n].desc),this.transactions[e+n].category=gts.String.dirtyString(this.transactions[e+n].category),this.transactions[e+n].category2=gts.String.dirtyString(this.transactions[e+n].category2),this.transactions[e+n].note=gts.String.dirtyString(this.transactions[e+n].note);this.$.entries&&this.$.entries.refresh(),this.doLoading(!1)}});

// manager.js
enyo.singleton({name:"Checkbook.budget.manager",kind:"enyo.Component",createBudget:function(e,t){Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getInsert("budgets",e),{onSuccess:enyo.bind(this,this.createBudgetFollower,t)})},createBudgetFollower:function(e){console.log(arguments);var t=Checkbook.globals.gts_db.lastInsertId();t?Checkbook.globals.gts_db.query(new gts.databaseQuery({sql:"UPDATE budgets SET budgetOrder = ( SELECT IFNULL( MAX( budgetOrder ) + 1, 0 ) FROM budgets LIMIT 1 ) WHERE budgetId = ?;",values:[t]}),e):enyo.isFunction(e.onSuccess)&&e.onSuccess()},updateBudget:function(e,t){Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getUpdate("budgets",e,{budgetId:e.budgetId}),t)},deleteBudget:function(e,t){Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getDelete("budgets",{budgetId:e}),t)},fetchOverallBudget:function(e,t,n){var o=new gts.databaseQuery({sql:"SELECT COUNT( budgetId ) AS budgetCount, IFNULL( SUM( spending_limit ), 0 ) AS spending_limit, IFNULL( SUM(  IFNULL( ( SELECT ABS( SUM( ex.amount ) ) FROM transactions ex WHERE ex.category LIKE budgets.category AND ex.category2 LIKE budgets.category2 AND CAST( ex.date AS INTEGER ) >= ? AND CAST( ex.date AS INTEGER ) <= ? ), 0 ) + ( IFNULL( ( SELECT ABS( SUM( ts.amount ) ) FROM transactions ex LEFT JOIN transactionSplit ts ON ts.transId = ex.itemId WHERE ts.genCat LIKE budgets.category AND ts.specCat LIKE budgets.category2 AND CAST( ex.date AS INTEGER ) >= ? AND CAST( ex.date AS INTEGER ) <= ? ), 0 ) ) ), 0 ) AS spent FROM budgets;",values:[e,t,e,t]});Checkbook.globals.gts_db.query(o,{onSuccess:function(e){enyo.isFunction(n.onSuccess)&&n.onSuccess(e[0])},onError:n.onError})},fetchBudget:function(e,t,n,o){var i=new gts.databaseQuery({sql:"SELECT *, ( IFNULL( ( SELECT ABS( SUM( ex.amount ) ) FROM transactions ex WHERE ex.category LIKE budgets.category AND ex.category2 LIKE budgets.category2 AND CAST( ex.date AS INTEGER ) >= ? AND CAST( ex.date AS INTEGER ) <= ? ), 0 ) + ( IFNULL( ( SELECT ABS( SUM( ts.amount ) ) FROM transactions ex LEFT JOIN transactionSplit ts ON ts.transId = ex.itemId WHERE ts.genCat LIKE budgets.category AND ts.specCat LIKE budgets.category2 AND CAST( ex.date AS INTEGER ) >= ? AND CAST( ex.date AS INTEGER ) <= ? ), 0 ) ) ) AS spent FROM budgets WHERE budgetId = ? ORDER BY "+budgetSortOptions[sort].query+" LIMIT 1;",values:[t,n,t,n,e]});Checkbook.globals.gts_db.query(i,{onSuccess:function(e){enyo.isFunction(o.onSuccess)&&o.onSuccess(e[0])},onError:o.onError})},fetchBudgets:function(e,t,n,o,i,s){o=gts.Object.validNumber(o)?o:0,i=gts.Object.validNumber(i)?i:100,s=gts.Object.validNumber(s)?s:0,Checkbook.globals.gts_db.query(new gts.databaseQuery({sql:"SELECT *, ( IFNULL( ( SELECT ABS( SUM( ex.amount ) ) FROM transactions ex WHERE ex.category LIKE budgets.category AND ex.category2 LIKE budgets.category2 AND CAST( ex.date AS INTEGER ) >= ? AND CAST( ex.date AS INTEGER ) <= ? ), 0 ) + ( IFNULL( ( SELECT ABS( SUM( ts.amount ) ) FROM transactions ex LEFT JOIN transactionSplit ts ON ts.transId = ex.itemId WHERE ts.genCat LIKE budgets.category AND ts.specCat LIKE budgets.category2 AND CAST( ex.date AS INTEGER ) >= ? AND CAST( ex.date AS INTEGER ) <= ? ), 0 ) ) ) AS spent FROM budgets ORDER BY "+budgetSortOptions[o].query+" LIMIT ?"+" OFFSET ?;",values:[e,t,e,t,i,s]}),n)}});

// view.js
enyo.kind({name:"Checkbook.budget.view",classes:"enyo-fit budget-view v-box",style:"height: 100%;",dispDate:"",sort:0,budgets:[],budgetCount:0,published:{accountObj:{}},events:{onFinish:""},components:[{kind:"onyx.Toolbar",layoutKind:"enyo.FittableColumnsLayout",noStretch:!0,components:[{name:"systemIcon",kind:"enyo.Image",src:"assets/icon_4.png",classes:"img-icon",style:"margin: 0 15px 0 0;"},{name:"loadingSpinner",kind:"onyx.Spinner",showing:!1,classes:"img-icon",style:"margin: 0 15px 0 0;"},{content:"Budget System",classes:"enyo-text-ellipsis text-left",fit:!0},{kind:"onyx.Button",classes:"padding-none transparent",ontap:"dateChanged",components:[{kind:"onyx.Icon",src:"assets/menu_icons/refresh.png"}]}]},{classes:"padding-half-bottom padding-half-left padding-half-right",style:"border-bottom: 2px solid #cccccc;",components:[{name:"progressHeader",layoutKind:"enyo.FittableColumnsLayout",classes:"padding-half-bottom",style:"margin-top: 0.1em;",components:[{name:"currentMonth",classes:"label bold",style:"font-size: 1.15rem;",fit:!0},{name:"totalRemaining",classes:"bold"}]},{layoutKind:"enyo.FittableColumnsLayout",components:[{name:"totalProgress",kind:"onyx.ProgressButton",fit:!0,animateStripes:!1,showStripes:!1,minimum:0,maximum:100,position:0,classes:"margin-vert-none no-cancel bold",components:[{name:"totalCurrent"},{content:"of",style:"padding-left: 5px; padding-right: 5px;"},{name:"totalMax"}]}]}]},{name:"entries",kind:"gts.LazyList",classes:"box-flex-1",fit:!0,reorderable:!0,enableSwipe:!1,touchOverscroll:!1,onAcquirePage:"acquirePage",onSetupItem:"setupRow",onReorder:"reorder",onSetupReorderComponents:"setupReorderComponents",onSetupPinnedReorderComponents:"",onSetupSwipeItem:"",onSwipeComplete:"",components:[{kind:"gts.Item",classes:"bordered padding-none",tapHighlight:!0,holdHighlight:!1,ontap:"tapped",components:[{classes:"h-box box-align-center padding-std budget-category",components:[{name:"category",classes:"box-flex-1"},{name:"remaining",classes:"padding-right bold"}]},{classes:"h-box box-align-center padding-half-left padding-half-right",components:[{name:"progress",kind:"onyx.ProgressButton",classes:"box-flex-1 margin-right no-cancel bold",animateStripes:!1,showStripes:!1,minimum:0,maximum:100,position:0,components:[{name:"current"},{content:"of",style:"padding-left: 5px; padding-right: 5px;"},{name:"total"}]},{kind:"onyx.Button",ontap:"buttonTapped",classes:"padding-none margin-none",components:[{kind:"onyx.IconButton",src:"assets/menu_icons/settings.png"}]}]}]}],reorderComponents:[{name:"reorderContent",classes:"tardis-blue-trans padding-std",style:"max-width: 50%;",components:[{name:"reorderName",classes:"text-ellipsis accountName"},{name:"reorderProgress",kind:"onyx.ProgressBar",animateStripes:!1,showStripes:!1,minimum:0,maximum:100,position:0}]}]},{kind:"Checkbook.MoreToolbar",layoutKind:"enyo.FittableColumnsLayout",classes:"tardis-blue",components:[{name:"backButton",kind:"onyx.Button",ontap:"doFinish",components:[{kind:"onyx.Icon",src:"assets/menu_icons/back.png"}]},{kind:"onyx.MenuDecorator",classes:"padding-none margin-vert-none",onSelect:"budgetSortingChanged",components:[{kind:"onyx.Button",components:[{kind:"onyx.Icon",src:"assets/menu_icons/sort.png"}]},{name:"sortMenu",kind:"gts.SelectedMenu",classes:"bordered-menu",floating:!0,scrim:!0,scrimclasses:"onyx-scrim-translucent",style:"min-width: 225px;",components:budgetSortOptions,value:0}]},{classes:"text-middle text-center padding-none margin-vert-none",fit:!0,unmoveable:!0,components:[{kind:"onyx.Button",ontap:"dateBack",components:[{kind:"onyx.Icon",src:"assets/menu_icons/back.png"}]},{kind:"onyx.Button",ontap:"dateNow",content:"Today",classes:"margin-half-right margin-half-left"},{kind:"onyx.Button",ontap:"dateForward",components:[{kind:"onyx.Icon",src:"assets/menu_icons/forward.png"}]}]},{name:"addAccountButton",kind:"onyx.Button",ontap:"addBudget",components:[{kind:"onyx.Icon",src:"assets/menu_icons/new.png"}]}]}],constructor:function(){this.inherited(arguments),this.bound={modifyComplete:enyo.bind(this,this.modifyComplete)},this.dispDate=new Date},rendered:function(){this.inherited(arguments),this.budgets=[],this.dateChanged()},colorText:function(e,t){e.addRemoveClass("text-onyx-blue",25>t),e.addRemoveClass("text-onyx-green",t>=25&&75>t),e.addRemoveClass("text-onyx-yellow",t>=75&&100>=t),e.addRemoveClass("text-onyx-red",t>100)},colorBar:function(e,t){var n="";25>t?n="onyx-blue":t>=25&&75>t?n="onyx-green":t>=75&&100>=t?n="onyx-yellow":t>100&&(n="onyx-red"),e.setBarClasses(n)},buildHeaderHandler:function(e){this.budgetCount=e.budgetCount,this.$.currentMonth.setContent(this.dispDate.format({date:"MMMM yyyy",time:""}));var t=100*(e.spent/e.spending_limit);t=t||0;var n=e.spending_limit-e.spent;this.$.totalRemaining.setContent(formatAmount(Math.abs(n))+" "+(n>=0?"left":"over")),this.colorText(this.$.totalRemaining,t),this.$.totalCurrent.setContent(formatAmount(e.spent)),this.$.totalMax.setContent(formatAmount(e.spending_limit)),this.$.totalProgress.setProgress(t),this.colorBar(this.$.totalProgress,t),this.$.progressHeader.reflow(),this.resetList()},budgetSortingChanged:function(e,t){t.selected&&this.sort!==t.selected.value&&(this.sort=t.selected.value,this.resetList())},dateBack:function(){this.dispDate.setDate(5),this.dispDate.setMonth(this.dispDate.getMonth()-1),this.dateChanged()},dateNow:function(){this.dispDate=new Date,this.dateChanged()},dateForward:function(){this.dispDate.setDate(5),this.dispDate.setMonth(this.dispDate.getMonth()+1),this.dateChanged()},dateChanged:function(){this.loadingDisplay(!0),enyo.asyncMethod(this,this._dateChanged)},_dateChanged:function(){Checkbook.budget.manager.fetchOverallBudget(this.dispDate.setStartOfMonth(),this.dispDate.setEndOfMonth(),{onSuccess:enyo.bind(this,this.buildHeaderHandler)})},addBudget:function(){return enyo.Signals.send("showPanePopup",{name:"modifyBudgetItem",kind:"Checkbook.budget.modify",budgetId:null,category:"Uncategorized",category2:"%",spending_limit:0,span:1,rollOver:0,onFinish:this.bound.modifyComplete}),!0},resetList:function(){this.budgets=[],this.$.entries.setCount(0),this.$.entries.reset(),this.$.entries.lazyLoad()},reorder:function(e,t){if(t.reorderTo!=t.reorderFrom&&t.reorderTo>-1&&t.reorderTo<this.budgets.length){var n=enyo.clone(this.budgets[t.reorderFrom]);this.budgets.splice(t.reorderFrom,1),this.budgets.splice(t.reorderTo,0,n);for(var o=[],i=0;this.budgets.length>i;i++)o.push(Checkbook.globals.gts_db.getUpdate("budgets",{budgetOrder:i},{budgetId:this.budgets[i].budgetId}));Checkbook.globals.gts_db.queries(o),this.sort=0,this.$.entries.refresh()}},setupReorderComponents:function(e,t){var n=this.budgets[t.index];if(n){var o=100*n.spent/n.spending_limit;this.colorBar(this.$.reorderProgress,o),this.$.reorderProgress.setProgress(o),this.$.reorderName.setContent(n.category+("%"!==n.category2?" >> "+n.category2:""))}},deleted:function(){return this.warn("NOT YET BUILT"),void 0},tapped:function(e,t){var n=this.budgets[t.index];return n?(this.log("NYI"),!0):!0},buttonTapped:function(e,t){var n=this.budgets[t.index];return n&&enyo.Signals.send("showPanePopup",{name:"modifyBudgetItem",kind:"Checkbook.budget.modify",budgetId:n.budgetId,budgetOrder:n.budgetOrder,category:n.category,category2:n.category2,rollOver:n.rollOver,span:n.span,spending_limit:n.spending_limit,onFinish:this.bound.modifyComplete}),!0},modifyComplete:function(){this.budgets=[],this.dateChanged()},setupRow:function(e,t){var n=this.budgets[t.index];if(n){var o=100*n.spent/n.spending_limit;o=o||0,this.$.category.setContent(n.category+("%"!==n.category2?" >> "+n.category2:""));var i=n.spending_limit-n.spent;return this.$.remaining.setContent(formatAmount(Math.abs(i))+" "+(i>=0?"left":"over")),this.colorText(this.$.remaining,o),this.$.progress.setProgress(o),this.colorBar(this.$.progress,o),this.$.current.setContent(formatAmount(n.spent)),this.$.total.setContent(formatAmount(n.spending_limit)),!0}},acquirePage:function(e,t){var n=t.page*t.pageSize;return n>=0&&this.budgets.length<this.budgetCount&&!this.budgets[n]?(this.loadingDisplay(!0),Checkbook.budget.manager.fetchBudgets(this.dispDate.setStartOfMonth(),this.dispDate.setEndOfMonth(),{onSuccess:enyo.bind(this,this.buildPage,n)},this.sort,e.getPageSize(),n),!0):!1},buildPage:function(e,t){for(var n=0;t.length>n;n++)this.budgets[e+n]=t[n],this.budgets[e+n].category=gts.String.dirtyString(this.budgets[e+n].category),this.budgets[e+n].category2=gts.String.dirtyString(this.budgets[e+n].category2);this.$.entries.setCount(this.budgets.length),this.$.entries.refresh(),this.loadingDisplay(!1)},loadingDisplay:function(e){this.$.loadingSpinner.setShowing(e),this.$.systemIcon.setShowing(!e)}});

// modify.js
enyo.kind({name:"Checkbook.budget.modify",kind:"FittableRows",classes:"enyo-fit budget-modify",style:"height: 100%;",acctList:[],published:{budgetId:null,category:"Uncategorized",category2:"%",spending_limit:0,span:1,rollOver:0,budgetOrder:0},events:{onFinish:""},components:[{kind:"onyx.Toolbar",classes:"text-center",components:[{name:"title",content:"Modify Budget",classes:"bigger"}]},{kind:"enyo.Scroller",horizontal:"hidden",classes:"rich-brown-gradient",fit:!0,components:[{classes:"light narrow-column",style:"min-height: 100%;",components:[{kind:"onyx.Groupbox",classes:"padding-half-top padding-half-bottom",components:[{kind:"onyx.InputDecorator",layoutKind:"FittableColumnsLayout",noStretch:!0,ontap:"categoryTapped",components:[{name:"category",fit:!0},{kind:"onyx.Button",classes:"label arrow",content:"Category"}]},{kind:"onyx.InputDecorator",layoutKind:"FittableColumnsLayout",noStretch:!0,components:[{name:"amount",kind:"gts.DecimalInput",fit:!0,atm:!1,selectOnFocus:!0,placeholder:"0.00"},{content:"Spending Limit",classes:"label"}]}]},{name:"delete",kind:"onyx.Button",content:"Delete",ontap:"delete",classes:"onyx-negative margin-top",style:"width: 100%;"},{showing:!1,name:"span",labelText:"Time Span",choices:["1 month","2 months","3 months"],value:"1 month",style:"padding: 10px !important;"},{showing:!1,name:"rollover",style:"padding-left: 0;",mainText:"Rollover",subText:"",onText:"Yes",offText:"No",value:!1,style:"padding: 10px !important;"}]}]},{kind:"onyx.Toolbar",classes:"text-center two-button-toolbar",components:[{kind:"onyx.Button",content:"Cancel",ontap:"doFinish"},{content:""},{kind:"onyx.Button",content:"Save",ontap:"save",classes:"onyx-affirmative"}]},{name:"categorySystem",kind:"Checkbook.transactionCategory.select",entireGeneral:!0}],destroy:function(){this.$.categorySystem.hide(),this.inherited(arguments)},rendered:function(){this.inherited(arguments),this.$.categorySystem.loadCategories(enyo.bind(this,this.completeLoad))},completeLoad:function(){this.$["delete"].setShowing(this.budgetId&&this.budgetId>=0),this.renderCategory(),this.renderAmount()},categoryTapped:function(){this.$.categorySystem.getCategoryChoice(enyo.bind(this,this.categorySelected),null)},categorySelected:function(e){this.category=e.category,this.category2="<strong>All</strong>"!=e.category2?e.category2:"%",this.renderCategory()},renderCategory:function(){"%"===this.category2?this.$.category.setContent(this.category):this.$.category.setContent(this.category2+" ["+this.category+"]")},renderAmount:function(){this.$.amount.setValue(this.spending_limit)},save:function(){this.spending_limit=gts.Object.validNumber(this.$.amount.getValue())?0:Number(Number(this.$.amount.getValue()).toFixed(2));var e={budgetId:this.budgetId,category:this.category,category2:this.category2,spending_limit:this.spending_limit,span:this.span,rollOver:this.rollOver};e.budgetId&&e.budgetId>=0?Checkbook.budget.manager.updateBudget(e,{onSuccess:enyo.bind(this,this.saveComplete)}):(delete e.budgetId,Checkbook.budget.manager.createBudget(e,{onSuccess:enyo.bind(this,this.saveComplete)}))},"delete":function(){this.budgetId&&this.budgetId>=0?Checkbook.budget.manager.deleteBudget(this.budgetId,{onSuccess:enyo.bind(this,this.saveComplete)}):enyo.bind(this,this.saveComplete)()},saveComplete:function(){this.doFinish()}});

// import.js
enyo.kind({name:"Checkbook.sync.import",kind:"FittableRows",classes:"enyo-fit tardis-blue",style:"height: 100%;",allSheetsList:[],importItems:[],standardLimit:1e3,events:{onFinish:""},components:[{kind:"onyx.Toolbar",classes:"text-center",style:"position: relative;",components:[{content:"Import System",classes:"bigger"},{kind:"onyx.Button",ontap:"closeImport",content:"x",classes:"onyx-negative",style:"position: absolute; right: 15px;"}]},{name:"instructions",kind:"enyo.Scroller",horizontal:"hidden",classes:"tardis-blue",fit:!0,components:[{classes:"light narrow-column padding-half-top",style:"height: 100%;",components:[{classes:"padding-std smaller",allowHtml:!0,content:"<p>To import your finances into this program you must have a Google Drive account. <br />Visit drive.google.com to sign up.</p><p>Upload or create a spreadsheet with all the information to import. Once that is complete, tap 'Continue', select your spreadsheet, then the system will import your data. Existing data may be overwritten. <span style='color:#cc0000;'>The first row of the spreadsheet must have the following columns: account, accountCat, date, amount, description, cleared, note.</span></p><p><strong>Warning:</strong> Larger spreadsheets will take much longer to download.</p>"},{name:"saveCredentialsWrapper",layoutKind:"enyo.FittableColumnsLayout",noStretch:!0,classes:"padding-std text-middle",components:[{name:"saveCredentials",kind:"onyx.Checkbox",value:!0,classes:"margin-right"},{content:"Save credentials",fit:!0}]}]}]},{showing:!1,name:"sheetList",kind:"enyo.List",horizontal:"hidden",classes:"tardis-blue-gradient margin-left margin-right",fit:!0,onSetupItem:"setupRow",components:[{kind:"onyx.Item",tapHighlight:!0,ontap:"sheetSelectedChanged",classes:"bordered light",components:[{name:"sheetSelected",kind:"onyx.Checkbox",value:!1,disabled:!0,style:"margin-right: 10px;"},{name:"sheetName",tag:"span"},{name:"sheetUpdated",classes:"smaller"}]}]},{name:"instructionsBar",kind:"onyx.Toolbar",classes:"text-center",components:[{name:"instructionsButton",kind:"onyx.Button",content:"Authenticate",ontap:"authenticateWithGoogle",classes:"onyx-affirmative",style:"min-width: 150px;"}]},{showing:!1,name:"sheetListBar",kind:"onyx.Toolbar",classes:"text-center",components:[{name:"sheetListButton",kind:"onyx.Button",content:"Import Accounts",ontap:"beginImportProcess",classes:"onyx-affirmative deep-green",style:"min-width: 150px;"},{kind:"onyx.MenuDecorator",onSelect:"menuItemClick",components:[{kind:"onyx.Button",components:[{content:"Select..."}]},{kind:"onyx.Menu",showOnTop:!0,floating:!0,components:[{content:"All",value:1},{content:"None",value:2},{content:"Invert",value:3}]}]}]},{name:"progress",kind:"gts.ProgressDialog",animateProgress:!0,onCancel:"closeImport",cancelText:"Cancel"},{name:"errorMessage",kind:"Checkbook.systemError",errTitle:"Import Error",mainMessage:"",secondaryMessage:"",onFinish:"closeErrorMessage"},{name:"gapi",kind:"gts.Gapi",onReady:"gapiReady"},{name:"gapiAccess",kind:"private.gapi"},{name:"gssc",kind:"gts.gdata",appName:"com.glitchtechscience.checkbook"},{name:"cryptoSystem",kind:"Checkbook.encryption"}],rendered:function(){this.inherited(arguments),this.$.instructionsButton.setDisabled(!0),this.$.instructionsBar.show(),this.$.sheetListBar.hide(),this.$.instructions.show(),this.$.sheetList.hide(),this.$.progress.show({title:"Import Progress",message:"Linking to Google...",progress:25}),this.resized(),this.$.gapi.isGapiReady()&&this.gapiReady()},gapiReady:function(){this.$.progress.setProgress(60),Checkbook.globals.gts_db.query("SELECT saveGSheetsData, gSheetPass FROM prefs LIMIT 1;",{onSuccess:enyo.bind(this,this.decryptGapiData)})},decryptGapiData:function(e){this.$.progress.setProgress(90),e.length>0?(this.$.saveCredentials.setValue(e[0].saveGSheetsData),this.$.cryptoSystem.decryptString(e[0].gSheetPass,enyo.bind(this,this.loadGapiData))):this.loadGapiData("")},loadGapiData:function(e){this.$.gapi.setApiKey(this.$.gapiAccess.getApiKey()),this.$.gapi.setClientId(this.$.gapiAccess.getClientId()),this.$.gapi.setClientSecret(this.$.gapiAccess.getClientSecret()),this.$.saveCredentialsWrapper.hide(),this.$.gapi.setAuthToken(enyo.json.parse(e)),this.$.instructionsButton.setDisabled(!1),this.$.progress.hide()},authenticateWithGoogle:function(){this.$.gapi.setScope(["https://www.googleapis.com/auth/drive","https://www.googleapis.com/auth/drive.file","https://spreadsheets.google.com/feeds","https://docs.google.com/feeds"]),this.$.gapi.auth({onSuccess:enyo.bind(this,this.userAuthenticated),onError:enyo.bind(this,this.userNotAuthenticated)}),this.$.progress.show({title:"Import Progress",message:"Authenticating...",progress:5})},userNotAuthenticated:function(){this.closeImport()},userAuthenticated:function(){this.$.progress.show({title:"Import Progress",message:"Authenticated...",progress:15}),this.$.saveCredentials.getValue()?this.$.cryptoSystem.encryptString(enyo.json.stringify(this.$.gapi.getAuthToken()),enyo.bind(this,this.saveUserGData)):this.saveUserGData(""),this.$.gapi.loadModule("drive",2,{onSuccess:enyo.bind(this,this.fetchsheetList),onError:enyo.bind(this,this.fatalError,"Checkbook importer has encountered a fatal error. Please try again later.")})},saveUserGData:function(e){var t={saveGSheetsData:0,gSheetPass:""};this.$.saveCredentials.getValue()&&e.length>0&&(t={saveGSheetsData:this.$.saveCredentials.getValue()?1:0,gSheetPass:e}),Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getUpdate("prefs",t,{}))},fetchsheetList:function(){this.$.progress.show({title:"Import Progress",message:"Retrieving spreadsheets...",progress:25});var e=gapi.client.drive.files.list({maxResults:15});this.retrievePageOfFiles(e,[])},retrievePageOfFiles:function(e,t){var n=this;e.execute(function(o){t=t.concat(o.items);var s=n.$.progress.getProgress()+5;n.$.progress.setProgress(s>75?75:s),n.$.progress.setMessage(t.length+" items retrieved...");var i=o.nextPageToken;i?(e=gapi.client.drive.files.list({maxResults:15,pageToken:i}),n.retrievePageOfFiles(e,t)):n.rendersheetList(t)})},rendersheetList:function(e){if(!e||e===void 0||0>=e.length)return this.$.progress.hide(),this.showErrorMessage(enyo.bind(this,this.closeImport),"No data available to be imported."),void 0;if(void 0!==this.$.progress){this.$.progress.setMessage("Processing files..."),this.$.progress.setProgress(75),this.$.sheetListButton.setDisabled(!1),this.$.instructionsBar.hide(),this.$.sheetListBar.show(),this.$.instructions.hide(),this.$.sheetList.show();for(var t=0;e.length>t;t++)(e[t].mimeType.match("excel")||e[t].mimeType.match("spreadsheet"))&&this.allSheetsList.push(e[t]);this.$.progress.setProgress(95),this.$.sheetList.setCount(this.allSheetsList.length),this.$.sheetList.refresh(),this.resized(),this.$.progress.hide()}},setupRow:function(e,t){var n=t.index,o=this.allSheetsList[n];if(o){this.$.sheetName.setContent(o.title);var s=new Date(o.modifiedDate);return this.$.sheetUpdated.setContent(s.format({date:"long",time:"short"})),this.$.sheetSelected.setValue(o.selectStatus),!0}},sheetSelectedChanged:function(e,t){this.allSheetsList[t.index].selectStatus=!this.allSheetsList[t.index].selectStatus,this.$.sheetList.renderRow(t.index)},menuItemClick:function(e,t){if(1===t.selected.value)for(var n=0;this.allSheetsList.length>n;n++)this.allSheetsList[n].selectStatus=!0;else if(2===t.selected.value)for(var n=0;this.allSheetsList.length>n;n++)this.allSheetsList[n].selectStatus=!1;else if(3===t.selected.value)for(var n=0;this.allSheetsList.length>n;n++)this.allSheetsList[n].selectStatus=!this.allSheetsList[n].selectStatus;this.$.sheetList.refresh()},beginImportProcess:function(){this.$.sheetListButton.setDisabled(!0),this.importItems=[];for(var e=0;this.allSheetsList.length>e;e++)this.allSheetsList[e].selectStatus&&this.importItems.push({sheetIndex:e,name:this.allSheetsList[e].title,sheetId:this.allSheetsList[e].id,finished:!1,pages:[],transactions:[]});if(0>=this.importItems.length)return this.showErrorMessage(enyo.bind(this,this.closeImport),"No accounts selected to import"),void 0;this.documentIndex=0,this.errorCount=0;try{enyo.windows.blockScreenTimeout(!0),this.log("Window: blockScreenTimeout: true")}catch(t){this.log("Window Error (Start)",t)}this.$.progress.show({title:"Importing Data",message:"Fetching document specifications...",progress:0}),this.$.gssc.setAuthKey(this.$.gapi.getAuthToken().AccessToken),enyo.asyncMethod(this,this.fetchDocSummary)},fetchDocSummary:function(){this.$.progress.setProgress(100*(this.documentIndex/this.importItems.length)),this.$.gssc.getSheetSummary(this.importItems[this.documentIndex].sheetId,{onSuccess:enyo.bind(this,this.parseDocSummary),onError:enyo.bind(this,this.showErrorMessage,enyo.bind(this,this.fetchsheetList))})},parseDocSummary:function(e,t){if(!this.checkErrorCount()){if(t.feed.entry===void 0)return this.error("Bad data from Google."),this.$.progress.setMessage("Attempting to fix bad import data"),this.errorCount++,this.fetchDocSummary(),void 0;var t=t.feed.entry;enyo.isArray(t)||(t=[t]);for(var n=0;t.length>n;n++)this.importItems[this.documentIndex].pages.push({pageKey:t[n].id["#text"].slice(t[n].id["#text"].lastIndexOf("/")+1),title:t[n].title["#text"],totalResults:0});this.documentIndex++,this.documentIndex<this.importItems.length?this.fetchDocSummary():(this.$.progress.setMessage("Retrieving document content"),this.$.progress.setProgress(0),this.fetchAccountData(enyo.bind(this,this.startDataPull)))}},fetchAccountData:function(e){Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getSelect("accounts",["acctId","acctCategory","acctName"]),{onSuccess:enyo.bind(this,this.processAccountData,e)})},processAccountData:function(e,t){this.accountList={},this.newAccounts=[];for(var n=null,o=0;t.length>o;o++)n=t[o],this.addAccountListObject(n.acctId,n.acctName,n.acctCategory);e&&e()},addAccountListObject:function(e,t,n){this.accountList[n]===void 0&&(this.accountList[n]={}),this.accountList[n][t]=e},startDataPull:function(){this.documentIndex=0,this.pageIndex=0,this.errorCount=0,this.downloadDocData(1,this.standardLimit)},downloadDocData:function(e,t){return this.pageIndex>=this.importItems[this.documentIndex].pages.length?(this.nextDocumentPage(),void 0):(this.$.gssc.getSheetData(this.importItems[this.documentIndex].sheetId,this.importItems[this.documentIndex].pages[this.pageIndex].pageKey,e,t,{onSuccess:enyo.bind(this,this.processDocData),onError:enyo.bind(this,this.showErrorMessage,enyo.bind(this,this.fetchsheetList))}),void 0)},processDocData:function(e,t){if(!this.checkErrorCount(5)){if(t===void 0||t.feed===void 0)return this.error("Bad data from Google."),this.$.progress.setMessage("Attempting to fix bad import data"),this.errorCount++,this.importItems[this.documentIndex].transactions=[],this.downloadDocData(1,this.standardLimit),void 0;if(this.importItems[this.documentIndex].limit=parseInt(t.feed["openSearch:itemsPerPage"]["#text"]),this.importItems[this.documentIndex].offset=parseInt(t.feed["openSearch:startIndex"]["#text"]),this.importItems[this.documentIndex].totalResults=parseInt(t.feed["openSearch:totalResults"]["#text"]),0>=this.importItems[this.documentIndex].totalResults||t.feed.entry===void 0)return this.nextDocumentPage(),void 0;var t=t.feed.entry;enyo.isArray(t)||(t=[t]),1!==this.importItems[this.documentIndex].offset||void 0!==t[0]["gsx:amount"]&&void 0!==t[0]["gsx:amount"]["#text"]&&void 0!==t[0]["gsx:description"]&&void 0!==t[0]["gsx:description"]["#text"]&&void 0!==t[0]["gsx:date"]&&void 0!==t[0]["gsx:date"]["#text"]?this.processDocDataFollower(t):(this.createComponent({name:"alertShow",kind:"gts.ConfirmDialog",title:"Warning! Missing Fields",message:"Current page is missing essential fields for importing the data. These fields can be blank, but doing so may result in an improper import. The first row should have the following items: account, accountCat, date, amount, description, cleared, note. ("+this.importItems[this.documentIndex].name+" page "+(this.pageIndex+1)+")",confirmText:"Skip Current Item",cancelText:"Ignore and Continue",onConfirm:"nextDocumentPage",onCancel:"processDocDataIgnoreContinue"}),this.responseHolder=t,this.$.alertShow.show())}},processDocDataIgnoreContinue:function(){this.$.alertShow.hide(),this.$.alertShow.destroy();var e=this.responseHolder;this.responseHolder=null,this.processDocDataFollower(e)},processDocDataFollower:function(e){for(var t,n=enyo.isArray(e)?e:[],o=0;n.length>o;o++)t={},t.amount=deformatAmount(this.getNode(n[o],"gsx:amount")),gts.Object.validNumber(t.amount)&&(t.amount=parseFloat(t.amount),t.itemId=parseInt(this.getNode(n[o],"gsx:gtid")),gts.Object.validNumber(t.itemId)||(t.itemId=""),t.accountName=this.getNode(n[o],"gsx:account"),t.accountCat=this.getNode(n[o],"gsx:accountcat"),""===t.accountName&&(t.accountName=this.importItems[this.documentIndex].name),""===t.accountCat&&(t.accountCat="Imported Account"),(this.accountList[t.accountCat]===void 0||this.accountList[t.accountCat][t.accountName]===void 0)&&(this.newAccounts.push({acctName:t.accountName,acctCategory:t.accountCat,sort:1,acctNotes:""}),this.addAccountListObject(-1,t.accountName,t.accountCat)),t.linkedAccountName=this.getNode(n[o],"gsx:gtlinkedaccount"),t.linkedAccountCat=this.getNode(n[o],"gsx:gtlinkedaccountcat"),t.linkedRecord=parseInt(this.getNode(n[o],"gsx:gtlinkid")),gts.Object.validNumber(t.linkedRecord)?(""===t.linkedAccountName&&(t.linkedAccountName=this.importItems[this.documentIndex].name),""===t.linkedAccountCat&&(t.linkedAccountCat="Imported Account"),(this.accountList[t.linkedAccountCat]===void 0||this.accountList[t.linkedAccountCat][t.linkedAccountName]===void 0)&&(this.newAccounts.push({acctName:t.linkedAccountName,acctCategory:t.linkedAccountCat,acctNotes:""}),this.addAccountListObject(-1,t.linkedAccountName,t.linkedAccountCat))):(t.linkedAccountName="",t.linkedAccountCat="",t.linkedRecord=""),t.cleared=this.getNode(n[o],"gsx:cleared").toLowerCase(),t.cleared=0==t.cleared||"no"==t.cleared||"not"==t.cleared||"false"==t.cleared||""==t.cleared?0:1,t.date=Date.deformat(this.getNode(n[o],"gsx:date")),gts.Object.validNumber(t.date)||(t.date=Date.parse(new Date)),t.category=this.getNode(n[o],"gsx:gtcat"),t.category=""===t.category||"none"===t.category.toLowerCase()?[{category:"",category2:"",amount:""}]:gts.String.isJSON(t.category)?enyo.json.parse(t.category):[{category:t.category.split("|",2)[0],category2:t.category.split("|",2)[1],amount:""}],t.desc=this.getNode(n[o],"gsx:description"),t.desc=t.desc.length>0?t.desc:"Transaction Description",t.checkNum=this.getNode(n[o],"gsx:checknum"),t.note=this.getNode(n[o],"gsx:note"),t.payee=this.getNode(n[o],"gsx:payee"),this.importItems[this.documentIndex].transactions.push(t));this.updateDocDownloadProgress(n.length),this.importItems[this.documentIndex].limit+this.importItems[this.documentIndex].offset<this.importItems[this.documentIndex].totalResults?this.downloadDocData(this.importItems[this.documentIndex].limit+this.importItems[this.documentIndex].offset,this.importItems[this.documentIndex].limit):this.nextDocumentPage()},updateDocDownloadProgress:function(e){var t=(e+this.importItems[this.documentIndex].offset)/this.importItems[this.documentIndex].totalResults,n=((t>1?1:t)+this.pageIndex)/this.importItems[this.documentIndex].pages.length,o=100*((n/2+this.documentIndex)/this.importItems.length);this.$.progress.setMessage(this.importItems[this.documentIndex].name+"<br />Downloading: "+new Number(isNaN(n)?0:100*n).toFixed(1)+"%"),isNaN(o)||this.$.progress.setProgress(o)},getNode:function(e,t){return e===void 0||e[t]===void 0||e[t]["#text"]===void 0?"":gts.String.trim(e[t]["#text"])},nextDocumentPage:function(){this.pageIndex++,this.pageIndex<this.importItems[this.documentIndex].pages.length?this.downloadDocData(1,this.standardLimit):this.newAccounts.length>0?this.insertNewAccounts():this.saveDocData(0,this.standardLimit/2)},insertNewAccounts:function(){var e={table:"accounts",data:this.newAccounts},t={onSuccess:enyo.bind(this,this.fetchAccountData,enyo.bind(this,this.saveDocData,0,this.standardLimit/2))};Checkbook.globals.gts_db.insertData(e,t)},saveDocData:function(e,t){var n=[],o=e+t;o>=this.importItems[this.documentIndex].transactions.length&&(o=this.importItems[this.documentIndex].transactions.length);for(var s=e;o>s;s++){this.importItems[this.documentIndex].transactions[s].account=this.accountList[this.importItems[this.documentIndex].transactions[s].accountCat][this.importItems[this.documentIndex].transactions[s].accountName],""!==this.importItems[this.documentIndex].transactions[s].linkedRecord?this.importItems[this.documentIndex].transactions[s].linkedAccount=this.accountList[this.importItems[this.documentIndex].transactions[s].linkedAccountCat][this.importItems[this.documentIndex].transactions[s].linkedAccountName]:delete this.importItems[this.documentIndex].transactions[s].linkedRecord,delete this.importItems[this.documentIndex].transactions[s].accountName,delete this.importItems[this.documentIndex].transactions[s].accountCat,delete this.importItems[this.documentIndex].transactions[s].linkedAccountName,delete this.importItems[this.documentIndex].transactions[s].linkedAccountCat,gts.Object.validNumber(this.importItems[this.documentIndex].transactions[s].itemId)||delete this.importItems[this.documentIndex].transactions[s].itemId;var i=this.importItems[this.documentIndex].transactions[s].category,a=[];i.length>1&&this.importItems[this.documentIndex].transactions[s].itemId?a=Checkbook.transactions.manager.handleCategoryData(this.importItems[this.documentIndex].transactions[s]):(this.importItems[this.documentIndex].transactions[s].category=i[0].category,this.importItems[this.documentIndex].transactions[s].category2=i[0].category2),n.push(Checkbook.globals.gts_db.getReplace("transactions",this.importItems[this.documentIndex].transactions[s])),n=n.concat(a)}var r={onSuccess:enyo.bind(this,this.saveDocDataHandler,e,t),onError:enyo.bind(this,this.showErrorMessage,enyo.bind(this,this.fetchsheetList),"Error while saving data, please try again. Contact <a href='mailto:GlitchTechScience@gmail.com'>GlitchTechScience@gmail.com</a> if this continues to occur.")};Checkbook.globals.gts_db.queries(n,r)},saveDocDataHandler:function(e,t){Checkbook.accounts.manager.updateAccountModTime();var n=(e+t)/this.importItems[this.documentIndex].transactions.length;n=n>1?1:n;var o=(n/2+.5+this.documentIndex)/this.importItems.length;this.$.progress.setMessage(this.importItems[this.documentIndex].name+"<br />Saving: "+new Number(100*n).toFixed(1)+"%"),this.$.progress.setProgress(100*o),this.importItems[this.documentIndex].transactions.length>e+t?this.saveDocData(e+t,t):(this.allSheetsList[this.importItems[this.documentIndex].sheetIndex].selectStatus=!1,this.$.sheetList.render(),this.documentIndex++,this.pageIndex=0,this.documentIndex<this.importItems.length?this.downloadDocData(1,this.standardLimit):(this.$.errorMessage.setErrTitle("Import Complete"),this.closeImport(!0)))},checkErrorCount:function(e){return e||(e=3),this.errorCount>=3?(this.error("Multiple sets of bad data from Google."),this.errorCount=0,this.showErrorMessage(enyo.bind(this,this.fetchsheetList),"There has been an error: Multiple sets of bad data from Google. Please try again later."),!0):!1},fatalError:function(e){this.showErrorMessage(enyo.bind(this,this.closeImport,!1),e)},showErrorMessage:function(e,t){this.onErrorClose=e,this.$.progress.hide(),this.$.errorMessage.show(),this.$.errorMessage.setMainMessage(t)},closeErrorMessage:function(){return this.$.errorMessage.hide(),this.onErrorClose(),!0},closeImport:function(e){try{enyo.windows.blockScreenTimeout(!1),this.log("Window: blockScreenTimeout: false")}catch(t){this.log("Window Error (End)",t)}this.$.instructionsButton.setDisabled(!1),this.$.instructionsBar.show(),this.$.sheetListBar.hide(),this.$.instructions.show(),this.$.sheetList.hide(),this.$.errorMessage.hide(),this.$.progress.hide(),this.doFinish({success:e})}});

// export.js
enyo.kind({name:"Checkbook.sync.export",kind:"FittableRows",classes:"enyo-fit",style:"height: 100%;",acctList:[],events:{onFinish:""},components:[{kind:"onyx.Toolbar",classes:"text-center",style:"position: relative;",components:[{content:"Export System",classes:"bigger"},{kind:"onyx.Button",ontap:"closeExport",content:"x",classes:"onyx-negative",style:"position: absolute; right: 15px;"}]},{kind:"enyo.Scroller",horizontal:"hidden",classes:"tardis-blue",fit:!0,components:[{name:"instructions",classes:"light narrow-column padding-half-top",style:"height: 100%;",components:[{classes:"padding-std smaller",allowHtml:!0,content:"<p>To export your finances from this program you must have a Google Drive account. <br />Visit drive.google.com to sign up.</p><p><strong>Warning:</strong> Larger spreadsheets will take much longer to upload.</p>"},{name:"saveCredentialsWrapper",layoutKind:"enyo.FittableColumnsLayout",noStretch:!0,classes:"padding-std text-middle",components:[{name:"saveCredentials",kind:"onyx.Checkbox",value:!0,classes:"margin-right"},{content:"Save credentials",fit:!0}]}]},{showing:!1,name:"accountList",kind:"Repeater",classes:"light narrow-column padding-half-top",onSetupItem:"setupRow",components:[{kind:"onyx.Item",tapHighlight:!0,ontap:"accountSelectedChanged",classes:"bordered text-middle",components:[{name:"accountSelected",kind:"onyx.Checkbox",value:!1,disabled:!0,classes:"margin-half-right"},{classes:"inline",components:[{name:"icon",kind:"enyo.Image",classes:"accountIcon"},{name:"iconLock",kind:"enyo.Image",src:"assets/padlock_1.png",classes:"accountLockIcon unlocked"}]},{classes:"margin-half-left inline",components:[{name:"accountName"},{name:"accountNote",classes:"smaller"}]}]}]}]},{name:"instructionsBar",kind:"onyx.Toolbar",classes:"text-center",components:[{name:"instructionsButton",kind:"onyx.Button",content:"Authenticate",ontap:"authenticateWithGoogle",classes:"onyx-affirmative",style:"min-width: 150px;"}]},{showing:!1,name:"accountListBar",kind:"onyx.Toolbar",classes:"text-center",components:[{name:"accountListButton",kind:"onyx.Button",content:"Export Accounts",ontap:"beginExportProcess",classes:"onyx-affirmative deep-green",style:"min-width: 150px;"},{kind:"onyx.MenuDecorator",onSelect:"menuItemClick",components:[{kind:"onyx.Button",components:[{content:"Select..."}]},{kind:"onyx.Menu",showOnTop:!0,floating:!0,components:[{content:"All",value:1},{content:"None",value:2},{content:"Invert",value:3}]}]}]},{name:"progress",kind:"gts.ProgressDialog",animateProgress:!0,onCancel:"closeExport",cancelText:"Cancel"},{name:"errorMessage",kind:"Checkbook.systemError",errTitle:"Export Error",mainMessage:"",secondaryMessage:"",onFinish:"closeErrorMessage"},{name:"gapi",kind:"gts.Gapi",onReady:"gapiReady"},{name:"gapiAccess",kind:"private.gapi"},{name:"cryptoSystem",kind:"Checkbook.encryption"}],rendered:function(){this.log(),this.inherited(arguments),this.$.instructions.show(),this.$.instructionsBar.show(),this.$.instructionsButton.setDisabled(!0),this.$.accountList.hide(),this.$.accountListBar.hide(),this.$.progress.show({title:"Export Progress",message:"Linking to Google...",progress:25}),this.resized(),this.$.gapi.isGapiReady()&&this.gapiReady()},gapiReady:function(){this.log(),this.$.progress.setProgress(60),Checkbook.globals.gts_db.query("SELECT saveGSheetsData, gSheetPass FROM prefs LIMIT 1;",{onSuccess:enyo.bind(this,this.decryptGapiData)})},decryptGapiData:function(e){this.$.progress.setProgress(90),e.length>0?(this.$.saveCredentials.setValue(e[0].saveGSheetsData),this.$.cryptoSystem.decryptString(e[0].gSheetPass,enyo.bind(this,this.loadGapiData))):this.loadGapiData("")},loadGapiData:function(e){this.$.gapi.setApiKey(this.$.gapiAccess.getApiKey()),this.$.gapi.setClientId(this.$.gapiAccess.getClientId()),this.$.gapi.setClientSecret(this.$.gapiAccess.getClientSecret()),this.$.saveCredentialsWrapper.hide(),this.$.gapi.setAuthToken(enyo.json.parse(e)),this.$.instructionsButton.setDisabled(!1),this.$.progress.hide()},authenticateWithGoogle:function(){this.log(),this.$.gapi.setScope(["https://www.googleapis.com/auth/drive","https://www.googleapis.com/auth/drive.file","https://spreadsheets.google.com/feeds","https://docs.google.com/feeds"]),this.$.gapi.auth({onSuccess:enyo.bind(this,this.userAuthenticated),onError:enyo.bind(this,this.userNotAuthenticated)}),this.$.progress.show({title:"Export Progress",message:"Authenticating...",progress:5})},userNotAuthenticated:function(){this.log(),this.closeExport()},userAuthenticated:function(){this.log(),this.$.progress.show({title:"Export Progress",message:"Authenticated...",progress:15}),this.$.saveCredentials.getValue()?this.$.cryptoSystem.encryptString(enyo.json.stringify(this.$.gapi.getAuthToken()),enyo.bind(this,this.saveUserGData)):this.saveUserGData(""),this.fetchAccounts()},saveUserGData:function(e){var t={saveGSheetsData:0,gSheetPass:""};this.$.saveCredentials.getValue()&&e.length>0&&(t={saveGSheetsData:this.$.saveCredentials.getValue()?1:0,gSheetPass:e}),Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getUpdate("prefs",t,{}))},fetchAccounts:function(){this.log(),this.$.progress.show({title:"Export Progress",message:"Retrieving accounts...",progress:50}),Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getSelect("accounts",["acctId","acctName","acctCategory","acctLocked","lockedCode","IFNULL( ( SELECT accountCategories.icon FROM accountCategories WHERE accountCategories.name = acctCategory ), 'icon_2.png' ) AS acctCategoryIcon","( SELECT accountCategories.catOrder FROM accountCategories WHERE accountCategories.name = acctCategory ) AS acctCatOrder","IFNULL( ( SELECT COUNT( transactions.amount ) FROM transactions WHERE transactions.account = acctId ), 0 ) AS itemCount"],null,["acctCatOrder","acctName"]),{onSuccess:enyo.bind(this,this.renderAccountList)})},renderAccountList:function(e){this.acctList=[];for(var t=0;e.length>t;t++){var n=e[t];this.acctList.push({acctId:n.acctId,name:n.acctName,cat:n.acctCategory,icon:n.acctCategoryIcon,itemCount:n.itemCount,acctLocked:n.acctLocked,lockedCode:n.lockedCode,bypass:!1,selectStatus:1!=n.acctLocked})}0>=this.acctList.length?(this.$.progress.hide(),this.showErrorMessage(enyo.bind(this,this.closeExport),"No data available to be exported.")):this.showAccountList()},showAccountList:function(){this.log(),this.$.progress.setMessage("Processing accounts..."),this.$.progress.setProgress(75),this.$.instructionsBar.hide(),this.$.instructions.hide(),this.$.accountListButton.setDisabled(!1),this.$.accountListBar.show(),this.$.accountList.show(),this.$.accountList.setCount(this.acctList.length),this.$.progress.hide()},setupRow:function(e,t){var n=t.index,o=t.item,s=this.acctList[n];return s?(o.$.accountName.setContent(s.name),o.$.accountNote.setContent(s.itemCount+" "+"Transaction"+(s.itemCount>1?"s":"")),o.$.icon.setSrc("assets/"+s.icon),o.$.iconLock.addRemoveClass("unlocked",1!==s.acctLocked||s.bypass),o.$.accountSelected.setChecked(s.selectStatus),!0):void 0},accountSelectedChanged:function(e,t){this.acctList[t.index].acctLocked&&!this.acctList[t.index].bypass?Checkbook.globals.security.authUser(this.acctList[t.index].name+" "+"PIN Code",this.acctList[t.index].lockedCode,{onSuccess:enyo.bind(this,this.authSuccessful,t.index)}):this.acctList[t.index].selectStatus=!this.acctList[t.index].selectStatus,this.$.accountList.renderRow(t.index)},authSuccessful:function(e){this.acctList[e].bypass=!0,this.acctList[e].selectStatus=!0,this.$.accountList.renderRow(e)},menuItemClick:function(e,t){if(1===t.selected.value)for(var n=0;this.acctList.length>n;n++)(!this.acctList[n].acctLocked||this.acctList[n].bypass)&&(this.acctList[n].selectStatus=!0);else if(2===t.selected.value)for(var n=0;this.acctList.length>n;n++)this.acctList[n].selectStatus=!1;else if(3===t.selected.value)for(var n=0;this.acctList.length>n;n++)(!this.acctList[n].acctLocked||this.acctList[n].bypass)&&(this.acctList[n].selectStatus=!this.acctList[n].selectStatus);this.$.accountList.setCount(this.acctList.length)},beginExportProcess:function(){this.log(),this.$.progress.show({title:"Exporting",message:"Preparing data...",progress:0}),this.$.accountListButton.setDisabled(!0);for(var e=[],t=0;this.acctList.length>t;t++)this.acctList[t].selectStatus===!0&&e.push(enyo.mixin({index:t},this.acctList[t]));if(0>=e.length)return this.showErrorMessage(enyo.bind(this,this.closeExport),"Export complete."),void 0;try{enyo.windows.blockScreenTimeout(!0),this.log("Window: blockScreenTimeout: true")}catch(n){this.log("Window Error (Start)",n)}this.startNewSheet(e,0)},startNewSheet:function(e,t){this.$.progress.setTitle("Exporting "+e[t].name),this.$.progress.setMessage(t+1+" of "+e.length+"<br />"+"Retrieving transactions"),this.$.progress.setProgress(100*(1*(t+1)/4/e.length)),Checkbook.globals.gts_db.query(Checkbook.globals.gts_db.getSelect("transactions",["itemId","linkedRecord","amount","checkNum","cleared","date","desc","note","payee",' ( CASE WHEN category = \'||~SPLIT~||\' THEN ( \'[\' || IFNULL( ( SELECT GROUP_CONCAT( json ) FROM ( SELECT ( \'{ "category": "\' || ts.genCat || \'", "category2" : "\' || ts.specCat || \'", "amount": "\' || ts.amount || \'" }\' ) AS json FROM transactionSplit ts WHERE ts.transId = itemId ORDER BY ts.amount DESC ) ), \'{ "category": "?", "category2" : "?", "amount": "0" }\' ) || \']\' ) ELSE category END ) AS category'," ( CASE WHEN category = '||~SPLIT~||' THEN 'PARSE_CATEGORY' ELSE category2 END ) AS category2","IFNULL( ( SELECT accounts.acctName FROM accounts WHERE accounts.acctId = transactions.account ), '' ) AS accountName","IFNULL( ( SELECT accounts.acctCategory FROM accounts WHERE accounts.acctId = transactions.account ), '' ) AS accountCat","IFNULL( ( SELECT accounts.acctName FROM accounts WHERE accounts.acctId = transactions.linkedAccount ), '' ) AS linkedAccountName","IFNULL( ( SELECT accounts.acctCategory FROM accounts WHERE accounts.acctId = transactions.linkedAccount ), '' ) AS linkedAccountCat"],{account:e[t].acctId},["date"]),{onSuccess:enyo.bind(this,this.buildSheetContent,e,t,0,100,{accountId:e[t].acctId,accountName:e[t].name,accountCategory:e[t].cat,csv:"account,accountCat,date,amount,description,cleared,checkNum,note,payee,gtId,gtCat,gtLinkId,gtLinkedAccount,gtLinkedAccountCat\n"})})},buildSheetContent:function(e,t,n,o,s,i){if(0>=i.length)return this.sheetComplete(e,t),void 0;var a=0;a=i.length>n+o?n+o:i.length,this.$.progress.setMessage(t+1+" of "+e.length+"<br />"+"Processing account"),this.$.progress.setProgress(100*((t+1)*(2+a/i.length)/4/e.length));for(var r=n;a>r;r++){var c=i[r];s.csv+='"'+gts.String.cleanString(c.accountName)+'",'+'"'+gts.String.cleanString(c.accountCat)+'",'+"\"'"+new Date(parseInt(c.date)).format("special")+'",'+'"'+formatAmount(c.amount)+'",'+'"'+gts.String.cleanString(c.desc)+'",'+'"'+(1==c.cleared?"Yes":"No")+'",'+'"'+gts.String.cleanString(c.checkNum)+'",'+'"'+gts.String.cleanString(c.note)+'",'+'"'+gts.String.cleanString(c.payee)+'",'+'"'+c.itemId+'",'+'"'+enyo.json.stringify(Checkbook.transactions.manager.parseCategoryDB(c.category,c.category2)).replace(/"/g,'""')+'",'+'"'+c.linkedRecord+'",'+'"'+gts.String.cleanString(c.linkedAccountName)+'",'+'"'+gts.String.cleanString(c.linkedAccountCat)+'"\n'}i.length>a?enyo.asyncMethod(this,this.buildSheetContent,e,t,a,o,s,i):this.uploadSheet(e,t,s)},uploadSheet:function(e,t,n){this.$.progress.setMessage(t+1+" of "+e.length+"<br />"+"Uploading data"),this.$.progress.setProgress(100*(3*(t+1)/4/e.length));const o="----END_OF_PART----",s="\r\n--"+o+"\r\n",i="\r\n--"+o+"--",a="text/csv";var r=new Date,c="["+enyo.fetchAppInfo().title+"] "+n.accountName+" ["+n.accountCategory+"] ["+r.format({date:"long",time:"short"})+"]",l={title:gts.String.cleanString(c),mimeType:a},h=s+"Content-Type: application/json\r\n\r\n"+JSON.stringify(l)+s+"Content-Type: "+a+"\r\n"+"\r\n"+n.csv+i,d=gapi.client.request({path:"/upload/drive/v2/files?convert=true",method:"POST",params:{uploadType:"multipart"},headers:{"Content-Type":'multipart/mixed; boundary="'+o+'"'},body:h});d.execute(enyo.bind(this,this.requestComplete,e,t))},requestComplete:function(e,t,n){if(n.error){var o="Code: "+n.error.code+"<br />"+"Message"+n.error.message;this.showErrorMessage(this.showAccountList,o)}else this.sheetComplete(e,t)},sheetComplete:function(e,t){this.$.progress.setMessage("Account uploaded"),this.$.progress.setProgress(100*(4*(t+1)/4/e.length)),t++,e.length>t?this.startNewSheet(e,t):(this.$.progress.hide(),this.$.errorMessage.setErrTitle("Export Complete"),this.showErrorMessage(enyo.bind(this,this.closeExport),e.length+" account"+(e.length>1?"s":"")+" exported."))},showErrorMessage:function(e,t){this.onErrorClose=e,this.$.progress.hide(),this.$.errorMessage.show(),this.$.errorMessage.setMainMessage(t)},closeErrorMessage:function(){return this.log(),this.$.errorMessage.hide(),this.onErrorClose(),!0},closeExport:function(){this.log();try{enyo.windows.blockScreenTimeout(!1),this.log("Window: blockScreenTimeout: false")}catch(e){this.log("Window Error (End)",e)}this.$.instructions.show(),this.$.instructionsBar.show(),this.$.instructionsButton.setDisabled(!1),this.$.accountList.hide(),this.$.accountListBar.hide(),this.$.errorMessage.hide(),this.$.progress.hide(),this.doFinish()}});

// sync.js
enyo.kind({name:"Checkbook.sync.main",content:"SYNC SYSTEM"});
